<div style="padding-top:10px;margin-bottom: -5px;">
<button *ngIf="authenticationService.module.hasFormAccess && (showButton || authenticationService.isShowForms)" class="show-forms-btn" id="right" style="border-radius: 5px;margin-top:2px;" (click)="showForms()">
  {{buttonText}}
</button>
</div>
<!-- ----------------------List Available Forms------------------- -->
<div class="modal fade right" id="forms-list" tabindex="-1" role="dialog"  data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" [ngClass]="showCustomPopup  ? 'popup-custom-width' : ''">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close-circle" data-dismiss="modal">
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
                <h4 class="modal-title text-center">Forms</h4>
            </div>
            <div class="modal-body">
                <div class="row" *ngIf="!formsError">
                    <div class="col-xs-12 p5" style="margin-bottom: -10px;">
                        <div class="portlet light">
                            <div class="portlet-title">
                                <div class="inputs mMargin" id="right">
                                    <div id="left" class="mPadSort">
                                        <select class="form-control" [(ngModel)]="sortOption.formsSortOption" (ngModelChange)="sortBy($event)" style="position: relative;right: -3px;">
                                            <option *ngFor="let option of sortOption.manageFormsSortOptions" [ngValue]="option">
                                            {{option.name}}
                                        </option>
                                        </select>
                                    </div>
                                    <div class="portlet-input input-inline input-small mPadSearch" id="search">
                                        <div class="input-icon right" id="search-icon">
                                            <input type="text" id="search-text" class="form-control" [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}" placeholder="search..." (keypress)="eventHandler($event.keyCode)">
                                            <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="sortOption.searchKey" (click)="sortOption.searchKey='';searchForms();"></button>
                                            <button type="submit" class="search-box-item-click" (click)="searchForms()">
                                                <i class="fa fa-search" aria-hidden="true"></i> </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <app-list-loader *ngIf="formsLoader.isLoading"></app-list-loader>
                            <div class="table-responsive" *ngIf="!formsLoader.isLoading">
                                <table class='table tgrid table-hover table-sm' *ngIf="pagination.pagedItems?.length>0" aria-describedby="describe">
                                    <thead>
                                        <tr>
                                            <th scope="row" *ngIf="authenticationService.isShowForms">Select</th>
                                            <th scope="row">Form Details</th>
                                            <th scope="row" *ngIf="!authenticationService.isShowForms">Link</th>
                                            <th scope="row" *ngIf="!authenticationService.isShowForms && showEmbedLink">Embed Link</th>
                                            <th scope="row"class="text-center">Preview</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let form of pagination.pagedItems ;let i =index">
                                            <td *ngIf="authenticationService.isShowForms">
                                                <input type="checkbox" [checked]="selectedFormId === form.id" (click)="selectedForm(form, $event)"></td>
                                            <td>
                                                <h4 class="ellipsis mt5 mb5 f-w-600 mFloat" title="{{form?.name}}">
                                                    {{form?.name | slice:0:25}} <span *ngIf="form?.name?.length>25">...</span>
                                                </h4>
                                                <br>
                                                <h6 *ngIf="!showDefaultForms">
                                                    Created By <strong>{{form?.createdName}}</strong>
                                                </h6>
                                                <h6 *ngIf="!showDefaultForms">
                                                    From <strong>{{form?.companyName}}</strong>
                                                </h6>
                                                <h6 class="view-banner" *ngIf="form.formSubType === 'REGULAR'" translate>Regular</h6>
                                                <h6 class="view-banner" *ngIf="form.formSubType === 'QUIZ'" translate>Quiz</h6>
                                                <h6 class="view-banner" *ngIf="form.formSubType === 'SURVEY'" translate>Survey</h6>
                                            </td>
                                            <td  [hidden]="authenticationService.isShowForms">
                                                <div style="display:flex; height:45px">
                                                    <span>
                                                        <input type="text" id="copy-link" readonly="readonly" value="{{form.ailasUrl}}" #userinput><br>
                                                    </span>                                                    
                                                    <span class="modal-icon ml10" id="custom-margin-{{i}}">
                                                        <a [hidden]="authenticationService.isShowForms" data-toggle="tooltip" data-placement="top" title="Copy"
                                                            (click)="copyInputMessage(userinput,'Page Link',i)">
                                                            <i class="fa fa-copy" aria-hidden="true"></i>
                                                        </a>
                                                    </span>
                                                </div>                                                
                                                <div>
                                                    <span class="success" id="copied-message-{{i}}" style="display: none;">
                                                        <strong>Link copied successfully<i class="fa fa-check" aria-hidden="true"></i></strong>
                                                    </span>
                                                </div>                                                
                                            </td>                                            
                                            <td [hidden]="!showEmbedLink || authenticationService.isShowForms">
                                                <div style="display:flex">
                                                    <span>
                                                        <textarea id="text-area" class="video" rows="1" cols="50" readonly="readonly" spellcheck="false" #iframeUrlInput>{{form.embedUrl}}</textarea>
                                                    </span>
                                                    <span class="modal-icon cmif ml10" id="cmif-{{i}}">
                                                        <a [hidden]="authenticationService.isShowForms" data-toggle="tooltip" data-placement="top" title="Copy" 
                                                            (click)="copyInputMessage(iframeUrlInput,'Embed Link',i)">
                                                            <i class="fa fa-copy" aria-hidden="true"></i>
                                                        </a>
                                                    </span>
                                                </div>                                                
                                                <div>
                                                    <span class="success" id="embed-copied-message-{{i}}" style="display:none;">
                                                        <strong>Embed link copied successfully<i class="fa fa-check" aria-hidden="true"></i></strong>
                                                    </span>
                                                </div>
                                            </td>                                            
                                            <td id="actions-row" style="text-align: center;  vertical-align: middle;">
                                                <a data-toggle="tooltip" data-placement="top" title="Preview" (click)="previewForm(form.id)">
                                                    <i class="fa fa-eye" aria-hidden="true"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div *ngIf="pagination.pagedItems.length !== 0" class="pg8">
                                <app-pagination [pagination]="pagination" (notifyParent)="setPage($event)" (notifyParentDropDown)="listForms($event)" [hidden]="formsLoader.isLoading"></app-pagination>
                            </div>
                            <!-- End of 24 -->
                            <div *ngIf="pagination.totalRecords==0 && !formsLoader.isLoading" class="alert alert-info">
                                <strong>No Forms Found.</strong>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="formsError">
                    <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible">
                    </app-response-message>
                </div>

            </div>
            <div class="modal-footer">
                <a data-dismiss="modal" class="btn btn-default" style="float: right"><span
            *ngIf="!authenticationService.isShowForms">Close</span><span
            *ngIf="authenticationService.isShowForms">Submit</span></a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade right" id="form-preview-modal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close-circle" data-dismiss="modal">
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
                <h4 class="modal-title text-center">Form Preview</h4>
            </div>
            <div [ngStyle]="{ 'background-image': 'url(' + formBackgroundImage + ')','background-repeat': 'no-repeat','background-size': 'cover'}" [style.backgroundColor]="pageBackgroundColor">
                <div class="modal-body">
                    <ngx-loading [show]="ngxloading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
                    <div *ngIf="form.showCompanyLogo">
                        <img id="form-company-logo" *ngIf="form.companyLogo.indexOf('images/')===0;" [src]="authenticationService.MEDIA_URL + form.companyLogo" alt="" />
                        <img id="form-company-logo" *ngIf="form.companyLogo.indexOf('images/')!==0;" [src]="form.companyLogo" alt="" />
                    </div>
                    <div class="vertical-center">
                        <div class="panel panel-info mWid" *ngIf="!formError" [style.backgroundColor]="form.backgroundColor" [style.borderColor]="form.borderColor">
                            <div *ngIf="form.showTitleHeader" class="panel-heading" [style.backgroundColor]="form.borderColor" [style.color]="form.titleColor" [style.borderColor]="form.borderColor">
                                <div class="panel-title form-name-wrap" title="{{form.name}}">{{form.name}}</div>
                            </div>
                            <div class="panel-body d-p-bg-color-cust" *ngIf="!formError">
                                <div class="form-name-wrap form-description" title="{{form.description}}" [style.color]="form.descriptionColor">{{form.description}}</div>
                                <ng-container *ngFor="let columnInfo of form?.formLabelDTOs;let i = index">
                                    <div class="form-group label-box d-p-bg-color-cust">
                                        <label class="control-label"><span
                                                *ngIf="learningTrackId !== undefined && learningTrackId > 0 && form.quizForm">{{i+1}}.
                                            </span><span [style.color]="form.labelColor">{{columnInfo.labelName}}</span>
                                            <span class="required" *ngIf="columnInfo.required">*</span>
                                        </label>

                                        <ng-container *ngIf="columnInfo.labelType=='text' || columnInfo.labelType=='email' || columnInfo.labelType=='number'">
                                            <input type="{{columnInfo.labelType}}" class="form-control" placeholder="{{columnInfo.placeHolder}}" id="{{columnInfo.labelId}}" maxlength="1000" disabled="disabled">
                                        </ng-container>

                                        <ng-container *ngIf="columnInfo.labelType=='textarea'">
                                            <textarea rows="4" cols="4" class="form-control" placeholder="{{columnInfo.placeHolder}}" maxlength="1000" disabled="disabled"></textarea>
                                        </ng-container>
                                        <!-- ---------------------------Date----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType=='date'">
                                            <app-date-picker [class.disabled]='true' [isFromForm]='true'></app-date-picker>
                                        </ng-container>
                                        <!-- ---------------------------Price----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType=='price'">
                                            <div class="input-group prefix">
                                                <span class="input-group-addon" style="pointer-events: none;">
                        								{{columnInfo.priceSymbol}}
                     							 </span>
                                                <input type="number" min="0" class="form-control" disabled="disabled" placeholder="{{columnInfo.placeHolder}}">
                                            </div>
                                        </ng-container>
                                        <!-- ---------------------------Upload----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType=='upload'">
                                            <input type="file" class="form-control" disabled="disabled">
                                        </ng-container>
                                        <!-- ---------------------------Radio Button----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType=='radio'">
                                            <ng-container *ngFor="let radioButton of columnInfo.radioButtonChoices;let i=index">
                                                <div class="form-check">
                                                    <label class="form-check-label" style="border: 0px !important;">
                          <input type="{{columnInfo.labelType}}" name="{{columnInfo.labelId}}" class="form-check-input"
                            disabled="disabled">
                           <span [style.color]="form.labelColor">{{radioButton.name}}</span>
                        </label>

                                                    <!-- <label class="form-check-label">
                                                        <input type="{{columnInfo.labelType}}" name="{{columnInfo.labelId}}" class="form-check-input"
                                                            disabled="disabled">
                                                       
                                                    </label> -->

                                                </div>
                                                <!-- <br> -->
                                            </ng-container>
                                        </ng-container>
                                        <!-- ---------------------------Check Box----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType=='checkbox'">
                                            <ng-container *ngFor="let checkBox of columnInfo.checkBoxChoices;let i=index">
                                                <div class="form-check">

                                                    <label class="form-check-label" style="border: 0px !important;">
                                                    <input type="{{columnInfo.labelType}}" name="{{columnInfo.labelId}}" class="form-check-input"
                                                      disabled="disabled">
                                                     <span [style.color]="form.labelColor">{{checkBox.name}}</span>
                                                  </label>
                                                </div>
                                                <!-- <br> -->
                                            </ng-container>
                                        </ng-container>
                                        <!-- ---------------------------DropDown Menu----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType=='select'">
                                            <select class="form-control">
                                          <option *ngFor="let dropDownValue of columnInfo.dropDownChoices">
                                            {{dropDownValue.name}}</option>
                                        </select>
                                        </ng-container>
                                        <!-- ---------------------------Quiz Choices----------------------------- -->
                                        <ng-container *ngIf="columnInfo.labelType.split('_')[0]=='quiz'">
                                            <ng-container *ngFor="let choice of columnInfo.choices;let i=index">
                                                <div class="form-check">
                                                    <label class="form-check-label" style="border: 0px !important;">
                                                        <input type="{{columnInfo.labelType.split('_')[1]}}" name="{{columnInfo.labelId}}" class="form-check-input"
                                                            disabled="disabled">
                                                            <span class="quiz_optionname" [style.color]="form.labelColor"> {{choice.name}}</span>

                                                    </label>
                                                </div>
                                                <!-- <br> -->
                                            </ng-container>
                                        </ng-container>
                                    </div>
                                </ng-container>
                                <div *ngIf="form.showCaptcha">
                                    <re-captcha (resolved)="resolved($event)" [siteKey]="siteKey"></re-captcha>
                                </div>
                                <div *ngIf="form.buttonColor?.length>0;then show else dontShow"></div>
                                <ng-template #show>
                                    <button type="submit" disabled="disabled" class="button-padding" id="bottom-right" [style.backgroundColor]="form.buttonColor" [style.color]="form.buttonValueColor">{{form.buttonValue}}</button>
                                </ng-template>
                                <ng-template #dontShow>
                                    <button type="submit" disabled="disabled" class="btn green-haze" id="bottom-right" [style.color]="form.buttonValueColor">{{form.buttonValue}}</button>
                                </ng-template>
                            </div>
                        </div>
                        <!------Show Footer-------->
                        <footer>
                            <div style="text-align: center;" *ngIf="form.showFooter && form.footer" [innerHTML]="sanitizer.bypassSecurityTrustHtml(form.footer)"></div>
                        </footer>
                    </div>
                    <div *ngIf="formError">
                        <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible">
                        </app-response-message>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a data-dismiss="modal" class="btn btn-default" id="bottom-right">Close</a>
            </div>
        </div>
    </div>
</div>
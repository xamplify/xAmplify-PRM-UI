<div class="page-content row mr0" *ngIf="!viewLeads && !showLeadForm && !showDealForm && !viewDeals">
  <div class="page-bar" style="height:48px;">
    <ul class="page-breadcrumb">
      <li><i class="fa fa-home" aria-hidden="true"></i>
        <a [routerLink]="referenceService?.homeRouter" translate>Home</a>
        <i class="fa fa-angle-right" aria-hidden="true"></i>
      </li>
      <li *ngIf="!isFromCompanyModule">
        <a (click)="backToManageContacts()" translate> Manage Contacts
        </a>
      </li>
      <li *ngIf="isFromCompanyModule">
        <a translate [routerLink]="companyRouter">Manage Companies</a>
      </li>
      <li>
        <a (click)="backToEditContacts()" translate>
          <i class="fa fa-angle-right" aria-hidden="true"></i>Edit Contacts
        </a>
      </li>
      <li>
        <a translate>
          <i class="fa fa-angle-right" aria-hidden="true"></i>Contact Details
        </a>
      </li>
    </ul>
  </div>
  <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
  <div class="details_flex">
    <ngx-loading [show]="isLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
    <div class="profile-sidebar d-flex">
      <div class="profile-leftsidebar">
        <div class="edit_contact">
          <!-- Header 1 -->
          <div class="profile_header">
            <div class="avatar2">
              <span class="avatar-initial">{{highlightLetter}}</span>
            </div>
            <div class="profile_info">
              <div *ngIf="contactName != undefined && contactName != ''">
                <i class="fa fa-user mr_6 icons_colors" aria-hidden="true"></i>
                <span data-toggle="tooltip" data-placement="bottom" title="{{contactName || ''}}">
                  {{contactName | slice:0:10}} <span *ngIf="contactName != undefined && contactName?.length>10">..</span>
                </span>
                <i class="fa fa-edit ml_6" (click)="editContactDetails(selectedContact)" aria-hidden="true"></i>
              </div>
              <span class="email-id">
                <p data-toggle="tooltip" data-placement="bottom" title="{{selectedContact?.emailId}}">
                  <i class="fa fa-envelope mr_6 icons_colors"></i>{{selectedContact?.emailId | slice:0:16}}<span
                    *ngIf="selectedContact?.emailId?.length>16">..</span>
                </p>
                <button class="copy-btn" #textEmail value="{{selectedContact?.emailId}}" (click)="copyEmail(textEmail)">
                  <i *ngIf="isEmailCopied" class="fa fa-check ml_6" aria-hidden="true"></i><i *ngIf="!isEmailCopied"
                    class="fa fa-clone ml_6" aria-hidden="true"></i></button>
              </span>
              <span *ngIf="selectedContact?.mobileNumber != undefined && selectedContact?.mobileNumber != ''" class="email-id">
                <p data-toggle="tooltip" data-placement="bottom" title="{{selectedContact?.mobileNumber}}">
                  <i class="fa fa-phone mr_6 icons_colors"></i>{{selectedContact.mobileNumber}}
                </p>
                <button class="copy-btn" #textMobile value="{{selectedContact?.mobileNumber}}" (click)="copyMobileNumber(textMobile)">
                  <i *ngIf="isMobileNumberCopied" class="fa fa-check ml_6" aria-hidden="true"></i><i *ngIf="!isMobileNumberCopied"
                    class="fa fa-clone ml_6" aria-hidden="true"></i></button>
              </span>
            </div>
          </div>
          <!--  -->
          <div class="icon-group">
            <div class="icon-item">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Create a Note">
                <i class="glyphicon glyphicon-pencil"></i>
              </div>
              <div class="icon-label">Note</div>
            </div>
            <div class="icon-item" (click)="showModalPopup()">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Create a Email">
                <i class="glyphicon glyphicon-envelope"></i>
              </div>
              <div class="icon-label">Email</div>
            </div>
            <div class="icon-item">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Create a Task">
                <i class="glyphicon glyphicon-file"></i>
              </div>
              <div class="icon-label">Task</div>
            </div>
            <div class="icon-item">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Create a Meeting">
                <i class="glyphicon glyphicon-calendar"></i>
              </div>
              <div class="icon-label">Meeting</div>
            </div>
          </div>
          <!-- end -->
        </div>
        <!-- Header-contacts-Details start-->
        <div class="lead_details">
          <h3>Lead Details
            <a data-toggle="collapse" (click)="toggleClass('account-details-icon')" style="float: right;"
              href="javascript:;#accountDetailsDropdown">
              <i id="account-details-icon" class="fa fa-minus" aria-hidden="true"></i>
            </a>
            <ul id="accountDetailsDropdown" class="nav collapse in">
              <li><i class="fas fa-building"></i>
                <div class="user_details">
                  <span class="address_title">Company</span>
                  <p *ngIf="selectedContact?.contactCompany != undefined" class="mb0">{{selectedContact?.contactCompany}}
                  </p>
                </div>
              </li>
              <li><i class="fas fa-briefcase"></i>
                <div class="user_details">
                  <span class="address_title">Job Title</span>
                  <p *ngIf="selectedContact?.jobTitle != undefined" class="mb0">{{selectedContact?.jobTitle}}</p>
                </div>
              </li>
              <li><i class="fas fa-map-marker-alt"></i>
                <div class="user_details">
                  <span class="address_title">Address</span>
                  <p *ngIf="selectedContact?.address != undefined" class="mb0">{{selectedContact?.address}}</p>
                </div>
              </li>
              <li><i class="fas fa-city"></i>
                <div class="user_details">
                  <span class="address_title">City</span>
                  <p *ngIf="selectedContact?.city != undefined" class="mb0">{{selectedContact?.city}}</p>
                </div>
              </li>
              <li><i class="fas fa-map"></i>
                <div class="user_details">
                  <span class="address_title">State/Province</span>
                  <p *ngIf="selectedContact?.state != undefined" class="mb0">{{selectedContact?.state}}</p>
                </div>
              </li>
              <li><i class="fas fa-mail-bulk"></i>
                <div class="user_details">
                  <span class="address_title"> Postal Code</span>
                  <p *ngIf="selectedContact?.zipCode != undefined" class="mb0">{{selectedContact?.zipCode}}</p>
                </div>
              </li>
              <li><i class="fas fa-globe"></i>
                <div class="user_details">
                  <span class="address_title"> Country</span>
                  <p *ngIf="selectedContact?.country != undefined" class="mb0">{{selectedContact?.country}}</p>
                </div>
              </li>
            </ul>
          </h3>
        </div>
      </div>
    </div>
    <!-- End -->
    <div class="profile-content card-shadow d-flex">
      <div class="row m0">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 p0">
          <div class="portlet light border-unset">
            <div class="portlet-title tabbable-line">
              <div class="caption caption-md col-xs-12">
                <span class="caption-subject font-blue-madison bold">{{title}}</span>
              </div>
            </div>
            <div class="portlet-body clearfix">
              <!-- tabs start -->
              <div class="scrollbar-x">
                <ul class="nav nav-tabs hideBorder" style="margin-bottom:0px;">
                  <li class="active"><a (click)="setActiveTab('activity1')" data-toggle="tab" href="#activity1">Activity</a></li>
                  <li><a data-toggle="tab" (click)="setActiveTab('note1')" href="#note1">Notes</a>
                  </li>
                  <li><a data-toggle="tab" (click)="setActiveTab('email1')" href="#email1">Email</a>
                  </li>
                  <li><a data-toggle="tab" (click)="setActiveTab('form1')" href="#form1">Task</a></li>
                  <li><a data-toggle="tab" (click)="setActiveTab('meeting')" href="meeting">Meeting</a></li>
                </ul>
              </div>
              <div class="tab-content tab-bg p-13">
                <div *ngIf="showActivityTab" id="activity1" class="tab-pane fade in active integration-profile">
                  <!-- Start -->
                  <div class="activity_card mb10">
                    <div class="activity-header">
                      <span class="activity-title">Lorem Ipsum</span>
                      <span class="activity-date">Sep 27, 2024 at 12:57 PM</span>
                    </div>
                    <div class="activity-body">
                      Lorem Ipsum is simply dummy text of the printing...
                    </div>
                    <div class="activity-footer">
                      <a href="#">View details</a>
                    </div>
                  </div>
                  <div class="activity_card mb10">
                    <div class="activity-header">
                      <span class="activity-title">Lorem Ipsum</span>
                      <span class="activity-date">Sep 27, 2024 at 12:57 PM</span>
                    </div>
                    <div class="activity-body">
                      Lorem Ipsum is simply dummy text of the printing...
                    </div>
                    <div class="activity-footer">
                      <a href="#">View details</a>
                    </div>
                  </div>
                  <div class="activity_card mb10">
                    <div class="activity-header">
                      <span class="activity-title">Lorem Ipsum</span>
                      <span class="activity-date">Sep 27, 2024 at 12:57 PM</span>
                    </div>
                    <div class="activity-body">
                      Lorem Ipsum is simply dummy text of the printing...
                    </div>
                    <div class="activity-footer">
                      <a href="#">View details</a>
                    </div>
                  </div>
                  <!-- end -->
                </div>
                <div *ngIf="showNotesTab" id="note1" class="tab-pane fade pt-top">
                  xsxszxsdddrfsd
                </div>
                <div *ngIf="showEmailTab" id="email1" class="tab-pane fade pt-top">
                  <app-email-activity [contactId]="contactId"></app-email-activity>
                </div>
                <div *ngIf="showFormsTab" id="form1" class="tab-pane fade pt-top">
                  dcsddcscde
                </div>
                <div *ngIf="showMeetingsTab" id="meeting" class="tab-pane fade pt-top">
                  dcsddcscde
                </div>
              </div>
              <!-- END -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- END -->
    <div class="asidebar">
      <!--  -->
      <div class="panel-group" id="accordion">
        <!-- Accordion Item 1 -->
        <div class="panel-default panel-dropdown">
          <div class="panel-headings">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapse1">
                Leads({{leadsCount}})
              </a>
              <a (click)="addLead()" class="add-btn"><span>+ Add</span></a>
            </h4>
          </div>
          <div id="collapse1" class="panel-collapse collapse in">
            <app-response-message [customResponse]="leadsResponse" *ngIf="leadsResponse.isVisible"></app-response-message>
            <app-dropdown-loader *ngIf="leadsLoader?.isLoading" [text]="'leads'"></app-dropdown-loader>
            <div class="panel-body" *ngIf="contactLeads.length > 0">
              <div class="activity_card mb10" *ngFor="let lead of contactLeads">
                <div class="activity-header">
                  <a (click)="viewLead(lead)">
                    <span class="activity-title">{{lead.firstName != null ? lead.firstName:''}} {{lead.lastName}}</span>
                  </a>
                </div>
                <div class="activity-body">
                  Company: {{lead.companyName}}
                </div>
                <div class="activity-body">
                  Stage: {{lead.stageName}}
                </div>
              </div>
              <div class="activity-footer">
                <a (click)="viewMoreLeads()"><span>View More</span></a>
              </div>
            </div>
            <div class="panel-body" *ngIf="!(contactLeads.length > 0) && !leadsLoader?.isLoading">
              No leads associated with this contact.
            </div>
          </div>
        </div>
        <!-- Accordion Item 2 -->
        <div class="panel-default panel-dropdown">
          <div class="panel-headings">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapse2">
                Deals ({{dealsCount}})
              </a>
              <a (click)="addDeal()" class="add-btn"><span>+ Add</span></a>
            </h4>
          </div>
          <div id="collapse2" class="panel-collapse collapse">
            <app-response-message [customResponse]="dealsResponse" *ngIf="dealsResponse.isVisible"></app-response-message>
            <app-dropdown-loader *ngIf="dealsLoader?.isLoading" [text]="'deals'"></app-dropdown-loader>
            <div class="panel-body" *ngIf="contactDeals.length > 0">
              <div class="activity_card mb10" *ngFor="let deal of contactDeals">
                <div class="activity-header">
                  <a (click)="viewDeal(deal)">
                    <span class="activity-title">{{deal.title}}</span>
                  </a>
                </div>
                <div class="activity-body">
                  Amount: {{deal.amount}}
                </div>
                <div class="activity-body">
                  Close Date: {{deal.closeDate}}
                </div>
                <div class="activity-body">
                  Stage: {{deal.stageName}}
                </div>
              </div>
              <div class="activity-footer">
                <a (click)="viewMoreDeals()"><span>View More</span></a>
              </div>
            </div>
            <div class="panel-body" *ngIf="!(contactDeals.length > 0) && !dealsLoader.isLoading">
              No deals associated with this contact.
            </div>
          </div>
        </div>
        <!-- Add more accordion items as needed -->
      </div>
      <!--  -->
    </div>
    <!--  -->
  </div>
</div>

<div *ngIf="contactService.isContactModalPopup && updateContactUser">
  <app-add-contact-modal [isTeamMemberPartnerList]="isTeamMemberPartnerList" [gdprInput]="gdprInput"
    [totalUsers]="contacts" [contactDetails]="contactAllDetails" [isUpdateUser]="isUpdateUser"
    [selectedCompanyId]="selectedCompanyContactId" [isCompanyContact]="isCompanyContact"
    (notifyParent)="updateContactListUser($event)"></app-add-contact-modal>
</div>

<app-add-email-modal-popup *ngIf="showEmailModalPopup" [userId]="contactId" [actionType]="actionType"
  [userEmailId]="selectedContact.emailId" [emailActivityId]="emailActivityId" (notifySubmitSuccess)="showSubmitSuccessStatus($event)"
  (notifyClose)="closeModalPopup()"></app-add-email-modal-popup>

<app-custom-manage-leads *ngIf="viewLeads" [listView]="true" [isConvertingContactToLead]="true" [isFromCompanyModule]="isFromCompanyModule"
  [selectedContact]="selectedContact" (notifyClose)="closeViewMoreLeadsTab()"></app-custom-manage-leads>

<app-custom-add-lead *ngIf="showLeadForm" [actionType]="actionType" [leadId]="leadId"
  [selectedContact]="selectedContact" [isFromCompanyModule]="isFromCompanyModule" [isConvertingContactToLead]="true"
  (notifyClose)="closeLeadForm()" (notifySubmitSuccess)="showLeadSubmitSuccess($event)"></app-custom-add-lead>

<app-custom-manage-deals *ngIf="viewDeals" [selectedContact]="selectedContact" [isDealFromContact]="true"
  (notifyClose)="closeViewMoreDealsTab()" [isFromCompanyModule]="isFromCompanyModule"></app-custom-manage-deals>

<app-add-deal *ngIf="showDealForm" [dealId]="dealId" [actionType]="actionType" [selectedContact]="selectedContact"
  [isDealFromContact]="true" (notifySubmitSuccess)="showDealSubmitSuccess()" [isFromCompanyModule]="isFromCompanyModule"
  (notifyClose)="closeDealForm()"></app-add-deal>
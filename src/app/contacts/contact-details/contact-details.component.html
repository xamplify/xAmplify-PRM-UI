<div class="page-content row mr0" *ngIf="!viewLeads && !showLeadForm && !showDealForm && !viewDeals && !viewCampaigns">
  <div class="page-bar mb-height_auto" style="height:48px;">
    <ul class="page-breadcrumb">
      <li><i class="fa fa-home" aria-hidden="true"></i>
        <a [routerLink]="referenceService?.homeRouter" translate>Home</a>
        <i class="fa fa-angle-right" aria-hidden="true"></i>
      </li>
      <li *ngIf="!isFromCompanyModule">
        <a (click)="backToManageContacts()" translate> Manage Contacts
        </a>
      </li>
      <li *ngIf="isFromCompanyModule">
        <a translate [routerLink]="companyRouter">Manage Companies</a>
      </li>
      <li>
        <a (click)="backToEditContacts()" translate>
          <i class="fa fa-angle-right" aria-hidden="true"></i>Edit Contacts
        </a>
      </li>
      <li>
        <a translate>
          <i class="fa fa-angle-right" aria-hidden="true"></i>Contact Journey
        </a>
      </li>
    </ul>
  </div>
  <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
  <div class="portlet light card1_p0 overflow_scroll">
  <div class="details_flex">
    <div class="profile-sidebar d-flex">
      <ngx-loading [show]="isLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
      <ngx-loading [show]="ngxLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
      <div class="profile-leftsidebar">
        <div class="edit_contact">
          <!-- Header 1 -->
          <div class="profile_header">
            <div [ngClass]="showImageTag ? 'avatar2_v2' : 'avatar2'">
              <span *ngIf="!showImageTag" class="avatar-initial">{{highlightLetter}}</span>
              <img *ngIf="showImageTag" class="img_wdt" src="{{imageSourcePath}}" alt="">
            </div>
            <div class="profile_info">
              <div>
                <i class="fas fa-user mr_6 icons_colors" aria-hidden="true"></i>
                <span *ngIf="contactName != undefined && contactName != ''" data-toggle="tooltip" data-placement="bottom" title="{{contactName || ''}}">
                  {{contactName | slice:0:9}}<span *ngIf="contactName != undefined && contactName?.length>9">..</span>
                </span>
                <span *ngIf="contactName == undefined || contactName == ''" class="anonymous-text">Anonymous</span>
                <i class="fa fa-edit ml_6" (click)="editContactDetails(selectedContact)" aria-hidden="true"></i>
              </div>
              <span class="email-id">
                <p data-toggle="tooltip" data-placement="bottom" title="{{selectedContact?.emailId}}">
                  <i class="fa fa-envelope mr_6 icons_colors"></i>{{selectedContact?.emailId | slice:0:16}}<span
                    *ngIf="selectedContact?.emailId?.length>16">..</span>
                </p>
                <button class="copy-btn" #textEmail value="{{selectedContact?.emailId}}" (click)="copyEmail(textEmail)">
                  <i *ngIf="isEmailCopied" class="fa fa-check ml_6" aria-hidden="true"></i><i *ngIf="!isEmailCopied"
                    class="fa fa-clone ml_6" aria-hidden="true"></i></button>
              </span>
              <span *ngIf="selectedContact?.mobileNumber != undefined && selectedContact?.mobileNumber != ''" class="email-id">
                <p data-toggle="tooltip" data-placement="bottom" title="{{selectedContact?.mobileNumber}}">
                  <i class="fa fa-phone mr_6 icons_colors"></i>{{selectedContact.mobileNumber}}
                </p>
                <button class="copy-btn" #textMobile value="{{selectedContact?.mobileNumber}}" (click)="copyMobileNumber(textMobile)">
                  <i *ngIf="isMobileNumberCopied" class="fa fa-check ml_6" aria-hidden="true"></i><i *ngIf="!isMobileNumberCopied"
                    class="fa fa-clone ml_6" aria-hidden="true"></i></button>
              </span>
            </div>
          </div>
          <!--  -->
          <div class="icon-group">
            <div class="icon-item" (click)="openAddNoteModalPopup()">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Add Notes">
                <i class="glyphicon glyphicon-pencil"></i>
              </div>
              <div class="icon-label">Notes</div>
            </div>
            <div class="icon-item" (click)="openEmailModalPopup()">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Send an Email">
                <i class="glyphicon glyphicon-envelope"></i>
              </div>
              <div class="icon-label">Email</div>
            </div>
            <div class="icon-item" (click)="openTaskModalPopup()">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Add a Task">
                <i class="glyphicon glyphicon-file"></i>
              </div>
              <div class="icon-label">Task</div>
            </div>
            <div class="icon-item" (click)="openMeetingModalPopup()">
              <div class="icon-btns" data-toggle="tooltip" data-placement="top" title="Schedule Meeting">
                <i *ngIf="!ngxLoading" class="glyphicon glyphicon-calendar"></i>
                <img *ngIf="ngxLoading" class="h-50px" src="../../../assets/images/Spinner.gif" alt="">
              </div>
              <div class="icon-label">Meeting</div>
            </div>
          </div>
          <!-- end -->
        </div>
        <!-- Header-contacts-Details start-->
        <div class="lead_details">
          <h3>Contact Details:
            <a data-toggle="collapse" (click)="toggleClass('account-details-icon')" style="float: right;"
              href="javascript:;#accountDetailsDropdown">
              <i id="account-details-icon" class="fa fa-minus" aria-hidden="true"></i>
            </a>
            <ul id="accountDetailsDropdown" class="nav collapse in">
              <li><i class="fas fa-building"></i>
                <div class="user_details">
                  <span class="address_title">Company:</span>
                  <span *ngIf="selectedContact?.contactCompany != undefined" class="mb0">{{selectedContact?.contactCompany}}
                  </span>
                </div>
              </li>
              <li><i class="fas fa-briefcase"></i>
                <div class="user_details">
                  <span class="address_title">Job Title:</span>
                  <span *ngIf="selectedContact?.jobTitle != undefined" class="mb0">{{selectedContact?.jobTitle}}</span>
                </div>
              </li>
              <li><i class="fas fa-map-marker-alt"></i>
                <div class="user_details">
                  <span class="address_title">Address:</span>
                  <span *ngIf="selectedContact?.address != undefined" class="mb0">{{selectedContact?.address}}</span>
                </div>
              </li>
              <li><i class="fas fa-city"></i>
                <div class="user_details">
                  <span class="address_title">City:</span>
                  <span *ngIf="selectedContact?.city != undefined" class="mb0">{{selectedContact?.city}}</span>
                </div>
              </li>
              <li><i class="fas fa-map"></i>
                <div class="user_details">
                  <span class="address_title">State/Province:</span>
                  <span *ngIf="selectedContact?.state != undefined" class="mb0">{{selectedContact?.state}}</span>
                </div>
              </li>
              <li><i class="fas fa-mail-bulk"></i>
                <div class="user_details">
                  <span class="address_title"> Postal Code:</span>
                  <span *ngIf="selectedContact?.zipCode != undefined" class="mb0">{{selectedContact?.zipCode}}</span>
                </div>
              </li>
              <li><i class="fas fa-globe"></i>
                <div class="user_details">
                  <span class="address_title"> Country:</span>
                  <span *ngIf="selectedContact?.country != undefined" class="mb0">{{selectedContact?.country}}</span>
                </div>
              </li>
              <li *ngFor="let flexiField of selectedContact?.flexiFields">
                <i class="fas fa-highlighter"></i>
                <div class="user_details">
                  <span class="address_title">{{flexiField.fieldName}}:</span>
                  <span class="mb0">{{flexiField.fieldValue}}</span>
                </div>
              </li>
            </ul>
          </h3>
        </div>
      </div>
    </div>
    <!-- End -->
    <div class="profile-content card-shadow d-flex">
      <div class="row m0">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 p0 contact_jounrey">
          <div class="portlet light border-unset contact_bgcolor">
            <div class="portlet-title tabbable-line">
              <div class="caption caption-md col-xs-12">
                <span class="caption-subject font-blue-madison bold">{{title}}</span>
              </div>
            </div>
            <div class="portlet-body clearfix">
              <!-- tabs start -->
              <div class="scrollbar-x">
                <ul class="nav nav-tabs hideBorder" style="margin-bottom:0px;">
                  <li class="active"><a (click)="setActiveTab('activity1')" data-toggle="tab" href="#activity1">Activity</a></li>
                  <li><a data-toggle="tab" (click)="setActiveTab('note1')" href="#note1">Notes</a>
                  </li>
                  <li><a data-toggle="tab" (click)="setActiveTab('email1')" href="#email1">Email</a>
                  </li>
                  <li><a data-toggle="tab" (click)="setActiveTab('form1')" href="#form1">Task</a></li>
                  <li><a data-toggle="tab" (click)="setActiveTab('meeting')" href="#meeting">Meeting</a></li>
                </ul>
              </div>
              <div class="tab-content tab-bg p-13">
                <div id="activity1" class="tab-pane fade in active integration-profile">
                  <app-activity-stream *ngIf="showActivityTab" [contactId]="contactId" [reloadTab]="isReloadActivityTab"
                    [isFromCompanyModule]="isFromCompanyModule" (notifyShowDealForm)="viewDeal($event)"
                    (notifyShowLeadForm)="viewLead($event)" [selectedContactListId]="selectedContactListId" [contactName]="contactName"
                    [contactEmailId]="selectedContact.emailId" (notifyNoteUpdateSuccess)="showNoteUpdateCutomResponse($event)"
                    (notifyNoteDeleteSuccess)="showNoteDeleteSuccessStatus($event)"
                    (notifyTaskUpdateSuccess)="showTaskUpdateCutomResponse($event)"
                    (notifyTaskDeleteSuccess)="showTaskDeleteSuccessStatus($event)"></app-activity-stream>
                </div>
                <div *ngIf="showNotesTab" id="note1" class="tab-pane fade pt-top">
                  <app-note [contactId]="contactId" [reloadTab]="isReloadNoteTab" (notifyUpdateSuccess)="showNoteUpdateCutomResponse($event)"
                    (notifyDeleteSuccess)="showNoteDeleteSuccessStatus($event)" (notifySubmitSuccess)="showNoteCutomResponse($event)"></app-note>
                </div>
                <div *ngIf="showEmailTab" id="email1" class="tab-pane fade pt-top">
                  <app-email-activity [contactId]="contactId" [reloadTab]="isReloadEmailActivityTab" [contactName]="contactName"
                    [contactEmailId]="selectedContact.emailId" (notifySubmitFailed)="showEmailFailedErrorStatus($event)"
                    (notifySubmitSuccess)="showEmailSubmitSuccessStatus($event)"></app-email-activity>
                </div>
                <div *ngIf="showFormsTab" id="form1" class="tab-pane fade pt-top">
                  <app-task-activity [contactId]="contactId" [reloadTab]="isReloadTaskActivityTab"
                    (notifyDeleteSuccess)="showTaskDeleteSuccessStatus($event)"
                    (notifyTaskUpdatedStatus)="showTaskUpdateCutomResponse($event)"
                    (notifySubmitSuccess)="showTaskSubmitSuccessStatus($event)"></app-task-activity>
                </div>
                <div *ngIf="showMeetingsTab" id="meeting" class="tab-pane fade pt-top">
                  <app-meeting-activity [contactId]="contactId" [activeCalendarDetails]="activeCalendarDetails"></app-meeting-activity>
                </div>
              </div>
              <!-- END -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- END -->
    <div class="asidebar">
      <!--  -->
      <div class="panel-group" id="accordion">
        <!-- Accordion Item 1 -->
        <div class="panel-default panel-dropdown">
          <div class="panel-headings">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapse1">
                Leads({{leadsCount}})
              </a>
              <a (click)="addLead()" class="add-btn underline-on-hover"><span>+ Add</span></a>
            </h4>
          </div>
          <div id="collapse1" class="panel-collapse collapse in">
            <app-response-message [customResponse]="leadsResponse" *ngIf="leadsResponse.isVisible"></app-response-message>
            <app-dropdown-loader *ngIf="leadsLoader?.isLoading" [text]="'leads'"></app-dropdown-loader>
            <div class="panel-body pt0" *ngIf="contactLeads.length > 0">
              <div class="deals_card mb10" *ngFor="let lead of contactLeads">
                <div>
                  <i class="fas fa-user mr5" aria-hidden="true"> </i>
                  <a class="add-btn underline-on-hover" (click)="viewLead(lead.id)">
                    <span class="activity-title">{{lead.firstName != null ? lead.firstName:''}} {{lead.lastName}}</span>
                  </a>
                </div>
                <div class="activity-body">
                  <label class="mb0 f-w-600"> Stage:</label> {{lead.stageName}}
                </div>
                <div *ngIf="lead.campaignName!=undefined" class="activity-body">
                  <label class="mb0 f-w-600"> Campaign:</label> {{lead.campaignName}}
                </div>
              </div>
              <div class="activity-footer">
                <a class="add-btn underline-on-hover" (click)="viewMoreLeads()"><span class="f-w-600">View More</span></a>
              </div>
            </div>
            <div class="panel-body pt0" *ngIf="!(contactLeads.length > 0) && !leadsLoader?.isLoading && !leadsResponse.isVisible">
              No leads associated with this contact.
            </div>
          </div>
        </div>
        <!-- Accordion Item 2 -->
        <div class="panel-default panel-dropdown">
          <div class="panel-headings">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapse2">
                Deals({{dealsCount}})
              </a>
              <a (click)="addDeal()" class="add-btn underline-on-hover"><span>+ Add</span></a>
            </h4>
          </div>
          <div id="collapse2" class="panel-collapse collapse in">
            <app-response-message [customResponse]="dealsResponse" *ngIf="dealsResponse.isVisible"></app-response-message>
            <app-dropdown-loader *ngIf="dealsLoader?.isLoading" [text]="'deals'"></app-dropdown-loader>
            <div class="panel-body pt0" *ngIf="contactDeals.length > 0">
              <div class="deals_card mb10" *ngFor="let deal of contactDeals">
                <div>
                  <a class="add-btn underline-on-hover" (click)="viewDeal(deal.id)">
                    <span class="activity-title">{{deal.title}}</span>
                  </a>
                </div>
                <div class="activity-body">
                  <i class="fa fa-usd" aria-hidden="true"></i>
                  <label class="mb0 f-w-600"> Amount: </label>{{deal.amount}}
                </div>
                <div class="activity-body">
                  <i class="fa fa-calendar" aria-hidden="true"></i> <label class="mb0 f-w-600"> Close Date: </label> {{deal.closeDate | slice:0:10}}
                </div>
                <div class="activity-body">
                  <label class="mb0 f-w-600"> Stage: </label>  {{deal.stageName}}
                </div>
                <div *ngIf="deal.campaignName!=undefined" class="activity-body">
                  <label class="mb0 f-w-600"> Campaign: </label>  {{deal.campaignName}}
                </div>
              </div>
              <div class="activity-footer">
                <a class="add-btn underline-on-hover" (click)="viewMoreDeals()"><span class="f-w-600">View More</span></a>
              </div>
            </div>
            <div class="panel-body pt0" *ngIf="!(contactDeals.length > 0) && !dealsLoader.isLoading && !dealsResponse.isVisible">
              No deals associated with this contact.
            </div>
          </div>
        </div>
        <!-- Accordion Item 3 -->
        <div class="panel-default panel-dropdown">
          <div class="panel-headings">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapse3">
                Campaigns({{campaignsCount}})
              </a>
            </h4>
          </div>
          <div id="collapse3" class="panel-collapse collapse in">
            <app-response-message [customResponse]="campaignsResponse" *ngIf="campaignsResponse.isVisible"></app-response-message>
            <app-dropdown-loader *ngIf="campaignsLoader.isLoading" [text]="'campaigns'"></app-dropdown-loader>
            <div class="panel-body pt0" *ngIf="contactCampaigns.length > 0">
              <div class="deals_card mb10" *ngFor="let campaign of contactCampaigns">
                <div>
                  <i class="fas fa-bullhorn mr5" aria-hidden="true"> </i>
                  <a class="add-btn underline-on-hover" (click)="viewCampaignTimeLine(campaign)">
                    <span class="activity-title">{{campaign.campaignName}}</span>
                  </a>
                </div>
                <div class="activity-body">
                  <label class="mb0 f-w-600"> Type:</label> {{campaign.campaignType}}
                </div>
                <div *ngIf="campaign.campaignName!=undefined" class="activity-body">
                  <label class="mb0 f-w-600"> Launched Time:</label> {{campaign.launchTime}}
                </div>
              </div>
              <div class="activity-footer">
                <a class="add-btn underline-on-hover" (click)="viewMoreCampaigns()"><span class="f-w-600">View More</span></a>
              </div>
            </div>
            <div class="panel-body pt0" *ngIf="!(contactCampaigns.length > 0) && !campaignsLoader?.isLoading && !campaignsResponse.isVisible">
              No Campaign associated with this contact.
            </div>
          </div>
        </div>
        <!-- Add more accordion items as needed -->
      </div>
      <!--  -->
    </div>
    <!--  -->
  </div>
  </div>
</div>

<div *ngIf="contactService.isContactModalPopup && updateContactUser">
  <app-add-contact-modal [isTeamMemberPartnerList]="isTeamMemberPartnerList" [gdprInput]="gdprInput"
    [totalUsers]="contacts" [contactDetails]="contactAllDetails" [isUpdateUser]="isUpdateUser"
    [selectedCompanyId]="selectedCompanyContactId" [isCompanyContact]="isCompanyContact"
    (notifyParent)="updateContactListUser($event)"></app-add-contact-modal>
</div>

<app-add-email-modal-popup *ngIf="showEmailModalPopup" [userId]="contactId" [actionType]="actionType"
  [userEmailId]="selectedContact.emailId" [emailActivityId]="emailActivityId" (notifySubmitSuccess)="showEmailSubmitSuccessStatus($event)"
  (notifyClose)="closeEmailModalPopup()" [isReloadEmailActivityTab]="isReloadEmailActivityTab" (notifySubmitFailed)="showEmailFailedErrorStatus($event)"></app-add-email-modal-popup>

<app-custom-manage-leads *ngIf="viewLeads" [listView]="true" [isConvertingContactToLead]="true" [isFromCompanyModule]="isFromCompanyModule"
  [selectedContact]="selectedContact" (notifyClose)="closeViewMoreLeadsTab()"></app-custom-manage-leads>

<app-custom-add-lead *ngIf="showLeadForm" [actionType]="actionType" [leadId]="leadId"
  [selectedContact]="selectedContact" [isFromCompanyModule]="isFromCompanyModule" [isConvertingContactToLead]="true"
  (notifyClose)="closeLeadForm()" (notifySubmitSuccess)="showLeadSubmitSuccess($event)"></app-custom-add-lead>

<app-custom-manage-deals *ngIf="viewDeals" [selectedContact]="selectedContact" [isDealFromContact]="true"
  (notifyClose)="closeViewMoreDealsTab()" [isFromCompanyModule]="isFromCompanyModule"></app-custom-manage-deals>

<app-add-deal *ngIf="showDealForm" [dealId]="dealId" [actionType]="actionType" [selectedContact]="selectedContact"
  [isDealFromContact]="true" (notifySubmitSuccess)="showDealSubmitSuccess()" [isFromCompanyModule]="isFromCompanyModule"
  (notifyClose)="closeDealForm()"></app-add-deal>

<app-add-note-modal-popup *ngIf="showAddNoteModalPopup" [contactId]="selectedContact.id" [isReloadTab]="isReloadNoteTab"
(notifySubmitSuccess)="showNoteCutomResponse($event)" (notifyClose)="closeAddNoteModalPopup()"></app-add-note-modal-popup>

<app-add-task-modal-popup *ngIf="showTaskModalPopup" [isReloadTaskActivityTab]="isReloadTaskActivityTab"
  (notifySubmitSuccess)="showTaskSubmitSuccessStatus($event)" [userId]="contactId" [actionType]="actionType"
  (notifyClose)="closeTaskModalPopup()"></app-add-task-modal-popup>

<app-add-meeting-modal-popup *ngIf="showMeetingModalPopup" [schedulingUrl]="activeCalendarDetails?.userUri"
  [calendarType]="activeCalendarDetails?.type" (notifyClose)="closeMeetingModalPopup()"></app-add-meeting-modal-popup>

<app-calendar-integration-modal-popup *ngIf="showCalendarIntegrationsModalPopup" (notifyClose)="closeCalendarIntegrationsModalPopup()"></app-calendar-integration-modal-popup>
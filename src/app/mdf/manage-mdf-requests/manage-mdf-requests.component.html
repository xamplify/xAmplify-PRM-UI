<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="page-content">
   <div class="page-bar">
      <div class="col-md-12 col-lg-12">
         <div class="row">
            <div class="col-md-6 col-lg-6 text-left" style="padding-left: 0px;">
               <ul class="page-breadcrumb">
                  <li>
                     <i class="fa fa-home" aria-hidden="true"></i>
                     <a [routerLink]="referenceService.homeRouter" translate>Home</a>
                     <i class="fa fa-angle-right" aria-hidden="true"></i>
                  </li>
                  <li>
                     <a (click)="goToSelectMdfPage()" translate>MDF</a>
                     <i class="fa fa-angle-right" aria-hidden="true"></i>
                  </li>
                  <li><a translate>Manage MDF Requests</a></li>
               </ul>
            </div>
            <div class="col-md-6 col-lg-6 text-right" style="padding-right: 4px;margin-top: -1px;"
               *ngIf="showMdfFormAnalyticsForParnterView && !vanityLogin && !loginAsPartner">
               <div class="btn-group refer-vendor-button"
                  style="padding-top: 7px;padding-bottom: 4px;padding-right: 3px;">
                  <a class="close-circle" (click)="goToManageRequest()" title="Close">
                     <i class="fa fa-times" aria-hidden="true"></i>
                  </a>
               </div>
            </div>
            <div class="col-md-6 col-lg-6 text-right" style="padding-right: 5px;"
               *ngIf="isPartnerView && (vanityLogin || loginAsPartner)">
               <div class="btn-group refer-vendor-button"
                  style="padding-top: 7px;padding-bottom: 4px;padding-right: 3px;">
                  <button (click)="goToAddRequest(vendorCompanyId)" class="button_blue bgcolor-unset"
                     style="border-radius: 3px !important;">
                     <span class="hidden-xs margin-right-design btn btn-primary transition text_pd-top1"
                        translate>Request MDF<i class="fa fa-user-plus" data-toggle="tooltip"
                           aria-hidden="true"></i></span>

                  </button>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="row">
      <div class="col-md-12 col-lg-12">
         <div class="portlet light height hgt_auto" style="height: 153px;">
            <div class="row mt" style="margin-top: 13px;">
               <app-box-loader [countLoader]="countLoader" [mdfModule]="true" *ngIf="tilesLoader"></app-box-loader>
               <div *ngIf="!tilesLoader" class="col-md-12 col-lg-12" style="padding-left: 24px;padding-right: 24px;">
                  <div class="row">
                     <div class="{{tileClass}}" id="pl" *ngIf="!isPartnerView">
                        <a class="dashboard-stat dashboard-stat-lighter yellow-gold min-h default-cursor">
                           <div class="visual">
                              <i aria-hidden="true" class=""></i>
                           </div>
                           <div class="details">
                              <div class="number NumberFontDecrease"><span data-toggle="tooltip" data-placement="top"
                                    title="{{mdfRequestTiles?.totalPartners}}">{{mdfRequestTiles?.totalPartners}}</span>
                              </div>
                              <div class="desc">Number of {{authenticationService?.partnerModule?.customName}}</div>
                           </div>
                           <span class="morePadding">
                              <a translate="" ng-reflect-translate="" class="more hidden">Detailed view
                                 <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                           </span>
                        </a>
                     </div>
                     <div id="vendor-details-tile" class="{{tileClass}} mb_10" *ngIf="showMdfFormAnalyticsForParnterView"
                        style="border-radius: 5px;border: 1px solid lightgrey;">
                        <div class="row">
                           <div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-right">
                              <img class="img-circle" src="{{mdfRequestVendorDto?.companyLogoPath}}"
                                 alt="No Image Found" onerror="this.src='assets/images/default-company.png';">
                           </div>
                           <div class="col-xs-9 col-sm-9 col-md-10 col-lg-10 vendor_companyName" style="padding-left: 34px;">
                              <label data-toggle="tooltip" data-placement="top"
                                 title="{{mdfRequestVendorDto?.companyName}}" style="font-size: 15px;font-weight: 600;">
                                 {{mdfRequestVendorDto?.companyName | slice:0:20}}
                                 <span *ngIf="mdfRequestVendorDto?.companyName.length>20">..</span>
                              </label><br>
                              <label data-toggle="tooltip" data-placement="top"
                                 title="{{mdfRequestVendorDto?.companyProfileName}}"
                                 style="font-size: 15px;font-weight: 600;">
                                 {{mdfRequestVendorDto?.companyProfileName | slice:0:20}}
                                 <span *ngIf="mdfRequestVendorDto?.companyProfileName.length>20">..</span>
                              </label>
                           </div>
                        </div>
                     </div>
                     <div class="{{tileClass}} mb_10" id="pb-pr">
                        <a class="dashboard-stat dashboard-stat-lighter blue-soft min-h default-cursor">
                           <div class="visual">
                              <i aria-hidden="true" class=""></i>
                           </div>
                           <div class="details">
                              <div class="number NumberFontDecrease"><span data-toggle="tooltip" data-placement="top"
                                    title="{{mdfRequestTiles?.totalRequests}}">
                                    {{mdfRequestTiles?.totalRequestsInString}}
                                 </span>
                              </div>
                              <div class="desc">Number of Requests</div>
                           </div>
                           <span class="morePadding">
                              <a translate="" ng-reflect-translate="" class="more hidden">Detailed view
                                 <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                           </span>
                        </a>
                     </div>
                     <div id="pl" class="{{tileClass}} mb_12">
                        <a class="dashboard-stat dashboard-stat-lighter green-soft min-h default-cursor mdf_border">
                           <div class="visual">
                              <i aria-hidden="true" class=""></i>
                           </div>
                           <div class="details">
                              <div class="number NumberFontDecrease">
                                 <span data-toggle="tooltip" data-placement="top"
                                    title="{{mdfRequestTiles?.averageRequestSize}}">
                                    {{mdfRequestTiles?.averageRequestSizeInString}}
                                 </span>
                              </div>
                              <div class="desc">Average Request Size</div>
                           </div>
                           <span class="morePadding">
                              <a translate="" ng-reflect-translate="" class="more hidden">Detailed view
                                 <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                           </span>
                        </a>
                     </div>
                     <div id="pr" class="{{tileClass}}">
                        <a class="dashboard-stat dashboard-stat-lighter purple-soft min-h default-cursor">
                           <div class="visual">
                              <i aria-hidden="true" class=""></i>
                           </div>
                           <div class="details">
                              <div class="number NumberFontDecrease">
                                 <span data-toggle="tooltip" data-placement="top"
                                    title="$ {{mdfRequestTiles?.totalValue}}">
                                    {{mdfRequestTiles?.totalValueInString}}
                                 </span>
                              </div>
                              <div class="desc">Total Value</div>
                           </div>
                           <span class="morePadding">
                              <a translate="" ng-reflect-translate="" class="more hidden">Detailed view
                                 <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                           </span>
                        </a>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="row" *ngIf="isPartnerView && !showMdfFormAnalyticsForParnterView">
      <div class="portlet box">
         <div class="clearfix">
            <div class="col-xs-12">
               <app-response-message class="pg8" [customResponse]="customResponse" *ngIf="customResponse.isVisible">
               </app-response-message>
               <!-- BEGIN EXAMPLE TABLE PORTLET-->
               <div class="portlet light remove_cardBgcolor mdf_request_spacing light_bg_removal">
                  <div class="portlet-title" style="border-bottom: none;">
                     <div class="caption" style="padding-left: 2px !important;padding-top: 12px !important;" translate>
                        <i class="fa fa-list" style="font-size: 19px;" aria-hidden="true"></i>
                        Manage Vendors
                     </div>
                     <div class="inputs d_flex" style="float: right; padding: 4px">
                        <div style="float: left; margin: 0 10px;">
                           <select class="form-control" [(ngModel)]="sortOption.mdfVendorsSortOption"
                              (ngModelChange)="sortBy($event)" id="select-dropdown">
                              <option *ngFor="let option of sortOption.mdfVendorsSortDropDownOptions" [ngValue]="option"
                                 translate>
                                 {{option.name}}</option>
                           </select>
                        </div>
                        <div class="portlet-input input-inline ml-pt pt_0">
                           <div class="input-icon right">
                              <input type="text" id="sort-text" class="form-control" style="height: 34px;"
                                 [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}"
                                 placeholder="Search for a vendor" (keypress)="eventHandler($event.keyCode)">
                              <button class="glyphicon glyphicon-remove search-box-item-clear"
                                 *ngIf="sortOption.searchKey"
                                 (click)="sortOption.searchKey='';searchVendors();"></button>
                              <button type="submit" class="search-box-item-click" (click)="searchVendors()"><i
                                    class="fa fa-search" aria-hidden="true"></i></button>
                           </div>
                        </div>
                     </div>
                  </div>

                  <div class="portlet-body table-responsive" style="overflow: hidden;">
                     <div class="btn-group pull-right" style="margin-bottom: 10px; left: -16px;">
                        <div class="inputs" style="float: right"></div>
                     </div>
                     <app-list-loader *ngIf="listLoader.isLoading"></app-list-loader>
                     <div class="clearfix" *ngIf="!listLoader.isLoading">
                        <div class="col-xs-12" style="padding: 0px 0;">
                           <div class="table-responsive pos_pd-top4">
                              <table class='table tgrid' aria-describedby="manage-mdf-requests-table">
                                 <thead>
                                    <tr>
                                       <th scope="row" style="width: 50%;" translate>Vendor Info</th>
                                       <th scope="row" class="center-align" translate>Number Of Requests</th>
                                       <th scope="row" class="center-align" translate>Actions</th>
                                    </tr>
                                 </thead>
                                 <tbody>

                                    <ng-container *ngFor="let vendor of pagination.pagedItems;let i=index">
                                       <tr>
                                          <td>
                                             <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                                <div class="row">
                                                   <div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 text-right">
                                                      <img class="img-circle float-left"
                                                         src="{{vendor?.companyLogoPath}}" alt="No Image Found"
                                                         onerror="this.src='assets/images/default-company.png';">
                                                   </div>
                                                   <div class="col-xs-9 col-sm-9 col-md-10 col-lg-10 vendor_companyName"
                                                      style="padding-left: 34px">
                                                      <label class="xamplify-ellipsis" data-toggle="tooltip"
                                                         data-placement="top" title="{{vendor?.companyName}}"
                                                         style="overflow: initial;">
                                                         <b>Company Name:</b> {{vendor?.companyName}}
                                                      </label><br>
                                                      <label class="xamplify-ellipsis" data-toggle="tooltip"
                                                         data-placement="top" title="{{vendor?.companyProfileName}}"
                                                         style="overflow: initial;">
                                                         <b>Company Profile Name:</b> {{vendor?.companyProfileName}}
                                                      </label>
                                                   </div>
                                                </div>
                                             </div>
                                          </td>
                                          <td class="center-align">
                                             <span><strong>{{vendor?.requestsCount}}</strong> </span>
                                          </td>
                                          <td class="center-align">
                                             <div class="override-actions">
                                                <a class="custom-icon" (click)="goToAddRequest(vendor.companyId)"
                                                   data-toggle="tooltip" data-placement="bottom" title="Add Request">
                                                   <i class="fa fa-user-plus fa-fa-consistency IconCustomization"
                                                      aria-hidden="true"></i>
                                                   <div class="clickicons"></div>
                                                </a>
                                                <!----See Request Analytics-->
                                                <a class="ml5 custom-icon" (click)="viewRequests(vendor)"
                                                   data-toggle="tooltip" data-placement="bottom" title="View Requests">
                                                   <i class="fa fa-expand fa-fa-consistency IconCustomization"
                                                      aria-hidden="true"></i>
                                                   <div class="clickicons"></div>
                                                </a>
                                             </div>
                                          </td>
                                       </tr>
                                    </ng-container>
                                 </tbody>
                              </table>

                              <div *ngIf="pagination.totalRecords==0 && !listLoader.isLoading" class="alert alert-info">
                                 <strong>No Data Found.</strong>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div *ngIf="pagination.pagedItems.length !== 0">
                        <app-pagination [pagination]="pagination" (notifyParent)="setPage($event)"
                           (notifyParentDropDown)="listVendors($event)" [hidden]="listLoader.isLoading">
                        </app-pagination>
                     </div>
                  </div>
               </div>
               <!-- END EXAMPLE TABLE PORTLET-->
            </div>
         </div>
      </div>
   </div>
   <div *ngIf="showMdfFormAnalyticsForParnterView ||showMdfFormAnalyticsForVendorView ">
      <app-manage-mdf-request-form [vendorCompanyId]="vendorCompanyId" [partnershipId]="partnershipId"
         [partnerView]="isPartnerView"
         (mdfRequestFormEventEmitter)="getTeamMemberFilter($event)"></app-manage-mdf-request-form>
   </div>
</div>
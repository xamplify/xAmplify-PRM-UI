<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="page-content">
   <ng-container *ngIf="initLoader">
      <app-modal-popup-loader></app-modal-popup-loader>
   </ng-container>
   <ng-container *ngIf="!initLoader">
      <div class="page-bar">
         <div class="col-md-12 col-lg-12">
            <div class="row">
               <div class="col-md-6 col-lg-6 text-left">
                  <ul class="page-breadcrumb">
                     <li><i class="fa fa-home" aria-hidden="true"></i> <a [routerLink]="referenceService.homeRouter"
                           translate>Home</a>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                     </li>
                     <li>
                        <a (click)="goToSelectMdfPage()" translate>MDF</a>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                     </li>
                     <li>
                        <a (click)="goToManageMdfRequests()" translate>Manage MDF Requests</a>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                     </li>
                     <li><a translate>Create Request</a></li>
                  </ul>
               </div>
               <div class="col-md-6 col-lg-6 text-right" style="padding-right: 5px;">
                  <div class="btn-group refer-vendor-button"
                     style="padding-top: 7px;padding-bottom: 4px;padding-right: 3px;">
                     <a class="close-circle" (click)="goToManageMdfRequests()" title="Close">
                        <i class="fa fa-times" aria-hidden="true"></i>
                     </a>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div class="row">
         <div class="col-md-12 col-lg-12">
            <div class="portlet light mb_height" style=" height:198px;">
               <div class="portlet-title">
                  <div class="caption" style="padding: 7px 0px 10px 0 !important;" translate>
                     MDF Balances
                  </div>
               </div>
               <div class="row" style="margin-top: 20px;">
                  <app-box-loader [countLoader]=3 [mdfModule]="true" *ngIf="tilesLoader"></app-box-loader>
                  <div *ngIf="!tilesLoader" class="col-md-12 col-lg-12" style="padding-left: 24px;padding-right: 30px;">
                     <div class="row">
                        <div title="$ {{mdfAmountTiles?.totalBalance}}"
                           class="col-sm-4 col-xs-6 col-lg-4 col-md-4 tiles_hover_effect">
                           <a
                              class="dashboard-stat dashboard-stat-lighter green-soft min-h default-cursor tiles_bradius">
                              <div class="visual">
                                 <i aria-hidden="true" class=""></i>
                              </div>
                              <div class="details">
                                 <div class="number">{{mdfAmountTiles?.totalBalanceInString}}</div>
                                 <div class="desc">Total MDF Balance</div>
                              </div>
                              <span class="morePadding">
                                 <a translate="" ng-reflect-translate="" class="more hidden"> Detailed view
                                    <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                              </span>
                           </a>
                        </div>
                        <div title="$ {{mdfAmountTiles?.usedBalance}}"
                           class="col-sm-4 col-xs-6 col-lg-4 col-md-4 tiles_hover_effect">
                           <a
                              class="dashboard-stat dashboard-stat-lighter purple-soft min-h default-cursor tiles_bradius">
                              <div class="visual">
                                 <i aria-hidden="true" class=""></i>
                              </div>
                              <div class="details">
                                 <div class="number">{{mdfAmountTiles?.usedBalanceInString}}</div>
                                 <div class="desc">Total Used Balance</div>
                              </div>
                              <span class="morePadding">
                                 <a translate="" ng-reflect-translate="" class="more hidden">Detailed view
                                    <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                              </span>
                           </a>
                        </div>
                        <div title="$ {{mdfAmountTiles?.availableBalance}}"
                           class="col-sm-4 col-xs-6 col-lg-4 col-md-4 pt_8 tiles_hover_effect">
                           <a
                              class="dashboard-stat dashboard-stat-lighter yellow-gold min-h default-cursor tiles_bradius">
                              <div class="visual">
                                 <i aria-hidden="true" class=""></i>
                              </div>
                              <div class="details">
                                 <div class="number">{{mdfAmountTiles?.availableBalanceInString}}</div>
                                 <div class="desc">Total Available Balance</div>
                              </div>
                              <span class="morePadding">
                                 <a translate="" ng-reflect-translate="" class="more hidden">Detailed view
                                    <i aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                              </span>
                           </a>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div class="row">
         <div class="col-md-12 col-lg-12">
            <div class="portlet light">
               <div class="portlet-title">
                  <div class="caption" style="padding: 7px 0 10px 0 !important;" translate>
                     Request MDF
                  </div>
               </div>
               <app-response-message class="pg8" [customResponse]="customResponse" *ngIf="customResponse.isVisible">
               </app-response-message>
               <app-modal-popup-loader *ngIf="formLoader"></app-modal-popup-loader>
               <div *ngIf="!formLoader" class="row" style="margin-top: 20px;">
                  <form role="form" class="form-horizontal form-bordered form-label-stripped">
                     <div class="portlet box">
                        <div class="">
                           <ng-container *ngFor="let columnInfo of form.formLabelDTOs;let i = index">
                              <div class="col-md-12 col-lg-12 ">
                                 <div class="form-group">
                                    <label class="control-label col-sm-3"
                                       [style.color]="form.labelColor">{{columnInfo.labelName}}
                                       <span class="required" *ngIf="columnInfo.required">*</span>
                                    </label>
                                    <div class="col-sm-8">
                                       <ng-container
                                          *ngIf="columnInfo.labelType=='text' || columnInfo.labelType=='email'">
                                          <input type="{{columnInfo.labelType}}" class="form-control"
                                             placeholder="{{columnInfo.placeHolder}}" id="{{columnInfo.labelId}}"
                                             [(ngModel)]="columnInfo.value" maxlength="1000"
                                             [ngModelOptions]="{standalone: true}" (input)="validateEmail(columnInfo)">
                                          <span class="required" *ngIf="columnInfo.divClass=='error'">
                                             Please enter a valid email address
                                          </span>
                                          <span class="required"
                                             *ngIf="duplicateTitle && columnInfo.defaultColumn && columnInfo.labelType=='text'">
                                             Already exists
                                          </span>
                                       </ng-container>
                                       <!-- ---------------------------Text Area----------------------------- -->
                                       <ng-container *ngIf="columnInfo.labelType=='textarea'">
                                          <textarea [(ngModel)]="columnInfo.value" [ngModelOptions]="{standalone: true}"
                                             rows="4" cols="4" class="form-control"
                                             placeholder="{{columnInfo.placeHolder}}" maxlength="1000"></textarea>
                                       </ng-container>
                                       <!-- ---------------------------Date----------------------------- -->
                                       <ng-container *ngIf="columnInfo.labelType=='date'">
                                          <app-date-picker [(dataField)]="columnInfo.value" [isFromMdfCredit]='true'>>
                                          </app-date-picker>
                                       </ng-container>
                                       <!-- ---------------------------Price----------------------------- -->
                                       <ng-container *ngIf="columnInfo.labelType=='price'">
                                          <div class="input-group prefix">
                                             <span class="input-group-addon">{{columnInfo.priceSymbol}}</span>
                                             <input type="number" min="0" [(ngModel)]="columnInfo.value"
                                                [ngModelOptions]="{standalone: true}" rows="4" cols="4"
                                                class="form-control" placeholder="{{columnInfo.placeHolder}}">
                                          </div>
                                       </ng-container>
                                       <!----Number------->
                                       <ng-container *ngIf="columnInfo.labelType=='number'">
                                          <input type="name" class="form-control padding-mobile currency"
                                             [(ngModel)]="columnInfo.value" [ngModelOptions]="{standalone: true}"
                                             placeholder="{{columnInfo.placeHolder}}" min="0.00" currencyMask
                                             [options]="{align :'left',allowNegative :false }">
                                       </ng-container>
                                       <!-- ---------------------------Upload----------------------------- -->
                                       <ng-container *ngIf="columnInfo.labelType=='upload'">
                                          <input type="file" class="form-control"
                                             placeholder="{{columnInfo.placeHolder}}" id="file-{{i}}"
                                             (change)="onFileChangeEvent($event,columnInfo,i)">
                                       </ng-container>
                                       <!-- ---------------------------Radio Button----------------------------- -->
                                       <ng-container *ngIf="columnInfo.labelType=='radio'">
                                          <ng-container
                                             *ngFor="let radioButton of columnInfo.radioButtonChoices;let i=index">
                                             <div class="form-check">
                                                <label class="form-check-label" [style.color]="form.labelColor">
                                                   <input type="{{columnInfo.labelType}}" name="{{columnInfo.labelId}}"
                                                      class="form-check-input"
                                                      (click)="columnInfo.value = radioButton.id"
                                                      [checked]="radioButton.id === columnInfo.value || radioButton.id === columnInfo.selectedValue">
                                                   {{radioButton.name}}
                                                </label>
                                             </div>
                                             <br>
                                          </ng-container>
                                       </ng-container>
                                       <!-- ---------------------------Check Box----------------------------- -->
                                       <ng-container *ngIf="columnInfo.labelType=='checkbox'">
                                          <ng-container *ngFor="let checkBox of columnInfo.checkBoxChoices;let i=index">
                                             <div class="form-check">
                                                <label class="form-check-label" [style.color]="form.labelColor">
                                                   <input type="{{columnInfo.labelType}}" name="{{columnInfo.labelId}}"
                                                      [checked]="checkBox.isChecked" class="form-check-input"
                                                      (click)="updateCheckBoxModel(columnInfo,checkBox,$event)">
                                                   {{checkBox.name}}
                                                </label>
                                             </div>
                                             <br>
                                          </ng-container>
                                       </ng-container>
                                       <!----DropDown------->
                                       <ng-container *ngIf="columnInfo.labelType=='select'">
                                          <select class="form-control" [(ngModel)]="columnInfo.value"
                                             [ngModelOptions]="{standalone: true}">
                                             <option *ngFor="let dropDownValue of columnInfo.dropDownChoices"
                                                [ngValue]="dropDownValue.id">
                                                {{dropDownValue.name}}</option>
                                          </select>
                                       </ng-container>
                                    </div>
                                 </div>
                              </div>
                           </ng-container>
                        </div>
                     </div>
                     <div class="footer" id="right" *ngIf="formStatusCode==200">
                        <button [disabled]="!isValidEmailIds" class="button_blue bgcolor-unset" style="margin-right: 108px;"
                           type="button" (click)="submitRequest()" translate><span
                              class="btn btn-primary transition">Submit</span></button>
                     </div>
                  </form>
               </div>
            </div>
         </div>
      </div>
   </ng-container>
</div>
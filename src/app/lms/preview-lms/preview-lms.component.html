<div class="page-content" [ngClass]="{'form-background' : !showLearningTrack && !showAsset}">
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <i class="fa fa-home" aria-hidden="true"></i>
                <a [routerLink]="referenceService.homeRouter">Home</a>
                <i class="fa fa-angle-right" aria-hidden="true"></i>
                <a>View Track</a>
            </li>
        </ul>
    </div>
    <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible">
    </app-response-message>
    <ngx-loading [show]="httpRequestLoader.isLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
    <div [ngClass]="{'blur-content' : showFilePreview}">
        <ng-container *ngIf="learningTrack != undefined && !httpRequestLoader.isLoading">
            <section *ngIf="showLearningTrack">
                <div class="row">
                    <div class="col-md-9 col-lg-9" style="padding-right: 0px;">
                        <div class="page-bar" style="padding: 10px 10px;">
                            <div class="col-md-12 col-lg-12" style="border-bottom: 2px solid #cac8c8;padding: 10px 0px 0px 0px;margin-bottom: 10px;">
                                <div class="row">
                                    <div class="col-md-6 col-lg-6" style="padding: 3px 17px;">
                                        <a class="title padding_bottom" style="font-size: 15px; padding-top: 10px;">{{learningTrack.title}}</a>

                                    </div>
                                </div>
                            </div>
                            <div class="padding_bottom text-wrap">
                                <div [innerHTML]="learningTrack.description"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-lg-3">
                        <div class="page-bar" style="padding: 10px 10px;height: 230px;">
                            <img class="img-asset-class" [src]="learningTrack.featuredImage" alt="" onerror="this.src='assets/images/lms.jpg';" style="height: 140px !important;
                                                         width: 100% !important;">
                            <div class="center" style="padding-top: 10px;" title="{{learningTrack.createdByName}}" translate>
                                Created By <strong>{{learningTrack.createdByName}}</strong>
                            </div>
                            <div class="center" style="padding-top: 10px;" title="{{learningTrack.createdTime}}" translate>
                                Created On
                                <strong><app-timestamp [showInLine]="'true'" [dateAndTime]="learningTrack.createdTime">
                                </app-timestamp></strong>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section *ngIf="!showLearningTrack">
                <div [ngClass]="{'page-bar ' : showAsset}">
                    <div class="col-md-12 col-lg-12" style="padding:0px;">
                        <div style="padding: 10px 0px 0px 0px;
                                                    margin-bottom: 10px;">
                            <a (click)="closeView()" class="pull-right close-circle" style="padding-top: 3px;padding-left: 5px;">
                                <span class="glyphicon glyphicon-remove" style="z-index: 1;font-size: 13px;" aria-hidden="true"></span></a>
                            <div style="padding: 3px;">
                                <div class="title padding_bottom caption" style="font-size: 15px; padding-top: 10px;"><strong>{{learningTrack.title}}</strong></div>
                            </div>
                        </div>
                        <app-form-preview *ngIf="!showAsset" [learningTrackId]="learningTrack.id" (notifyParent)="closeView($event)">
                        </app-form-preview>
                        <div *ngIf="showAsset" class="padding">
                            <div style="padding-top: 10px;padding-left: 5px;">
                                <app-modal-popup-loader [hidden]="!assetViewLoader"></app-modal-popup-loader>
                                <div [hidden]="assetViewLoader">
                                    <div class="page-bar" style="margin-bottom: 10px!important;padding:0px 0px !important;">
                                        <div class="row">
                                            <div class="col-md-8 col-lg-8 cpdam">
                                                <div class="portlet light cphdam">
                                                    <div class="portlet-title port-heading">
                                                        <div class="caption" style="color:#000!important;">
                                                            <h4>
                                                                <strong>{{assetDetails?.assetName |
                                                                    slice:0:50}}</strong>
                                                                <span *ngIf="assetDetails?.assetName?.length>50">..</span>
                                                            </h4>
                                                        </div>
                                                    </div>
                                                    <div style="margin-left: 10px;">
                                                        {{assetDetails?.description}}
                                                        <br>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 col-lg-4" style="padding: 6px 15px 0px 17px;">
                                                <div>
                                                    <div class="grid-box" style="min-height: 200px;margin-top: 0px;">
                                                        <img class="img-class" src="{{assetDetails?.thumbnailPath}}" alt="No Image Found"><br>
                                                        <a class="btn btn-info" [ngClass]="{'isDisabled' : !assetDetails?.thumbnailPath}" (click)="downloadAsset(assetDetails)">Download</a>
                                                        <a class="btn btn-info" (click)="assetPreview(assetDetails)">View</a>
                                                        <div class="center" style="padding: 10px;margin: 0 !important;font-size: 14px;" title="{{assetDetails.assetType}}" translate>
                                                            Type: <strong>{{assetDetails.assetType}}</strong>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section *ngIf="showAsset || showLearningTrack">
                <div class="page-bar">
                    <div class="col-md-12 col-lg-12" style="border-bottom: 2px solid #cac8c8;
                            padding: 10px 0px 0px 0px;
                            margin-bottom: 10px;">
                        <div style="padding: 3px;">
                            <a class="title padding_bottom" style="font-size: 15px; padding-top: 10px;">Content</a>
                        </div>
                    </div>
                    <div class="row padding_bottom">
                        <div class="col-md-3 col-sm-4 col-xs-12" *ngFor="let content of learningTrack.contents ;let i =index" id="ContentListDiv_{{content.id}}">
                            <div [ngClass]="{'disable' : i != 0 && learningTrack.followAssetSequence && !learningTrack.contents[i-1].finished && !isCreatedUser}">
                                <div class="grid-box" (click)="viewContent(content)">
                                    <img class="image-fixed" [src]="content.thumbnailPath" onerror="this.src='learningTrack.featuredImage';" alt="{{content.title}}">
                                    <h4 class="ellipsis mt5 mb5 f-w-600" title="{{content.assetName}}" style="text-align: left !important;padding: 5px 0px 5px 10px !important;">
                                        {{content.assetName | slice:0:25}} <span *ngIf="content.assetName?.length>25">...</span><br>
                                    </h4>
                                    <h6 title="{{content.assetType}}" translate>
                                        Type: <strong>{{content.assetType}}</strong>
                                    </h6>
                                    <div *ngIf="!isCreatedUser" class="ribbon">
                                        <span style="background-color: #5cb85c;" *ngIf="content.finished" translate>Finished</span>
                                        <span style="background-color: #819081;" *ngIf="content.opened && !content.finished" translate>In
                                            Progress</span>
                                    </div>
                                    <div class="bar">
                                        <a [ngClass]="{'isDisabled' : i != 0 && learningTrack.followAssetSequence && !learningTrack.contents[i-1].finished && !isCreatedUser}" data-toggle="tooltip" data-placement="top" title="View" (click)="viewContent(content)">
                                            <i class="fa fa-eye" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-4 col-xs-12">
                            <div [ngClass]="{'disable' : !isCreatedUser && !learningTrack.enableQuiz}">
                                <div class="grid-box" *ngIf="learningTrack.quiz" (click)="viewQuiz()">
                                    <img class="image-fixed" [src]="learningTrack.featuredImage" alt="{{learningTrack.quiz.name}}">
                                    <h4 class="ellipsis mt5 mb5 f-w-600" title="{{learningTrack.quiz.name}}" style="text-align: left !important;padding: 5px 0px 5px 10px !important;">
                                        {{learningTrack.quiz.name | slice:0:25}} <span *ngIf="learningTrack.quiz.name?.length>25">...</span><br>
                                    </h4>
                                    <h6 title="Form" translate>
                                        Type: <strong>Form</strong>
                                    </h6>
                                    <div class="bar">
                                        <a *ngIf="!isCreatedUser" [ngClass]="{'isDisabled' : !learningTrack.enableQuiz}" data-toggle="tooltip" data-placement="top" title="View" (click)="viewQuiz()">
                                            <i class="fa fa-eye" aria-hidden="true"></i>
                                        </a>
                                        <a *ngIf="isCreatedUser" data-toggle="tooltip" data-placement="top" title="View" (click)="viewQuiz()">
                                            <i class="fa fa-eye" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </ng-container>
    </div>
</div>

<!-- Form Preview Modal Popup -->
<app-preview-popup #previewPopupComponent></app-preview-popup>

<!-- Preview Assets -->
<ng-container *ngIf="showFilePreview">
    <div class="overlay page-content">
        <button type="button" class="close-circle" data-dismiss="modal" (click)="closeAssetPreview()">
            <i class="fa fa-times" aria-hidden="true"></i>
        </button>
        <div class="overlay-content">
            <img *ngIf="isImage" [src]="filePath" alt="No Image Found"><br>
            <video *ngIf="isVideo" width="320" height="240" controls>
                <source [src]="filePath" [type]="fileType">
                Your browser does not support the video tag.
            </video>
            <audio *ngIf="isAudio" controls>
                <source [src]="filePath" [type]="fileType">
                Your browser does not support the audio tag.
            </audio>
            <div *ngIf="isFile && filePath?.length > 0">
                <iframe [src]="url" style="width:100%; height:75vh;" frameborder="0"></iframe>
            </div>
        </div>
    </div>
</ng-container>


<!-- Preview Bee Template Modal Popup-->
<div class="modal fade right" id="asset-preview-modal" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg modal-template fullwidth" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close-circle" data-dismiss="modal" aria-hidden="true">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
                <h4 class="modal-title" id="assetTitle"></h4>
            </div>
            <div class="modal-body">
                <app-modal-popup-loader *ngIf="modalPopupLoader"></app-modal-popup-loader>
                <div id="asset-preview-content">
                </div>
            </div>
            <div class="modal-footer">
                <a href="javascript:void(0)" data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
            </div>
        </div>
    </div>
</div>
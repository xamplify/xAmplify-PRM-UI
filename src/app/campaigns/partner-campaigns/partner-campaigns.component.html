<style type="text/css">
	.disabled {
		pointer-events: none;
		cursor: not-allowed !important;
	}
</style>
<div class="page-content">
<ngx-loading [show]="ngxloading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
	<div class="page-bar">
		<ul class="page-breadcrumb">
			<li>
				<i class="fa fa-home"></i>
				<a [routerLink]="referenceService.homeRouter">Home</a>
				<i class="fa fa-angle-right"></i>
      </li>
			<li *ngIf="role === 'Vendor'">
				<a [routerLink]="['/home/dashboard/vendors']">Campaigns From Vendor</a>
      </li>
      <li *ngIf="role === 'Vendor'">
        <a [routerLink]="['/home/dashboard/vendors']">Your Vendors</a>
        <i class="fa fa-angle-right"></i>
			</li>
			<li *ngIf="role === 'Vendor'">
				<a >Campaigns</a>
			</li>
			<li *ngIf="role === 'Partner'">
				<a >Campaigns shared by Vendors</a>
			</li>
		</ul>
	</div>
	<div style="position: relative; top:-10px;">
		<app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="tabbable tabbable-custom tabbable-noborder">
				<div class="tab-content">
					<div class="page-bar m10">
						<ul class="mix-filter col-xs-6 p0 m0">
					  	<li class="filter" (click)="filterCampaigns('all')" [class.active]="'all' == campaignType">All</li>
					  	<li class="filter" (click)="filterCampaigns('regular')" [class.active]="'regular' == campaignType">Email</li>
			              <li class="filter" (click)="filterCampaigns('video')" [class.active]="'video' == campaignType">Video</li>
			              <li class="filter" (click)="filterCampaigns('social')" [class.active]="'social' == campaignType">Social</li>
			              <li class="filter" *ngIf="referenceService.eventCampaignTabAccess" (click)="filterCampaigns('event')" [class.active]="'event' == campaignType">Event</li>
<!-- 			               <li class="filter" *ngIf="authenticationService.module.hasPartnerLandingPageAccess" (click)="filterCampaigns('landingPage')" [class.active]="'page' == campaignType">Page</li>
 -->			              <li class="filter" style="display: none;">Own Template</li>
						</ul>
						<div class="page-toolbar col-xs-6">
							<div class="btn-group pull-right">
								<ng-container class='m10'>
									<button class="btn btn-xs hidden-xs" [disabled]="isListView" (click)="isListView = true" title="List View">
										<i class="fa fa-th-list p10" aria-hidden="true"></i>
									</button>
									<button class="btn btn-xs hidden-xs" [disabled]="!isListView" (click)="isListView = false" title="Grid View">
										<i class="fa fa-th-large p10" aria-hidden="true"></i>
									</button>
								</ng-container>
								<div class="inputs" align="right" style="float: right">
									<div style="float: left;">
										<select class="form-control" [(ngModel)]="selectedSortedOption" (ngModelChange)="getSortedResult($event)" style="position: relative;right: -3px;">
											<option *ngFor="let sortOption of sortByDropDown" [ngValue]="sortOption">{{sortOption.name}}</option>
										</select>
									</div>
									<div class="portlet-input input-inline input-small">
										<div class="input-icon right" style="position: relative;right: -11px;">
                      <input type="text" [(ngModel)]="searchKey" [ngModelOptions]="{standalone: true}" class="form-control"
                      placeholder="Search..." (keypress)="eventHandler($event.keyCode)">
                      <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="searchKey" (click)="searchKey=''"></button>
                      <button type="submit" class="search-box-item-click" (click)="searchCampaigns()"><i class="fa fa-search"></i></button>
                    </div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<app-grid-loader *ngIf="httpRequestLoader.isLoading && !isListView"></app-grid-loader>
					<app-list-loader *ngIf="httpRequestLoader.isLoading && isListView"></app-list-loader>
					<section class='m10' *ngIf="totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError">
						<div class="table-responsive" style="border:none">
							<table class='table tgrid table-hover table-sm' *ngIf="isListView">
								<thead>
									<tr>
                    <th class="hidden-sm hidden-lg hidden-md" colspan="1">Campaign</th>
                    <th class="hidden-xs" colspan="2">Campaign</th>
										<th class="custom-center hidden-xs">Vendor Company Name</th>
										<th class="custom-center hidden-xs">Status</th>
										<th class="custom-center">Actions</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor='let campaign of pagination.pagedItems; let i=index'>
										<td style="width: 10%;" class="hidden-xs">
											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('VIDEO') > -1 && campaign.launched " src="assets/images/video-email.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('VIDEO') > -1 && !campaign.launched " src="assets/images/video-email.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
											 alt="{{campaign.campaignType}} Campaign">

											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('REGULAR') > -1 && campaign.launched" src="assets/images/regular-email.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img *ngIf="campaign.campaignType.indexOf('REGULAR') > -1 && !campaign.launched" src="assets/images/regular-email.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
											 alt="{{campaign.campaignType}} Campaign">

											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('SOCIAL') > -1 && campaign.launched" src="assets/images/social-campaign.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('SOCIAL') > -1 && !campaign.launched" src="assets/images/social-campaign.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
                      							 alt="{{campaign.campaignType}} Campaign">

                      						<img class="imageClass" *ngIf="campaign.campaignType.indexOf('EVENT') > -1 && campaign.launched" src="assets/images/event-campaign.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('EVENT') > -1 && !campaign.launched" src="assets/images/event-campaign.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
                      						 alt="{{campaign.campaignType}} Campaign">
                      						 
                      						 
                      						 <img class="imageClass" *ngIf="campaign.campaignType.indexOf('LANDINGPAGE') > -1 && campaign.launched" src="assets/images/landing-page.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img class="imageClass" *ngIf="campaign.campaignType.indexOf('LANDINGPAGE') > -1 && !campaign.launched" src="assets/images/landing-page.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
                      						 alt="{{campaign.campaignType}} Campaign">
                      						 
                     					 </td>
										<td>
											<h4 class="ellipsis mt5 mb5 f-w-600" style="font-size: 14px;" title="{{campaign.campaignName}}">{{campaign.campaignName | slice:0:25}}
													<span *ngIf="campaign.campaignName?.length>25">...</span>
											</h4>
											<h5 class="mobile-left" [title]="campaign.createdBy">By <b>{{campaign.createdBy | slice:0:15}}<span *ngIf="campaign.createdBy?.length>15">...</span></b></h5>
											<h5 class="mobile-left"  [title]="campaign.companyName">From <b>{{campaign.companyName | slice:0:15}}<span *ngIf="campaign.companyName?.length>15">...</span></b></h5>
										<h5 class="ellipsis view-banner" *ngIf="campaign.launched && !campaign.showCancelButton && campaign.campaignType.indexOf('EVENT') > -1" style="background-color: red;">Cancelled</h5>
										</td>
										<td class="custom-center hidden-xs">
											{{campaign.companyName | slice:0:15}}<span *ngIf="campaign.companyName?.length>15">...</span>
										</td>

										<td class="custom-center hidden-xs">
											<span align="right">
												<b>Received On</b>
											</span>
											<span align="right" title="Received On"><b>
                          						<app-timestamp [isOnlyDate]="false" [dateAndTime]="campaign.displayTime"> </app-timestamp>
                       						 </b>
											</span>
										</td>
										<td>
											<div class="actions-block override-actions" style="text-align: center !important;">
												<a *ngIf="campaign.campaignType !== 'SOCIAL'" (click)="showCampaignPreview(campaign)" data-toggle="tooltip" data-placement="top" title="Preview Campaign">
													<i class="fa fa-eye mr5"></i>
                       							 </a>
                       							 <a *ngIf="campaign.campaignType === 'SOCIAL'" data-toggle="tooltip" data-placement="top" title="coming soon">
													<i class="fa fa-eye mr5"></i>
                        							</a>
											<span>
											<ng-container *ngIf="campaign.allowRedistribution">
											<a *ngIf="campaign.campaignType != 'EVENT'" (click)="reDistributeCampaign(campaign)" data-toggle="tooltip" data-placement="top" title="Redistribute Campaign" data-rel="fancybox-button" >
					                            <i class="fa fa-clone"></i>
					                        </a>
					
					                        <a *ngIf="campaign.campaignType === 'EVENT' && campaign.showCancelButton" (click)="reDistributeCampaign(campaign)" data-toggle="tooltip" data-placement="top" title="Redistribute Campaign" data-rel="fancybox-button" >
					                            <i class="fa fa-clone"></i>
					                        </a>
					
					                        <a *ngIf="campaign.campaignType === 'EVENT' && !campaign.showCancelButton"  data-toggle="tooltip" data-placement="top" title="Not available for cancelled event" data-rel="fancybox-button" >
					                            <i class="fa fa-clone cancelled-event"></i>
					                        </a>
					                        </ng-container>
					                        <ng-container *ngIf="!campaign.allowRedistribution">
					                        	  <a  data-toggle="tooltip" data-placement="top" title="Not available for GDPR enabled campaigns.Please turn on GDPR to redistribute" data-rel="fancybox-button" >
					                            <i class="fa fa-clone cancelled-event"></i>
					                        </a>
					                        </ng-container>
                        
										  <ng-container class="pull-right" *ngIf="campaign.campaignType === 'REGULAR' || campaign.campaignType === 'VIDEO' || (campaign.campaignType === 'EVENT' && campaign.publicEventCampaign && campaign.showCancelButton) || campaign.campaignType === 'LANDINGPAGE'">
										         <div class="btn-group pull-right" id="download-template" *ngIf="campaign.allowDownload">
														<span class="glyphicon glyphicon-download-alt dropdown-toggle gearDropdownMenu" data-toggle="dropdown" id="download-drop"></span>
														<span  data-toggle="dropdown" title="Download"></span>
														<ul class="dropdown-menu pull-right">
																<li>
																  	<a href="{{authenticationService.REST_URL}}campaign/download/{{campaign.campaignId}}/{{loggedInUserId}}/html?access_token={{authenticationService.access_token}}"
				                        	 							data-toggle="tooltip" data-placement="top" title="Download Html" data-rel="fancybox-button" target="_blank">
				                        	 							<i class="fa fa-file" style="width: 30px;"></i>
																		 Download Html
																	</a>
															</li>
															<li *ngIf="campaign.campaignType != 'EVENT'">
															  	<a href="{{authenticationService.REST_URL}}campaign/download/{{campaign.campaignId}}/{{loggedInUserId}}/pdf?access_token={{authenticationService.access_token}}"  data-toggle="tooltip" data-placement="top" title="Download Pdf" data-rel="fancybox-button"  target="_blank">
																<i class="fa fa-file-pdf-o" style="width: 30px;"></i>
																Download Pdf
																</a>
															</li>
														</ul>
												</div>
											<a *ngIf="!campaign.allowDownload"  data-toggle="tooltip" data-placement="top" title="Please turn on GDPR settings to download" data-rel="fancybox-button" >
					                            <i class="fa fa-download cancelled-event"></i>
					                        </a>
					                   </ng-container>
                        		</span>
                        			<a class="hidden"><i class="fa fa-trash"></i></a>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</section>
					<div *ngIf="totalRecords <= 0 && isListView" class="alert alert-info">
						<strong>No campaigns found</strong>
					</div>
					<div class="tab-pane active" *ngIf="!isListView">
						<div class="margin-top-10">
							<div class="row mix-grid p10">
								<app-loader *ngIf="httpRequestLoader.isLoading"></app-loader>
								<app-error-pages *ngIf="httpRequestLoader.isServerError"></app-error-pages>
								<ng-container *ngIf="totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError">
									<div *ngFor="let campaign of pagination.pagedItems; let i= index" class="col-xs-12 col-sm-4 col-lg-3">
										<div class="grid-box">
											<img src="https://cdn2.iconfinder.com/data/icons/facebook-ads-1/204/1-48.png">
											<!-- <br> -->
											<h4 class="ellipsis" title="{{campaign.campaignName}}">{{campaign.campaignName | slice:0:25}}
												<span *ngIf="campaign.campaignName?.length>25">...</span>
											</h4>
											<!-- <span class="view-banner" *ngIf="campaign.launched && !campaign.showCancelButton && campaign.campaignType.indexOf('EVENT') > -1" style="background-color: red;">Cancelled</span> -->
                      <h6 [title]="campaign.createdBy">By <b>{{campaign.createdBy | slice:0:15}}<span *ngIf="campaign.createdBy?.length>15">...</span></b></h6>
											<h6 [title]="campaign.companyName">From <b>{{campaign.companyName | slice:0:15}}<span *ngIf="campaign.companyName?.length>15">...</span></b></h6>
											<h6>Received On <b>
                        <app-timestamp [isOnlyDate]="false" [dateAndTime]="campaign.displayTime"> </app-timestamp>
                      </b></h6>
											<div class="bookmark-ribbon">
												<span style="margin: 0px -7px; font-size: 17px; color: white;">
													<i *ngIf="campaign.campaignType.indexOf('VIDEO') > -1" class="fa fa-video-camera" aria-hidden="true"></i>
													<i *ngIf="campaign.campaignType.indexOf('REGULAR') > -1" class="fa fa-envelope" aria-hidden="true"></i>
                          							<i *ngIf="campaign.campaignType.indexOf('SOCIAL') > -1" class="fa fa-globe" aria-hidden="true"></i>
                          							<i *ngIf="campaign.campaignType.indexOf('EVENT') > -1" class="fa fa-calendar" aria-hidden="true"></i>
                          							<i *ngIf="campaign.campaignType.indexOf('LANDINGPAGE') > -1" class="fa fa-wpforms" aria-hidden="true"></i>
												</span>
											</div>
											<div class="ribbon">
												<div  class="cancel-ribbon" *ngIf="campaign.launched && !campaign.showCancelButton && campaign.campaignType.indexOf('EVENT') > -1">Cancelled</div>
											</div>
											<div class="bar">
											<a (click)="showCampaignPreview(campaign)" data-toggle="tooltip" data-placement="top" title="preview campaign">
													<i class="fa fa-eye mr4"></i>
                                                 </a>
                                                 
                                                <ng-container *ngIf="campaign.allowRedistribution">
													<a *ngIf="campaign.campaignType != 'EVENT'" (click)="reDistributeCampaign(campaign)" data-toggle="tooltip" data-placement="top" title="Redistribute Campaign" data-rel="fancybox-button">
														<i class="fa fa-clone"></i>
													</a>
													<a *ngIf="campaign.campaignType === 'EVENT' && campaign.showCancelButton" (click)="reDistributeCampaign(campaign)" data-toggle="tooltip" data-placement="top" title="Redistribute Campaign" data-rel="fancybox-button">
														<i class="fa fa-clone"></i>
													</a>
													<a *ngIf="campaign.campaignType === 'EVENT' && !campaign.showCancelButton" data-toggle="tooltip" data-placement="top" title="Not available for cancelled event" data-rel="fancybox-button">
														<i class="fa fa-clone" style="cursor:not-allowed"></i>
													</a>
												</ng-container>
												
												 <ng-container *ngIf="!campaign.allowRedistribution">
                        	  						<a  data-toggle="tooltip" data-placement="top" title="Not available for GDPR enabled campaigns.Please turn on GDPR to redistribute" data-rel="fancybox-button" >
                           								 <i class="fa fa-clone cancelled-event"></i>
                        							</a>
                        						</ng-container>
												
												<ng-container class="pull-right" *ngIf="campaign.campaignType === 'REGULAR' || campaign.campaignType === 'VIDEO' || (campaign.campaignType === 'EVENT' && campaign.publicEventCampaign && campaign.showCancelButton) || campaign.campaignType === 'LANDINGPAGE'">
										         <div class="btn-group" id="download-template-grid" *ngIf="campaign.allowDownload" >
														<span class="glyphicon glyphicon-download-alt dropdown-toggle gearDropdownMenu" data-toggle="dropdown" id="download-drop" style="color:white;"></span>
														<span  data-toggle="dropdown" title="Download"></span>
														<ul class="dropdown-menu pull-right">
																<li>
																  	<a  href="{{authenticationService.REST_URL}}campaign/download/{{campaign.campaignId}}/{{loggedInUserId}}/html?access_token={{authenticationService.access_token}}"  
				                        	 							data-toggle="tooltip" data-placement="top" data-rel="fancybox-button" target="_blank" >
				                        	 							<i class="fa fa-file" style="width: 30px;"></i>
																		 Download Html
																	</a>
															</li>
															<li *ngIf="campaign.campaignType != 'EVENT'">
															  	<a href="{{authenticationService.REST_URL}}campaign/download/{{campaign.campaignId}}/{{loggedInUserId}}/pdf?access_token={{authenticationService.access_token}}"  
																data-toggle="tooltip" data-placement="top" data-rel="fancybox-button" target="_blank">
																<i class="fa fa-file-pdf-o" style="width: 30px;"></i>
																Download Pdf
																</a>
															</li>
														</ul>
												</div>
												<a *ngIf="!campaign.allowDownload"  data-toggle="tooltip" data-placement="top" title="Please turn on GDPR settings to download" data-rel="fancybox-button" >
					                           		 <i class="fa fa-download cancelled-event"></i>
					                        	</a>
                        				</ng-container>
												
												<!-- <a (click)="referenceService.downloadTemplate(campaign.campaignId)" *ngIf="campaign.campaignType === 'REGULAR' || campaign.campaignType === 'VIDEO' || campaign.campaignType === 'EVENT'" 
                        								 data-toggle="tooltip" data-placement="top" title="Download Template" data-rel="fancybox-button" >
                            					<i class="fa fa-download"></i>
                        						</a> -->
											</div>
										</div>
									</div>
								</ng-container>
							</div>
						</div>
						<!-- End of 24 -->
						<div *ngIf="totalRecords <= 0 && !isListView &&  !httpRequestLoader.isLoading && !httpRequestLoader.isServerError" class="alert alert-info">
							<strong>No campaigns found</strong>
						</div>
					</div>
					<div [hidden]="totalRecords <= 0 || httpRequestLoader.isLoading || httpRequestLoader.isServerError" style="background:white">
						<div *ngIf="pagination.pagedItems.length !== 0">
							<app-pagination [pagination]="pagination" [type]="'campaign'"  (notifyParent)="setPage($event)"  (notifyParentDropDown)="getAllFilteredResults($event)"></app-pagination>
							<!-- <select class="form-control" style="float: right; width: auto;" [(ngModel)]="itemsSize" (ngModelChange)="getNumberOfItemsPerPage($event)">
								<option *ngFor="let itemPerPage of numberOfItemsPerPage" [ngValue]="itemPerPage">{{itemPerPage.name}}</option>
							</select> -->
						</div>
	         </div>
				  </div>
				<!-- End Of tab Content -->
			</div>
		</div>
  </div>
  <div class="modal right fade" id="email_template_preivew"  data-backdrop="static">
    <div class="modal-dialog modal-lg modal-template" style="right:0">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close-circle" data-dismiss="modal" aria-hidden="true">
            <i class="fa fa-times"></i>
          </button>
          <h4 class="modal-title">{{campaignName}}</h4>
        </div>
        <div class="modal-body">
		  <div id="email-template-content">
		  </div>
		    <app-modal-popup-loader *ngIf="loadingEmailTemplate"></app-modal-popup-loader>
		</div>
        <div class="modal-footer">
          <a href="javascript:void(0)" data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
        </div>
      </div>
    </div>
  </div>
	<!-- <div *ngIf="totalRecords <= 0"  class="alert alert-info"><strong>No Campaigns Found</strong></div> -->
  <app-scroll-top></app-scroll-top>
</div>
<app-preview-landing-page #previewLandingPageComponent></app-preview-landing-page>
<app-add-more-receivers #addMoreReceivers></app-add-more-receivers>




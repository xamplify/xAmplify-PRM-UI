<div class="page-content">
	<div *ngIf="isScheduledCampaignLaunched" id="scheduleCompleted" class="alert alert-info alert-dismissable fade in">
		<a (click)="refService.hideDiv('scheduleCompleted')" class="close" aria-label="close">x</a>
		<strong>Editing This Scheduled Campaign Is Not Allowed As Campaign Already Launched</strong>
	</div>
	<div class="page-bar">
		<ul class="page-breadcrumb">
			<li>
				<i class="fa fa-home"></i>
				<a [routerLink]="refService.homeRouter">Home</a>
				<i class="fa fa-angle-right"></i>
			</li>
			<li>
				<a>Manage Campaigns</a>
			</li>
		</ul>
	</div>
	<div style="position: relative; top:-10px;">
		<app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="tabbable tabbable-custom tabbable-noborder">
				<div class="tab-content">
					<div class="page-bar m10">
						<ul class="mix-filter col-xs-6 p0 m0">
							<li style="background: white; color: #616161;cursor: default;font-size: 14px;">Campaign Type:</li>
							<li class="filter" (click)="filterCampaigns('NONE',0)" [class.campaign-type-selected]="0 == selectedCampaignTypeIndex">All</li>
							<li class="filter" (click)="filterCampaigns('REGULAR',1)" [class.campaign-type-selected]="1 == selectedCampaignTypeIndex">Email</li>
							<li class="filter" (click)="filterCampaigns('VIDEO',2)" [class.campaign-type-selected]="2 == selectedCampaignTypeIndex">Video</li>
							<li class="filter" (click)="filterCampaigns('SOCIAL',3)" [class.campaign-type-selected]="3 == selectedCampaignTypeIndex">Social</li>
							<li class="filter" style="display: none;">Own Template</li>
						</ul>
						<div class="page-toolbar col-xs-6">
							<div class="btn-group pull-right">
								<ng-container class='m10'>
									<button class="btn btn-xs" [disabled]="isListView" (click)="isListView = true" title="List View">
										<i class="fa fa-th-list p10" aria-hidden="true"></i>
									</button>
									<button class="btn btn-xs" [disabled]="!isListView" (click)="isListView = false" title="Grid View">
										<i class="fa fa-th-large p10" aria-hidden="true"></i>
									</button>
								</ng-container>
								<!-- <div class="filter-div" (click)="filterByUserNameOrDate()" data-toggle="modal" data-target="#campaignFilterModal">
											<i class="fa fa-filter" aria-hidden="true"style="color: #c1c1c1;font-size: 20px;margin: 5px;"></i>
										</div> -->
								<div class="inputs" align="right" style="float: right">
									<div style="float: left;">
										<select class="form-control" [(ngModel)]="selectedSortedOption" (ngModelChange)="getSortedResult($event)" style="position: relative;right: -3px;">
											<option *ngFor="let sortOption of sortByDropDown" [ngValue]="sortOption">{{sortOption.name}}</option>
										</select>
									</div>
									<div class="portlet-input input-inline input-small">
										<div class="input-icon right" style="position: relative;right: -11px;">
											<i class="icon-magnifier" (click)="searchCampaigns()" style="cursor: pointer;"></i>
											<input type="text" class="form-control" [(ngModel)]="searchKey" [ngModelOptions]="{standalone: true}" placeholder="search...">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

						<app-grid-loader *ngIf="httpRequestLoader.isLoading && !isListView"></app-grid-loader>
						<app-list-loader *ngIf="httpRequestLoader.isLoading && isListView"></app-list-loader>
					<section class='m10' *ngIf="totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError">
						<div class="table-responsive">
							<table class='table tgrid table-hover table-sm' *ngIf="isListView">
								<thead>
									<tr>
										<th colspan="2" style="width: 50%">Campaign</th>
										<th>Status</th>
										<th>Created Date</th>
										<th>Actions</th>
									</tr>
								</thead>
								<tbody>
									<tr *ngFor='let campaign of pagination.pagedItems; let i=index'>
										<td style="width: 10%;">
											<img *ngIf="campaign.campaignType.indexOf('VIDEO') > -1 && campaign.launched " src="assets/images/video-email.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img *ngIf="campaign.campaignType.indexOf('VIDEO') > -1 && !campaign.launched " src="assets/images/video-email.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
											 alt="{{campaign.campaignType}} Campaign">

											<img *ngIf="campaign.campaignType.indexOf('REGULAR') > -1 && campaign.launched" src="assets/images/regular-email.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img *ngIf="campaign.campaignType.indexOf('REGULAR') > -1 && !campaign.launched" src="assets/images/regular-email.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
											 alt="{{campaign.campaignType}} Campaign">

											<img *ngIf="campaign.campaignType.indexOf('SOCIAL') > -1 && campaign.launched" src="assets/images/social-campaign.png" style="height: 50px;"
											 alt="{{campaign.campaignType}} Campaign">
											<img *ngIf="campaign.campaignType.indexOf('SOCIAL') > -1 && !campaign.launched" src="assets/images/social-campaign.png" style="height: 50px;-webkit-filter: grayscale(100%);filter: grayscale(100%);"
											 alt="{{campaign.campaignType}} Campaign">
										</td>
										<td>
											  <h4 class="ellipsis mt5 mb5 f-w-600" style="font-size: 14px;" title="{{campaign.campaignName}}">{{campaign.campaignName | slice:0:25}}
													<span *ngIf="campaign.campaignName?.length>25">...</span>
											</h4>
											<h5 class='m0'>{{campaign.companyName}}
												<span class='f-w-300'>{{campaign.createdBy}}</span>
											</h5>
										</td>
										<td>
											<span align="right">
												<b *ngIf="campaign.launched">Launched On</b>
												<b *ngIf="!campaign.launched && campaign.launchedOn?.length > 0">Scheduled For</b>
												<b *ngIf="!campaign.launched && campaign.launchedOn?.length==0">Saved On</b>
											</span>
											<span align="right" title="Upload Date">
												<!-- <b *ngIf="campaign.launched || !campaign.launched && campaign.launchedOn?.length > 0">{{campaign.launchedOn}}</b> -->
												<b *ngIf="campaign.scheduleType=='NOW' || campaign.scheduleType=='SCHEDULE'">{{campaign.launchedOn}}</b>
												<b *ngIf="campaign.scheduleType=='SAVE'">{{campaign.startTime}}</b>
											</span>
										</td>
										<td>{{campaign.createdDate}}</td>
										<td>
											<div class="actions-block">
												<ng-container *ngIf="!campaign.launched">
													<a *ngIf="hasAllAccess || (campaign.launched==false&&hasCampaignRole && loggedInUserId==campaign.userId) 
												|| (!campaign.launched&&isOnlyPartner)  || authenticationService.module.isVendor" (click)="editCampaign(campaign.campaignId)"
													 title="Edit Campaign" class='mr5'>
														<i class="fa fa-pencil-square-o"></i>
													</a>
												</ng-container>
												<ng-container *ngIf="campaign.launched">
													<a *ngIf="  hasAllAccess || (hasStatsRole || hasCampaignRole) || (loggedInUserId==campaign.userId) || authenticationService.module.isVendor"
													 data-rel="fancybox-button" [routerLink]="['/home/campaigns/',campaign.campaignId, 'details']" title="Campaign Based Reports"
													 class='mr5'>
														<i class="fa fa-line-chart"></i>
													</a>
													<a *ngIf=" (campaign.campaignType !== 'SOCIAL') && ( hasAllAccess || (hasStatsRole || hasCampaignRole) || isOnlyPartner || authenticationService.module.isVendor) && !campaign.nurtureCampaign"
													 data-rel="fancybox-button" title="Save As" class='mr5' (click)="openSaveAsModal(campaign.campaignId, campaign.campaignName)">
														<i class="fa fa-files-o"></i>
													</a>
												</ng-container>
												<a *ngIf=" hasAllAccess ||  (hasCampaignRole && loggedInUserId==campaign.userId) || isOnlyPartner || authenticationService.module.isVendor"
												 (click)="confirmDeleteCampaign(campaign.campaignId, i, campaign.campaignName)" title="Delete Campaign" data-rel="fancybox-button">
													<i class="fa fa-trash"></i>
												</a>
												<a (click)="showCampaignPreview(campaign.campaignId)" title="Preview">
													<i class="fa fa-eye mr5"></i>
												</a> 
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</section>
					<div *ngIf="totalRecords <= 0 && isListView" class="alert alert-info">
						<strong>No Campaigns Found</strong>
					</div>
					<div class="tab-pane active" *ngIf="!isListView">
						<div class="margin-top-10">
							<div class="row mix-grid p10">
								<app-error-pages *ngIf="httpRequestLoader.isServerError"></app-error-pages>
								<ng-container *ngIf="totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError">
									<div *ngFor="let campaign of pagination.pagedItems; let i= index" class="col-xs-12 col-sm-4 col-lg-3">
										<div class="grid-box">
											<img src="https://cdn2.iconfinder.com/data/icons/facebook-ads-1/204/1-48.png">
											<h4 class="ellipsis" title="{{campaign.campaignName}}">{{campaign.campaignName | slice:0:25}}
												<span *ngIf="campaign.campaignName?.length>25">...</span>
											</h4>
											<h6 class="mt10 mb0">By {{campaign.createdBy}}</h6>
											<h6 class="mt0"><b>{{campaign.companyName}}</b></h6>
											<h6>
											<span>
												<span *ngIf="campaign.launched">Launched On</span>
												<span *ngIf="!campaign.launched && campaign.launchedOn?.length > 0">Scheduled For</span>
												<span *ngIf="!campaign.launched && campaign.launchedOn?.length==0">Saved On</span>
											</span>
											<span title="Upload date">
												<span *ngIf="campaign.scheduleType=='NOW' || campaign.scheduleType=='SCHEDULE'">{{campaign.launchedOn}}</span>
												<span *ngIf="campaign.scheduleType=='SAVE'">{{campaign.startTime}}</span>
											</span>
											</h6>
											<div class="bookmark-ribbon">
												<span style="margin: 0px -7px; font-size: 17px; color: white;">
													<i *ngIf="campaign.campaignType.indexOf('VIDEO') > -1" class="fa fa-video-camera" aria-hidden="true"></i>
													<i *ngIf="campaign.campaignType.indexOf('REGULAR') > -1" class="fa fa-envelope" aria-hidden="true"></i>
													<i *ngIf="campaign.campaignType.indexOf('SOCIAL') > -1" class="fa fa-globe" aria-hidden="true"></i>
												</span>
											</div>
											<div class="ribbon" [class.active]="!campaign.launched && campaign.launchedOn?.length==0">
												<span *ngIf="campaign.launched">Launched</span>
												<span *ngIf="!campaign.launched && campaign.launchedOn?.length > 0">Scheduled</span>
												<span *ngIf="!campaign.launched && campaign.launchedOn?.length==0">Saved</span>
											</div>
											<div class="bar">
												<ng-container *ngIf="!campaign.launched">
													<a *ngIf="hasAllAccess || (campaign.launched==false && hasCampaignRole && loggedInUserId==campaign.userId) 
														|| (!campaign.launched&&isOnlyPartner) || authenticationService.module.isVendor" (click)="editCampaign(campaign.campaignId)" title="Edit Campaign">
														<i class="fa fa-pencil-square-o"></i>
													</a>
												</ng-container>
												<ng-container *ngIf="campaign.launched">
													<a *ngIf="  hasAllAccess || (hasStatsRole || hasCampaignRole ) || (loggedInUserId==campaign.userId) || authenticationService.module.isVendor"
														[routerLink]="['/home/campaigns/',campaign.campaignId, 'details']" title="Campaign Based Reports">
														<i class="fa fa-line-chart"></i>
													</a>
													<a *ngIf="(campaign.campaignType !== 'SOCIAL') && ( hasAllAccess || (hasStatsRole || hasCampaignRole || authenticationService.module.isVendor )) && !campaign.nurtureCampaign"
														data-rel="fancybox-button" (click)="openSaveAsModal(campaign.campaignId, campaign.campaignName)" title="Save As">
														<i class="fa fa-files-o"></i>
													</a>
													<a *ngIf=" isOnlyPartner" data-rel="fancybox-button" (click)="openSaveAsModal(campaign.campaignId, campaign.campaignName)" title="Save As">
														<i class="fa fa-files-o"></i>
													</a>
												</ng-container>
													<a *ngIf=" hasAllAccess ||  (hasCampaignRole && loggedInUserId==campaign.userId) || isOnlyPartner || authenticationService.module.isVendor"
														(click)="confirmDeleteCampaign(campaign.campaignId, i, campaign.campaignName)" title="Delete Campaign">
														<i class="fa fa-trash"></i>
													</a>
													<a (click)="showCampaignPreview(campaign.campaignId)" title="Preview">
														<i class="fa fa-eye mr5"></i>
												</a>
											</div>
										</div>
									</div>
								</ng-container>
							</div>
						</div>
						<!-- End of 24 -->
						<div *ngIf="totalRecords <= 0 && !isListView" class="alert alert-info">
							<strong>No Campaigns Found</strong>
						</div>
					</div>
					<div *ngIf="totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError" style="background:white">
						<div *ngIf="pagination.pagedItems.length !== 0">
							<app-pagination [pagination]="pagination" [type]="'campaign'" [isDropdown]="true" (notifyParent)="setPage($event)" (notifyParentDropDown)="listCampaign($event)"></app-pagination>
							<select class="form-control" style="float: right; width: auto;" [(ngModel)]="itemsSize" (ngModelChange)="getNumberOfItemsPerPage($event)">
								<option *ngFor="let itemPerPage of numberOfItemsPerPage" [ngValue]="itemPerPage">{{itemPerPage.name}}</option>
							</select>
						</div>
					</div>
				</div>
				<!-- End Of tab Content -->

			</div>
		</div>
	</div>
	<!-- <div *ngIf="totalRecords <= 0"  class="alert alert-info"><strong>No Campaigns Found</strong></div> -->
</div>


<!-- Save As Modal -->
<div class="modal fade" id="saveAsModal" tabindex="-1" role="dialog" aria-labelledby="saveAsModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title f-w-600" id="saveAsModalLabel">Save As</h4>
				<button type="button" class="close-circle" data-dismiss="modal" style=" position: relative;top: -24px;">
					<i class="fa fa-times"></i>
				</button>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label for="campaignName">Campaign Name</label>
					<input class="form-control" type="text" id="campaignName" [(ngModel)]="saveAsCampaignName">
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" (click)="saveAsCampaign()">Save changes</button>
			</div>
		</div>
	</div>
</div>


<div id="campaignFilterModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog" style="width: 53%;">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close-circle" data-dismiss="modal" aria-hidden="true">
					<i class="fa fa-times"></i>
				</button>
				<h4 class="modal-title">Filter</h4>
			</div>
			<div class="modal-body" style="padding: 28px;">
				<div class="row">
					<div class="col-sm-12">
						<input class="form-control" type="text">
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn green">Submit</button>
				<button type="button" class="btn green" data-dismiss="modal">Cancel</button>
			</div>
		</div>
	</div>
</div>
<ngx-loading [show]="ngxLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="page-content">
  <div class="page-bar mb-height_auto" style="height: 48px;">
    <ul class="page-breadcrumb">
      <li><i class="fa fa-home" aria-hidden="true"></i> <a [routerLink]="referenceService.homeRouter" translate>Home</a>
        <i class="fa fa-angle-right" aria-hidden="true"></i>
      </li>

    </ul>
  </div>
  <div class="row" style="padding-top: 10px;">
    <div class="portlet box">
      <div class="clearfix">
        <div class="col-xs-12">
          <div class="portlet light remove_cardBgcolor padding_0  light_bg_removal remove_space">
            <div class="portlet-title pt0" style="border-bottom: none;padding-top: 6px;">
              <div class="caption" translate style="padding-left: 3px !important;padding-top: 12px !important;">
                <i class="fa fa-list" style="font-size: 19px;" aria-hidden="true"></i>
                Campaigns
              </div>
              <div class="inputs w100 display" style="float: right;display: flex!important;">
                <ul class="mix-filter col-xs-12 col-sm-12 col-md-4 p0 m0 campaign-filter-option"
                  style="margin-right: -6px !important;">
                  <li class="filter padding p4 p3" (click)="filterCampaigns('NONE',0)"
                    [class.campaign-type-selected]="0 == selectedCampaignTypeIndex" translate>All</li>
                  <li class="filter p4 p3 " (click)="filterCampaigns('REGULAR',1)"
                    [class.campaign-type-selected]="1 == selectedCampaignTypeIndex" translate>Email</li>
                  <li class="filter p4 p3" (click)="filterCampaigns('VIDEO',2)"
                    [class.campaign-type-selected]="2 == selectedCampaignTypeIndex" translate>Video</li>
                </ul>
                <div class="mMargin" style="float: left; margin: 1px 10px!important;">
                  <select class="form-control" [(ngModel)]="sortOption.userLevelCampaignAnalyticsSortOption"
                    (ngModelChange)="sortBy($event)" style="padding-left: 5px;height: 34px;">
                    <option *ngFor="let option of sortOption.userLevelCampaignAnalyticsSortDropDownOptions"
                      [ngValue]="option" translate>
                      {{option.name}}</option>
                  </select>
                </div>
                <div class="portlet-input input-inline">
                  <div class="input-icon right p-top">
                    <input style="height: 35px !important;" type="text" id="sort-text" class="form-control"
                      [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}" placeholder="Search"
                      (keypress)="eventHandler($event.keyCode)">
                    <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="sortOption.searchKey"
                      (click)="sortOption.searchKey='';searchCampaigns();"></button>
                    <button type="submit" class="search-box-item-click align" style="height: 33px;"
                      (click)="searchCampaigns()"><i class="fa fa-search" aria-hidden="true"></i></button>
                  </div>
                </div>
              </div>
            </div>

            <div class="portlet-body table-responsive" style="overflow: hidden;padding-top: 0px !important;">
              <app-list-loader *ngIf="listLoader.isLoading"></app-list-loader>
              <div class="clearfix" *ngIf="!listLoader.isLoading">
                <div class="col-xs-12" style="padding: 0px 0;">
                  <div class="table-responsive">
                    <table class='table tgrid' aria-describedby="user-campaigns-list-table">
                      <thead>
                        <tr>
                          <th scope="row" translate>Campaign</th>
                          <th scope="row" translate>Launched On</th>
                          <th scope="row" translate>Latest View</th>
                          <th scope="row" translate>Email Opened</th>
                          <th scope="row" translate>Clicked URLs</th>
                          <!-- <th scope="row" translate>Auto Responses</th> -->
                          <th scope="row" translate>History</th>
                        </tr>
                      </thead>
                      <tbody>
                        <ng-container *ngFor="let campaignAnalytics of pagination.pagedItems;let i=index">
                          <tr>
                            <td>
                              <img *ngIf="campaignAnalytics?.campaignType=='REGULAR'"
                                class="imageClass active image-padding image_effect"
                                src="assets/images/regular-email.svg" alt="Regular Campaign Logo Not Found">
                              <img *ngIf="campaignAnalytics?.campaignType=='VIDEO'"
                                class="imageClass active image-padding image_effect" src="assets/images/video-email.svg"
                                alt="Video Campaign Logo Not Found">
                              <a class="campaign-name-padding" data-toggle="tooltip" data-placement="bottom"
                                title="{{campaignAnalytics?.campaignName}}"
                                (click)="goToCampaignAnalytics(campaignAnalytics?.campaignId,campaignAnalytics?.campaignTitle)">
                                {{campaignAnalytics?.campaignName | slice:0:15}}
                                <span *ngIf="campaignAnalytics?.campaignName?.length>15">...</span>
                              </a>
                            </td>
                            <td>
                              <app-timestamp [campaignView]="true"
                                [dateAndTime]="campaignAnalytics?.launchedDisplayTime"></app-timestamp>
                            </td>
                            <td>
                              <ng-container *ngIf="campaignAnalytics?.latestViewDisplayTime!='-'">
                                <app-timestamp [campaignView]="true"
                                  [dateAndTime]="campaignAnalytics?.latestViewDisplayTime">
                                </app-timestamp>
                              </ng-container>
                              <ng-container *ngIf="campaignAnalytics?.latestViewDisplayTime=='-'">
                                <span>-</span>
                              </ng-container>
                            </td>
                            <td class="center-align">
                              {{campaignAnalytics?.emailOpenedCount}}
                            </td>
                            <td class="center-align">
                              {{campaignAnalytics?.clickedUrlsCount}}
                            </td>
                            <td class="center-align">
                              <div (click)="viewTimeLine(campaignAnalytics)">
                                <a class="custom-icon" data-toggle="tooltip" data-placement="bottom"
                                  title="View History">
                                  <i class="circled-number fa fa-history action-btn IconCustomization pointer"
                                    aria-hidden="true"></i>
                                  <div class="clickicons"></div>
                                </a>
                              </div>
                            </td>
                          </tr>
                        </ng-container>
                      </tbody>
                    </table>
                    <div *ngIf="pagination.totalRecords==0 && !listLoader.isLoading" class="alert alert-info">
                      <strong>No Data Found.</strong>
                    </div>
                  </div>
                </div>
              </div>
              <div *ngIf="pagination.pagedItems.length !== 0" [hidden]="listLoader.isLoading">
                <app-pagination [pagination]="pagination" (notifyParent)="setPage($event)"
                  (notifyParentDropDown)="listCampaignAnalytics($event)" [hidden]="listLoader.isLoading">
                </app-pagination>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style> a.disabled {  pointer-events: none;cursor: not-allowed; opacity: .7;}
  .disabled {pointer-events: none;opacity: .7;} </style>
  <div class="page-content">
    <div class="page-bar">
      <ul class="page-breadcrumb">
        <li>
          <i class="fa fa-home"></i>
          <a [routerLink]="referenceService.homeRouter">Home</a>
          <i class="fa fa-angle-right"></i>
        </li>
        <li *ngIf="!eventRouterPage">
          <a [routerLink]="['/home/campaigns/select']">Select Campaign</a>
          <i class="fa fa-angle-right"></i>
        </li>
        <li *ngIf="eventRouterPage">
          <a  [routerLink]="['/home/campaigns/manage']">Manage Campaigns</a>
          <i class="fa fa-angle-right"></i>
        </li>
        <li>Event Based Campaign</li>
      </ul>
    </div>
    <app-list-loader [rowsCount]="6" *ngIf="loader"></app-list-loader>
    <div class="page-bar portlet light border-radius-0 shadow" [hidden]="loader">
      <div class="portlet-title" style="background: #ccc !important;border-radius: 0;">
        <h4 class="pull-left m10 f-w-600 title-css">Event Details</h4>
      </div>
      <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
      <div class="portlet-body clearfix">
        <section>
        <div class="col-xs-12 col-sm-7">
             <form class="form-horizontal">
            <div class="form-group">
              <label for="eventTitle" class="col-sm-3 labal-css">Event Title <span class=text-danger>*</span></label>
              <div class="col-sm-9">
              <input type="text" class="form-control" id="eventTitle" placeholder="Event Title" [(ngModel)]="eventCampaign.campaign" [ngModelOptions]="{standalone: true}"
              [ngClass]="{'has-error': eventError.eventTitleError}" (input)="validateCampaignName(eventCampaign.campaign)" (blur)="eventTitleError()" [attr.disabled]="isPreviewEvent? '' : null">
              <div class="text-danger" *ngIf="eventError.eventTitleError">Event Title is required</div>
              <div class="text-danger" *ngIf="!isValidCampaignName && eventCampaign.campaign?.length>0" style="color: red">Title already Exists</div>
            </div>
            </div>
            <div class="form-group">
              <label for="hostedBy" class="col-sm-3 labal-css">Hosted By <span class=text-danger>*</span></label>
              <div class="col-sm-9">
              <input type="text" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control pull-left" placeholder="Hosted By" [(ngModel)]="eventCampaign.fromName" [ngModelOptions]="{standalone: true}"
                [ngClass]="{'has-error': eventError.eventHostByError}" (input)="eventHostByError()"  (blur)="eventHostByError()">
                <div class="text-danger" *ngIf="eventError.eventHostByError">Hosted By is required</div>
               </div>
            </div>
            <div class="form-group">
                <label for="hostedBy" class="col-sm-3 labal-css">From Email</label>
                <div class="col-sm-9">
                <select [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control"  [(ngModel)]="eventCampaign.email" [ngModelOptions]="{standalone: true}" (change)="setFromName()">
                  <option *ngFor="let teamMember of teamMemberEmailIds" [ngValue]="teamMember.emailId">
                    {{teamMember.emailId}}
                  </option>
                </select>
                </div>
              </div>
            <div class="form-group" *ngIf="!authenticationService.isOnlyPartner()">
              <label for="Throughpartner" class="col-sm-3 labal-css">Through Partner</label>
              <div class="col-sm-2">
                <switch [status]="eventCampaign.channelCampaign" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.onTextValue"
                  [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.onGreenColorSwitch" [size]="callActionSwitch.size" [disabled]="isPreviewEvent || reDistributeEvent"
                  (statusChange)="eventCampaign.channelCampaign = !eventCampaign.channelCampaign">
                </switch>
              </div>
              <label for="toPartner" class="col-sm-3 labal-css">To Partner</label>
              <div class="col-sm-3" style="padding: 0;margin-top: 5px;">
              <span style="cursor: pointer;color: #54a7e9;" title="{{properties.TO_PARTNER_MESSAGE}}&#013;{{properties.THROUGH_PARTNER_MESSAGE}}">
                <i class="fa fa-question-circle" ></i>
            </span>
            </div>
            </div>
            <div class="form-group">
              <label for="eventDateTime" class="col-sm-3 labal-css">Event Date/Time <span class=text-danger>*</span></label>
              <div class="col-sm-9 p0">
                <div class="col-sm-6"><input [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" type="text" id="startDatePicker" class="form-control flatpickr" placeholder="Start"
                  [(ngModel)]="eventCampaign.campaignEventTimes[0].startTimeString" [ngModelOptions]="{standalone: true}" (input)="eventStartTimeError()" (blur)="eventStartTimeError()"
                  [ngClass]="{'has-error': eventError.eventStartTimeError && !eventCampaign.campaignEventTimes[0].startTimeString}">
                  <div class="col-sm-12 text-danger" style="padding:0" *ngIf="eventError.eventStartTimeError">{{datePassedError}}</div>
                </div>
                <div class="col-sm-6">
                  <input type="text" id="enDatePicker" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" [disabled]="eventCampaign.campaignEventTimes[0].allDay" class="form-control flatpickr" placeholder="End"
                  [(ngModel)]="eventCampaign.campaignEventTimes[0].endTimeString" [ngModelOptions]="{standalone: true}" (input)="eventEndTimeError()" (blur)="eventEndTimeError()"
                  [ngClass]="{'has-error': eventError.eventEndDateError,'opacityCss':eventCampaign.campaignEventTimes[0].allDay}">
                  <div class="col-sm-12 text-danger" style="padding:0" *ngIf="eventError.eventEndDateError">{{endDateErrorMesg}}</div>
                </div>
                <div class="col-sm-12 text-danger" *ngIf="(!eventError.eventStartTimeError && eventError.eventSameDateError) || endDatePassError">{{endDatePassedError}}</div>
                <div class="col-sm-12">
                  <input type="checkbox" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" [checked]="eventCampaign.campaignEventTimes[0].allDay" (change)="changeAllDay()"> All Day
                </div>
              </div>
            </div>
            <div class="form-group">
                <label for="Time Zone" class="col-sm-3 labal-css">Time Zone <span class=text-danger>*</span></label>
                  <div class="col-sm-9 p0">
                  <div class="col-sm-6">
                    <select [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" style="width: 100%;cursor: pointer;" 	[ngClass]="{'has-error': eventError.eventCountryAndTimeZone && !eventCampaign.campaignEventTimes[0].countryId}"
                    [(ngModel)]="eventCampaign.campaignEventTimes[0].countryId" [ngModelOptions]="{standalone: true}" (change)="onChangeCountryCampaignEventTime($event.target.value)" (input)="eventCountryError()" (blur)="eventCountryError()">
                      <option *ngFor="let country of countries" [value]="country.id">{{country.name}}</option>
                    </select>
                   </div>
                  <div class="col-sm-6">
                    <select [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" style="width: 100%" [(ngModel)]="eventCampaign.campaignEventTimes[0].timeZone" [ngModelOptions]="{standalone: true}" id="timezoneIdCampaignEventTime">
                      <option *ngIf="!timezonesCampaignEventTime" value="" disabled selected>Select TimeZone...</option>
                      <ng-container *ngIf="timezonesCampaignEventTime?.length==1">
                        <option *ngFor="let timeZone of timezonesCampaignEventTime" [value]="timeZone.timezoneId" [selected]="eventCampaign.campaignEventTimes[0].countryId == timeZone.countryId">
                          {{timeZone.cityName}}
                        </option>
                      </ng-container>
                      <ng-container *ngIf="timezonesCampaignEventTime?.length>1">
                        <option *ngFor="let timeZone of timezonesCampaignEventTime" [value]="timeZone.timezoneId">
                          {{timeZone.cityName}}
                        </option>
                      </ng-container>
                    </select>
                  </div>
                  <div class="text-danger" style="margin-left: 15px;" *ngIf="eventError.eventCountryAndTimeZone && !eventCampaign.campaignEventTimes[0].countryId">Please select the country and timezone</div>
                </div>
              </div>
            <div class="form-group">
              <label for="hostedBy" class="col-sm-3 labal-css">Online Meeting</label>
              <div class="col-sm-9">
                <switch [disabled]="(isPreviewEvent || reDistributeEvent)" [status]="eventCampaign.onlineMeeting" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.offTextValue"
                  [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.offDefaultColor" [size]="callActionSwitch.size"
                  (statusChange)="eventCampaign.onlineMeeting = !eventCampaign.onlineMeeting">
                </switch>
              </div>
            </div>
            <section *ngIf="!eventCampaign.onlineMeeting">
              <div class="form-group">
                <label for="hostedBy" class="col-sm-3 labal-css">Location Name <span class="text-danger" style="position: absolute;">*</span></label>
                <div class="col-sm-9"><input type="text" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" id="eventDateTime" (blur)="eventLocationError()" (input)="eventLocationError()"
                   placeholder="My house, bar, etc" [ngClass]="{'has-error': eventError.eventLocationError}" [(ngModel)]="eventCampaign.campaignLocation.location" [ngModelOptions]="{standalone: true}">
                   <div class="text-danger" *ngIf="eventError.eventLocationError">Location is required</div>
                  </div>
              </div>
              <div class="form-group">
                <label for="hostedBy" class="col-sm-3 labal-css">Address</label>
                <div class="col-sm-9"><input type="text" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" id="eventDateTime" placeholder="Street Address" [(ngModel)]="eventCampaign.campaignLocation.street" [ngModelOptions]="{standalone: true}"></div>
                <div class="col-sm-offset-3 col-sm-9 pt10">
                  <div class="col-sm-4 p0"><input type="text" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" id="city" placeholder="City" [(ngModel)]="eventCampaign.campaignLocation.city" [ngModelOptions]="{standalone: true}"></div>
                  <div class="col-sm-4 p0"><input type="text" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" id="state" placeholder="State" [(ngModel)]="eventCampaign.campaignLocation.state" [ngModelOptions]="{standalone: true}"></div>
                  <div class="col-sm-4 p0"><input type="text" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="form-control" id="zip" placeholder="Zip" [(ngModel)]="eventCampaign.campaignLocation.zip" [ngModelOptions]="{standalone: true}"></div>
                </div>
              </div>
            </section>
          </form>
        </div>
        <div class="col-xs-12 col-sm-5">
          <div class="boxes portlet light">
            <div class="portlet-title">
              <h4 class="pull-left f-w-600">Event Settings</h4>
            </div>
            <div class="portlet-body clearfix" [attr.disabled]="(isPreviewEvent || reDistributeEvent)">
              <ul>
              <li><label>
                <switch [status]="eventCampaign.rsvpReceived" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.offTextValue" [disabled]="isPreviewEvent || reDistributeEvent"
                [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.onDefaultColorSwitch" [size]="callActionSwitch.bsize"
                (statusChange)="eventCampaign.rsvpReceived = !eventCampaign.rsvpReceived">
              </switch>
                Notify me when guests RSVP
                </label></li>
              <li><label>
                 <switch [status]="eventCampaign.emailOpened" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.offTextValue" [disabled]="isPreviewEvent || reDistributeEvent"
                 [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.onDefaultColorSwitch" [size]="callActionSwitch.bsize"
                 (statusChange)="eventCampaign.emailOpened = !eventCampaign.emailOpened">
               </switch>
                 Notify me when email is opened </label></li>
              <li><label>
                <switch [status]="eventCampaign.inviteOthers" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.offTextValue" [disabled]="(isPreviewEvent || reDistributeEvent) || reDistributeEvent"
                [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.onDefaultColorSwitch" [size]="callActionSwitch.bsize"
                (statusChange)="eventCampaign.inviteOthers = !eventCampaign.inviteOthers">
              </switch>
                Invite others </label></li>
              </ul>
            </div>
           </div>
          <div class="boxes portlet light">
            <div class="portlet-title">
              <h4 class="pull-left f-w-600">Listing Privacy</h4>
            </div>
            <div class="portlet-body clearfix">
                <ul>
                  <li style="border-bottom:1px solid #CCC; margin-bottom:10px;">
                     <label class="col-md-1 p0" style="margin-top: 17px;cursor:pointer">
                       <input style="cursor: pointer;" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" type="radio" value="eventCampaign.publicEventCampaign" [checked]="eventCampaign.publicEventCampaign" (change)="eventCampaign.publicEventCampaign = !eventCampaign.publicEventCampaign">
                     </label>
                    <label class="col-md-2 p0"><img src="assets/images/public-event.png"></label>
                    <div class="col-md-9 p0" ><b>Public page</b><br><p >Turn invitees into your biggest promoters by letting them share your event on Facebook, Twitter, LinkedIn and or other media platform</p></div>
                  <div style="clear:both"></div>
                  </li>

                  <li>
                      <label  class="col-md-1 p0" style="margin-top: 17px;cursor: pointer;">
                        <input style="cursor: pointer;" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" type="radio" value="!eventCampaign.publicEventCampaign" [checked]="!eventCampaign.publicEventCampaign" (change)="eventCampaign.publicEventCampaign = !eventCampaign.publicEventCampaign">
                      </label>
                      <label class="col-md-2 p0 "><img src="assets/images/private-event.png"></label>
                      <div class="col-md-9 p0"><b>Private page</b><br><p >Make your event invitation-only (guests must receive an xAmplify invitation to attend/view)</p></div>
                  </li>
             </ul>
            </div>
          </div>
        </div>
        <div class="col-xs-12 p0 mb10">
            <div class="form-group"  (click)="imageClick()">
                <label for="Event Image" class="col-sm-2 labal-css">Event Image</label>
                <div class="col-sm-10" (drop)="fileChange($event)">
                  <div class="upload-media-wrapper" *ngIf="! eventCampaign.campaignEventMedias[0].filePath" >
                    <i class="fa fa-camera" aria-hidden="true"></i>
                    <b>Add Event Image</b><br>
                    <span>Choose a compelling image that brings your event to life</span>
                    <input type="file" [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" (change)="fileChange($event)" #input name="media[]" accept="image/gif,image/jpeg,image/jpg,image/png"
                     class="file-input js-tooltip" data-original-title="Add photo" id="eventImage">
                  </div>
                  <div [attr.disabled]="(isPreviewEvent || reDistributeEvent)? '' : null" class="uploaded-media-wrapper" *ngIf="eventCampaign.campaignEventMedias[0].filePath">
                    <span class="uploaded-span">
                    <img src="{{eventCampaign.campaignEventMedias[0].filePath}}" [attr.disabled]="isPreviewEvent? '' : null">
                    <i *ngIf="!(isPreviewEvent || reDistributeEvent)" class="fa fa-times-circle time-circle" (click)="$event.stopPropagation();resetcampaignEventMedia()"></i>
                   </span>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label for="hostedBy" class="col-sm-2 labal-css" style="margin-top:10px;">Event Description <span class=text-danger>*</span></label>
                <div class="col-sm-10" [ngClass]="{'disabled':(isPreviewEvent || reDistributeEvent)}" style="margin-top:10px;">
                  <ckeditor [class.disabled]="(isPreviewEvent || reDistributeEvent)" [(ngModel)]="eventCampaign.message"  (blur)="eventDescriptionError()" (input)="eventDescriptionError()" [ngModelOptions]="{standalone: true}" #myckeditor [config]="ckeConfig" debounce="500"></ckeditor>
                  <div  class="text-danger" *ngIf="eventError.eventDescription"> Event message is required</div>
                </div>
              </div>
          </div>
        </section>
        <div class="col-xs-12 mb10">
            <div class="boxes portlet light">
                <div class="portlet-title">
                  <h4 class="pull-left f-w-600">Select<span *ngIf="isPreviewEvent">ed</span> Invite Recipients<span style="color:red">*</span></h4>
                   <section >
                      <div class="form-group m0 pull-right" [hidden]="true">
                        <h5 class="labal-css pr10 pull-left" style="font-size: 14px;">Partner Lists</h5>
                        <switch [status]="isPartnerUserList" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.offTextValue" [disabled]="isPreviewEvent"
                          [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.onDefaultColorSwitch" [size]="callActionSwitch.bsize"
                          (statusChange)="toggleContactLists()">
                        </switch>
                      </div>
                    </section>
                </div>
                <div class="portlet-body clearfix">
                <div class="alert-danger alert-error" *ngIf="eventError.eventContactError">* Please select the <span *ngIf="!authenticationService.isOnlyPartner();else listHeader">contact</span><ng-template #listHeader>partner</ng-template> list</div>
                <section *ngIf="(isPreviewEvent && (userListIds?.length==0 && parternUserListIds?.length==0)) || contactListsPagination.pagedItems?.length === 0;else contactList">
                  <div class='alert alert-info' role='alert'>
                    <h4 class='m0'>You have not added any <span *ngIf="authenticationService.isOnlyPartner();else listPartner">contact</span><ng-template #listPartner>partner</ng-template> lists yet.</h4>
                  </div>
                  <!-- <a class='btn btn-info' style="color: #fff;" [routerLink]="['/home/contacts/add']">Add Contacts</a> -->
                </section>
                <ng-template #contactList>
                  <div class="table-responsive">
                    <table class="table tgrid" id='contact-list-table' 	[ngClass]="{'has-error': eventError.eventContactError}">
                      <thead>
                        <tr>
                          <th class="custom-center">Select</th>
                          <th class="custom-center">List Name</th>
                          <th class="custom-center">No.of Recipients</th>
                          <th class="custom-center">Preview</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let contactList of contactListsPagination.pagedItems; let i=index;">
                          <td class='text-center m0'>
                            <input *ngIf="!isPartnerUserList " [attr.disabled]="isPreviewEvent? '' : null" type='checkbox' id='{{contactList.id}}' [checked]="userListIds.indexOf(contactList.id)>-1" (click)="highlightRow(contactList.id)">
                            <input *ngIf="isPartnerUserList" [attr.disabled]="isPreviewEvent? '' : null" type='checkbox' id='{{contactList.id}}' [checked]="parternUserListIds.indexOf(contactList.id)>-1" (click)="partnerHighlightRow(contactList.id)">
                          </td>
                          <td>
                            <h5 class='m0 f-w-600 table-color' title="{{contactList.name}}">
                              <span *ngIf="contactList.name?.length<=50">{{contactList.name}}</span>
                              <span *ngIf="contactList.name?.length>50">{{contactList.name | slice:0:50}}...</span>
                            </h5>
                            <h6 class="pull-left mb0 mt5 table-color" title="{{contactList.uploadedBy}}">
                              <span *ngIf="contactList.uploadedBy?.length<=30">By: {{contactList.uploadedBy}}</span>
                              <span *ngIf="contactList.uploadedBy?.length>30">By: {{contactList.uploadedBy | slice:0:30}}...</span>
                              Created On:<span>{{contactList.createdDate}}</span>
                            </h6>
                          </td>
                          <td> <h6 class='m0 text-center f-w-600 table-color'>{{contactList.noOfContacts}}</h6> </td>
                          <td class='text-center m0'>
                            <a>	<i class="fa fa-eye" aria-hidden="true" (click)="loadContactsOnPreview(contactList, contactsPagination);"></i></a>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <app-pagination style="position: relative;left: -9px;" [pagination]="contactListsPagination" [type]="'contactlists'" (notifyParent)="setPage($event)"
                   (notifyParentDropDown)="paginationDropDown($event)"></app-pagination>
                </ng-template>
                </div>
              </div>
          </div>
          <div class="col-xs-12 mb10">
              <div class="boxes portlet light">
                  <div class="portlet-title">
                    <h4 class="pull-left f-w-600">Select<span *ngIf="isPreviewEvent">ed</span> an Email Template</h4>
                  </div>
                  <div class="portlet-body clearfix">
                        <section  style="min-height: 200px;">
                         <!--  <div class="col-xs-6 col-sm-3" *ngFor="let emailTemplate of emailTemplates ;let i =index" >
                          <div class="grid-box p0">
                            <div class="video-thumbnail-wrapper" [class.template-selected]="eventCampaign.emailTemplate.id === emailTemplate.id">
                                <img class="img-responsive center-block" src="assets/images/email-template.png" alt="{{emailTemplate.name}}" id="emailtemplate-image" style="width: 100%;height:200px !important;" >
                            </div>
                               <span class="ellipsis event-title" title="{{emailTemplate.name}}">{{emailTemplate.name}}</span>
                            <div class="bar-event">
                              <div>
                                  <a class="icons-link" title="Select" data-rel="" *ngIf="eventCampaign.emailTemplate.id !== emailTemplate.id && !isPreviewEvent" (click)="eventCampaign.emailTemplate = emailTemplate;">
                                    <i class="fa fa-check-circle" id="fa-font-size"></i> Select
                                  </a>
                                  <a class="icons-link" title="Select" data-rel="" *ngIf="eventCampaign.emailTemplate.id === emailTemplate.id">
                                    <i class="fa fa-ban" id="fa-font-size"></i> Selected
                                  </a>
                                  <a class="icons-link" title="Preview" data-rel="" (click)="previewEventCampaignEmailTemplate(emailTemplate.id)">
                                    <i class="fa fa-eye" id="fa-font-size"></i> Preview
                                  </a>
                              </div>
                            </div>
                          </div>
                        </div> -->
                        
                        
                        <ul class="content__list"
										*ngFor="let emailTemplate of emailTemplates ;let i =index">
										<li class="list__item" [class.list__item--selected]="eventCampaign.emailTemplate.id === emailTemplate.id"
											>
											<!-- above class [ngClass]="{'list__item--selected':selectedFileIds.indexOf(file.id)>-1}" -->
											<div class="flex-row">
												<div class="item__select-box-wrapper">
													<span class="select-box"> <label> <input
															(click)="eventCampaign.emailTemplate = emailTemplate;" class=""
															type="checkbox">
													</label>
													</span>
													<!-- [checked]="selectedFileIds.indexOf(file.id)>-1" -->
													 <span class="ng-scope"> <a
														class="item__preview item__preview--image img-container custom"
														target="_BLANK"> <img
															ng-src="https://d15k2d11r6t6rl.cloudfront.net/public/_thumbs/Integrators/6639d69f-523f-44ca-b809-a00daa26b367/bee-12092/BC-xAmplify-changes1.jpg_thumb.png?hash=1537857431976"
															onerror="this.src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI5cHgiIGhlaWdodD0iMjhweCIgdmlld0JveD0iMCAwIDI5IDI4IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnNrZXRjaD0iaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggMy4zLjIgKDEyMDQzKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pbWFnZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJpY29ucyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc2tldGNoOnR5cGU9Ik1TUGFnZSI+CiAgICAgICAgPGcgaWQ9IkFydGJvYXJkLTEiIHNrZXRjaDp0eXBlPSJNU0FydGJvYXJkR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MDEuMDAwMDAwLCAtNDguMDAwMDAwKSIgc3Ryb2tlPSIjNTA1NjU5Ij4KICAgICAgICAgICAgPGcgaWQ9ImltYWdlIiBza2V0Y2g6dHlwZT0iTVNMYXllckdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MDMuMDAwMDAwLCA0OS4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjAzMjQ0OTE2MDgsNy44NjY4Mzk4OCBMMTguNTQ0NzU4MiwzLjc0NTU3NTk4IEwyMi44MTg2NjE1LDIxLjU5NjczMTEgTDQuMzA2MzUyNDYsMjUuNzE3OTk1IEwwLjAzMjQ0OTE2MDgsNy44NjY4Mzk4OCBMMC4wMzI0NDkxNjA4LDcuODY2ODM5ODggWiIgaWQ9IlJlY3RhbmdsZS02OSIgc3Ryb2tlLXdpZHRoPSIyIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8ZyBpZD0iaW1hZ2UtbW9kdWxlLWNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzc3Nzc4LCAwLjAwMDAwMCkiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPgogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJzdmdzIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGcgaWQ9IlJlY3RhbmdsZS02OS0rLVBhdGgtOTEtKy1PdmFsLTEiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS02OSIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSIjRkZGRkZGIiB4PSIwIiB5PSIwIiB3aWR0aD0iMTkuOTYyOTYzIiBoZWlnaHQ9IjE5LjI1Ij48L3JlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMC43OTkxNDUyOTksMTUuNDEyMDg3OSBMNy4xOTIzMDc2OSwxMC43ODg0NjE1IEwxMS4xODgwMzQyLDEzLjEwMDI3NDcgTDIwLjc3Nzc3NzgsNi4xNjQ4MzUxNiIgaWQ9IlBhdGgtOTEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxlbGxpcHNlIGlkPSJPdmFsLTEiIGN4PSI3LjU5MTg4MDM0IiBjeT0iNS43Nzk1MzI5NyIgcng9IjIuNzk3MDA4NTUiIHJ5PSIyLjY5NzExNTM4Ij48L2VsbGlwc2U+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=='"
															class="thumb ng-scope" src="assets/images/email-template.png">
													</a> <a href="javascript:;"> </a>
													</span>
												</div>
												<div class="item__content">
													<div class="flex-row">
														<span class="item__name" data-toggle="tooltip"
															[title]="emailTemplate.name">{{emailTemplate.name}}
														</span>
														<div class="item__actions">
															<span> <a class="fm external-link" target="_BLANK"
																data-toggle="tooltip" data-placement="top"
																title="Preview"
																(click)="previewEventCampaignEmailTemplate(emailTemplate.id)"> <!-- (click)="preview(file)"  -->
																	<i class="fa fa-external-link-square"
																	aria-hidden="true"
																	style="font-size: 20px; color: #5a5a5a"></i>
															</a>
															</span>
														</div>
													</div>
												</div>
												<div class="clearfix"></div>
											</div>
										</li>
									</ul>
                        
                    </section>
                  </div>
                </div>
          </div>
        <div class="col-xs-12 mb10">
          <fieldset class="col-xs-12">
            <legend style="color: #2c3f52;">Add Your Work Flow</legend>
            <div style="margin-bottom:70px;">
            <div class="col-xs-6" style="margin-left: 45.666667%;">
              <img *ngIf="!isPreviewEvent" src="assets/images/icon1.png" (click)="addReplyRows()">
              <img *ngIf="isPreviewEvent" src="assets/images/icon1.png">
            </div><br>
            <div class="col-xs-12 auto-response" *ngIf="!isPreviewEvent" style="text-align: center"><a (click)="addReplyRows()">Click Here</a> to add an auto reauto response to your email</div>
            <div class="col-xs-12 auto-response" *ngIf="isPreviewEvent" style="text-align: center"><a style="cursor: default;" [attr.disabled]="isPreviewEvent? '' : null">Click Here</a> to add a auto response to your email</div>
            </div>
            <div *ngFor="let reply of eventCampaign.campaignReplies;let i=index">
            <div class="portlet light dashboard-stat2" id="{{reply.divId}}" style="min-height: 320px;" [class.disabled]="reply.body && reDistributeEvent && reply.id">
              <div class="portlet-title custom-change-css" [ngClass]="{'colorlightBlock':isEven(i+1), 'colorBlue':!isEven(i+1)}">
                <div class="col-xs-7" style="font-size: 15px;">
                    <h4 class="text-left auto-res">Add an Auto-response to your e-mail-{{i+1}}</h4>
                </div>
                <div class="col-xs-5 pull-right"  style="text-align:right">
                  <label class="switch-choose" style="color:#fff">Choose Template</label>
                  <switch class="switch-choose" [disabled]="isPreviewEvent" [status]="reply.defaultTemplate" [onText]="callActionSwitch.onTextValue" [offText]="callActionSwitch.offTextValue"
                    [onColor]="callActionSwitch.onGreenColorSwitch" [offColor]="callActionSwitch.onDefaultColorSwitch" [size]="callActionSwitch.size"
                    (statusChange)="selectReplyEmailBody($event,i,reply)">
                  </switch>
                  <button [disabled]="isPreviewEvent" type="button" class="btn btn-danger button-blue" (click)="remove(reply.divId,'replies')"><span class="glyphicon glyphicon-trash"></span></button>
                  <button [disabled]="isPreviewEvent" type="button" class="btn btn-primary button-blue"  (click)="addReplyRows()"><span class="glyphicon glyphicon-plus"></span></button>
                </div>
              </div>
              <div class="row">
                <form class="role add-reply" id="form-{{reply.divId}}">
                  <div class="col-xs-12 p0">
              <div class="col-xs-4" style="padding:0">
                <div class="col-xs-12" style="margin-bottom: 6px;">
                  <label style="cursor: default;" for="reason">Reason</label>
                  <select class="form-control" name="actionId" [(ngModel)]="reply.actionId" [attr.disabled]="isPreviewEvent? '' : null">
                    <option [value]="0" [selected]="reply.actionId ==0">Email is not opened</option>
                    <option [value]="13" [selected]="reply.actionId==13">Email is opened</option>
                    <option [value]="16" [selected]="reply.actionId ==16">Send immediately after email is opened</option>
                    <option [value]="24" [selected]="reply.actionId ==24">If partner has not shared event</option>
                    <option [value]="25" [selected]="reply.actionId ==25">Send email if RSVP Yes</option>
                    <option [value]="26" [selected]="reply.actionId ==26">Send email If RSVP No</option>
                    <option [value]="27" [selected]="reply.actionId ==27">Send email If RSVP Maybe</option>
                    <option [value]="28" [selected]="reply.actionId ==28">Send after event</option>
                  </select>
                </div>
                <div *ngIf="reply.actionId == 0 || reply.actionId == 13 || reply.actionId == 24">
                  <div class="col-xs-12">
                    <label style="cursor: default;" for="days" *ngIf="reply.actionId==22 || reply.actionId==23 " id="reply-days-{{reply.divId}}">Reply In X Days
                      <b style="color: red">*</b>
                      <font><b>(Minimum 1 Day)</b></font>
                    </label>
                    <label style="cursor: default;" for="days" *ngIf="reply.actionId!=22 && reply.actionId!=23" id="reply-days-{{reply.divId}}">Reply In X Days
                      <b style="color: red">*</b>
                    </label>
                    <input [attr.disabled]="isPreviewEvent? '' : null" type="number" class="form-control" name="days" placeholder="Days" [(ngModel)]="reply.replyInDays" min="0" oninput="validity.valid||(value='');">
                  </div>
                  <div class="col-xs-12 time-col " *ngIf="reply.actionId!=22 && reply.actionId!=23 ">
                    <div class="col-xs-2" style="cursor: default; position: relative; top: 28px;"><span for="time" id="send-time-{{reply.divId}}" class="time-picker-css">At<b style="color: red">*</b></span></div>
                    <div class="col-xs-10" style="height: 66px;"><timepicker [attr.disabled]="isPreviewEvent" [(ngModel)]="reply.replyTime" name="time" [hourStep]="1" [minuteStep]="1"></timepicker></div>
                  </div>
                </div>
                <div class="col-xs-12" style="position: relative; top: 11px;">
                  <label style="cursor: default;" for="time" id="reply-subject-{{reply.divId}}">Subject<b style="color: red">*</b></label>
                  <input [attr.disabled]="isPreviewEvent? '' : null" type="text" class="form-control" name="subject" [(ngModel)]="reply.subject" placeholder="Subject" maxlength="50">
                </div>
              </div>
                  <div class="col-xs-8">
                    <div id="ck-editor-{{i}}" *ngIf="!reply.defaultTemplate">
                      <div  style="margin-left: 1px;">
                        <label style="cursor: default;" for="days" id="reply-message-{{reply.divId}}">Message <b style="color: red">*</b>
                        </label>
                      </div>
                      <div [class.disabled]="isPreviewEvent? '' : null">
                        <ckeditor [attr.disabled]="isPreviewEvent? '' : null" [(ngModel)]="reply.body" name="body"></ckeditor>
                      </div>
                    </div>
                    <div id="reply-email-template-{{i}}" *ngIf="reply.defaultTemplate">
                      <div class="form-group" style="margin-left: 1px;">
                        <label for="days" id="email-template-{{reply.divId}}">Select Email Template<b style="color: red">*</b></label>
                      </div>
                      <app-loader [model]="campaignEmailTemplate.httpRequestLoader.isHorizontalCss" *ngIf="campaignEmailTemplate.httpRequestLoader.isLoading"></app-loader>
                      <app-error-pages *ngIf="campaignEmailTemplate.httpRequestLoader.isServerError"></app-error-pages>
                      <ng-container *ngIf="!campaignEmailTemplate.httpRequestLoader.isLoading && !campaignEmailTemplate.httpRequestLoader.isServerError">
                        <table class="table tgrid">
                          <thead>
                            <tr>
                              <th class="custom-center">Select</th>
                              <th class="custom-center">Name</th>
                              <th class="custom-center">Uploaded By</th>
                              <th class="custom-center">Preview</th>
                            </tr>
                          </thead>
                          <tbody>
                            <ng-container *ngIf="!isAdd && reply.emailTemplatesPagination.totalRecords>0 && reply.emailTemplatesPagination.pageIndex==1 && reply.selectedEmailTemplateIdForEdit>0 && reply.showSelectedEmailTemplate ">
                              <tr (click)="setReplyEmailTemplate(reply.emailTemplate.id,reply,i)" [class.active]="reply.emailTemplate.id==reply.selectedEmailTemplateId">
                                <td class="custom-center">
                                  <input [attr.disabled]="isPreviewEvent? '' : null" type="radio" name="reply-email-template" [value]="reply.emailTemplate.id" id="reply-{{i}}-{{reply.emailTemplate.id}}"
                                    (click)="setReplyEmailTemplate(reply.emailTemplate.id,reply,i)" [checked]="reply.emailTemplate.id == reply.selectedEmailTemplateId">
                                </td>
                                <td class="custom-center" *ngIf="reply.emailTemplate.name?.length>25" title="{{reply.emailTemplate.name}}">{{reply.emailTemplate.name|slice:0:25}}....</td>
                                <td class="custom-center" *ngIf="reply.emailTemplate.name?.length<=25" title="{{reply.emailTemplate.name}}">{{reply.emailTemplate.name}}</td>
                                <td class="custom-center" *ngIf="reply.emailTemplate.createdBy?.length>25" title="{{reply.emailTemplate.createdBy}}">{{reply.emailTemplate.createdBy|slice:0:25}}....</td>
                                <td class="custom-center" *ngIf="reply.emailTemplate.createdBy?.length<=25" title="{{reply.emailTemplate.createdBy}}">{{reply.emailTemplate.createdBy}}</td>
                                <td class="custom-center"><a ><i class="fa fa-eye" style="padding-top: 3px; font-size: 20px;" title="" data-original-title="Preview"></i></a></td>
                              </tr>
                            </ng-container>
                            <ng-container *ngFor="let emailTemplate of reply.emailTemplatesPagination.pagedItems ;let e =index">
                              <tr (click)="setReplyEmailTemplate(emailTemplate.id,reply,i,emailTemplate.draft)" [class.active]="emailTemplate.id==reply.selectedEmailTemplateId"
                                *ngIf="reply.selectedEmailTemplateIdForEdit!=emailTemplate.id">
                                <td class="custom-center">
                                  <input [attr.disabled]="isPreviewEvent? '' : null" *ngIf="!emailTemplate.draft" type="radio" name="reply-email-template" [value]="emailTemplate.id" id="reply-{{i}}-{{emailTemplate.id}}"
                                   (click)="setReplyEmailTemplate(emailTemplate.id,reply,i,emailTemplate.draft)" [checked]="emailTemplate.id == reply.selectedEmailTemplateId">
                                <input [class.disabled]="isPreviewEvent" *ngIf="emailTemplate.draft" title="draft template cannot be selected" disabled="disabled" type="radio" name="reply-email-template">
                                </td>
                                <td class="custom-center" *ngIf="emailTemplate.name?.length>25" title="{{emailTemplate.name}}">{{emailTemplate.name|slice:0:25}}....</td>
                                <td class="custom-center" *ngIf="emailTemplate.name?.length<=25" title="{{emailTemplate.name}}">{{emailTemplate.name}}</td>
                                <td class="custom-center" *ngIf="emailTemplate.createdBy?.length>25" title="{{emailTemplate.createdBy}}">{{emailTemplate.createdBy|slice:0:25}}....</td>
                                <td class="custom-center" *ngIf="emailTemplate.createdBy?.length<=25" title="{{emailTemplate.createdBy}}">{{emailTemplate.createdBy}}</td>
                                <td class="custom-center">
                                  <a *ngIf="!emailTemplate.draft" (click)="getEmailTemplatePreview(emailTemplate);$event.stopPropagation()">
                                    <i class="fa fa-eye" style="padding-top: 3px; font-size: 20px;" title="" data-original-title="Preview"></i>
                                  </a>
                                </td>
                              </tr>
                            </ng-container>
                          </tbody>
                        </table>
                        <div *ngIf="reply.emailTemplatesPagination.totalRecords==0" class="alert alert-info">
                          <strong>No email templates found</strong>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
          </fieldset>
        </div>

        <div class="col-xs-12">
          <!-- <div class="col-xs-4"> -->
            <div class="btn-group btn-group-justified">
               <ng-container *ngFor="let options of launchOptions">
                  <label class="btn btn-primary" style="border: 1px solid #fff;" [class.disabled]="isPreviewEvent" >
                    <input type="radio" class="text-center"  name="scheduleCampaign" [value]="options" (click)="setLaunchOptions(options)" ngDefaultControl
                    style=" margin-right:1.5em; " />{{options}}
                  </label>
               </ng-container>
               </div>
            <!-- <button [disabled]="isPreviewEvent"  class='btn btn-block btn-primary' (click)="createEventCampaign(eventCampaign, 'NOW')">Now</button> -->
          <!-- </div> -->
          <!-- <div class="col-xs-4"><button [disabled]="isPreviewEvent"  class='btn btn-block btn-primary' (click)="setScheduleEvent()">Schedule</button></div>
          <div class="col-xs-4"><button [disabled]="isPreviewEvent"  class='btn btn-block btn-primary' (click)="createEventCampaign(eventCampaign, 'SAVE')">Save</button></div> -->
        </div>
          <div class="col-md-12 p0" style="margin-top: 12px;" [hidden]="checkLaunchOption!='SCHEDULE'">
            <div class="col-md-4">
              <input [attr.disabled]="isPreviewEvent? '' : null"  type="text" id="launchTimeInString" class="form-control flatpickr" placeholder="Launch Time"
                  [(ngModel)]="eventCampaign.launchTimeInString" [ngModelOptions]="{standalone: true}" (input)="scheduleTimeError()" (blur)="scheduleTimeError()">
                  <div class="text-danger" *ngIf="eventError.scheduleTimeError">{{scheduleCampaignError}}</div>
            </div>
            <div class="col-md-4">
              <select [attr.disabled]="isPreviewEvent? '' : null" class="form-control" style="width: 100%" [(ngModel)]="eventCampaign.countryId" [ngModelOptions]="{standalone: true}" (change)="onChangeCountry($event.target.value)" id="countryName">
                <option *ngFor="let country of countries" [value]="country.id">{{country.name}}</option>
              </select>
              <div class="text-danger" *ngIf="!eventCampaign.countryId">Please select the country.</div>
            </div>
            <div class="col-md-4">
              <select [attr.disabled]="isPreviewEvent? '' : null" class="form-control" style="width: 100%" [(ngModel)]="eventCampaign.timeZone" [ngModelOptions]="{standalone: true}" id="timezoneId">
                <ng-container *ngIf="timezones?.length==1">
                  <option *ngFor="let timeZone of timezones" [value]="timeZone.timezoneId" [selected]="eventCampaign.countryId == timeZone.countryId">
                    {{timeZone.cityName}}
                  </option>
                </ng-container>
                <ng-container *ngIf="timezones?.length>1">
                  <option *ngFor="let timeZone of timezones" [value]="timeZone.timezoneId">
                    {{timeZone.cityName}}
                  </option>
                </ng-container>
              </select>
            </div>
            <!-- <div class="col-md-3 custom-center"><button type="button" class="btn btn-primary" (click)="scheduleCampaign()">Schedule</button></div> -->
          </div>
          <div class="portlet-title border-none" [hidden]="isPreviewEvent">
              <div class="col-xs-12 center-block" >
                <button type="submit" *ngIf="checkLaunchOption=='NOW'" class="btn green" style="width: 10em;" (click)="createEventCampaign(eventCampaign, 'NOW')">Launch</button>
                <button type="submit" *ngIf="checkLaunchOption=='SCHEDULE'" class="btn green" style="width: 10em;" (click)="scheduleCampaign()">Schedule</button>
                <button type="submit" *ngIf="checkLaunchOption=='SAVE'"  class="btn green" style="width: 10em;" (click)="createEventCampaign(eventCampaign, 'SAVE')">Save</button>
              </div>
            </div>
      </div>
    </div>
  </div>

  <div class="modal right" id="contactsModal" tabindex="-1" role="dialog" aria-labelledby="contactsModalLabel" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-user" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <a class="close-circle" data-dismiss="modal" (click)="closeModal()">
            <i class="fa fa-times"></i>
          </a>
          <h4 id="contactsModalLabel" class="modal-title caption-subject font-red-sunglo" style="font-weight: 600;color: #635e5e !important;">
            <span *ngIf="previewContactList.name?.length<20">{{previewContactList.name}}</span>
            <span *ngIf="previewContactList.name?.length>20">{{previewContactList.name | slice:0:20}}</span>
          </h4>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table tgrid">
              <thead>
                <tr>
                  <th>Email Address</th>
                  <th>First Name</th>
                  <th>Last Name</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let contact of contactsPagination.pagedItems">
                  <td title="{{contact.emailId}}">
                    <span *ngIf="contact.emailId?.length>25">{{contact.emailId | slice:0:25}}..</span>
                    <span *ngIf="contact.emailId?.length<=25">{{contact.emailId}}</span>
                  </td>
                  <td title="{{contact.firstName}}">
                      <span *ngIf="contact.firstName?.length>20">{{contact.firstName | slice:0:20}}..</span>
                      <span *ngIf="contact.firstName?.length<=20">{{contact.firstName}}</span>
                  </td>
                  <td title="{{contact.lastName}}">
                      <span *ngIf="contact.lastName?.length>20">{{contact.lastName | slice:0:20}}..</span>
                      <span *ngIf="contact.lastName?.length<=20">{{contact.lastName}}</span>
                  </td>
                </tr>
              </tbody>
            </table>
            <app-pagination style="position: relative;left: -10px;" *ngIf="contactsPagination.pagedItems?.length > 0" [pagination]="contactsPagination" [type]="'updatestatuscontacts'"
             (notifyParent)="setPage($event)" (notifyParentDropDown)="paginationDropDown($event)"></app-pagination>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- --------------------Email Template -->
  <div class="modal right" id="show_email_template_preivew">
    <div class="modal-dialog modal-lg modal-template">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close-circle" data-dismiss="modal">
            <i class="fa fa-times"></i>
          </button>
          <h4 class="modal-title" id="email-template-title" style="text-align: center;"></h4>
        </div>
        <div class="modal-body">
          <div id="htmlContent"></div>
        </div>
        <div class="modal-footer">
          <a href="javascript:void(0)" data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
        </div>
      </div>
    </div>
  </div>

<div class="portlet light" id="del-profile-div">
  <ngx-loading [show]="isLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
  <div class="portlet-title">
    <div class="caption">Deal Registration</div>
  </div>
  <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
  <div class="alert alert-danger" id="company-profile-error-div" style="display: none;">
    <a class="close" aria-label="close">x</a>
    <strong>Please complete the required (*) fields. </strong>
  </div>
  <div class="portlet-body clearfix">
    <div>
      <form role="form" id="deal-registration-form">
        <div class="row" style="margin-bottom: 50px;border: 1px solid darkslategrey;margin: 10px;padding: 10px">

          <!-- left page -->
          <div >
            <h2 class="caption">Lead Details</h2>
            <div class="col-sm-6 col-xs-12">
              <div class="form-group">
                <label class="control-label">Campaign Name
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" disabled="disabled" name="campaignName"  value="{{campaign.campaignName}}"
                  class="form-control" id="campaignName" />
              </div>

              <div class="form-group" [attr.class]="company">
                <label class="control-label">Company
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100"  class="form-control" [(ngModel)]=" dealRegistration.company"
                  [ngModelOptions]="{standalone: true}" id="company" (input)="validateField('company',false)" [disabled]="parent == 'manage-leads'"
                />
              </div>
              <div class="form-group" [attr.class]="firstName">
                <label class="control-label">First Name
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100" name="companyName"  class="form-control" [(ngModel)]=" dealRegistration.firstName"
                  [ngModelOptions]="{standalone: true}" id="firstName" (input)="validateField('firstName',false)" [disabled]="parent == 'manage-leads'"
                />
              </div>

              <div class="form-group" [attr.class]="lastName">
                <label class="control-label">Last Name
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100"  class="form-control" [(ngModel)]=" dealRegistration.lastName"
                  [ngModelOptions]="{standalone: true}" id="lastName" (input)="validateField('lastName',false)" [disabled]="parent == 'manage-leads'"
                />
              </div>


              <div class="form-group" *ngIf="dealRegistration.email">
                <label class="control-label">Email
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100"  class="form-control" [(ngModel)]=" dealRegistration.email" [ngModelOptions]="{standalone: true}"
                  id="email" disabled/>
              </div>

              <div class="form-group" [attr.class]="phoneDivClass">
                <label class="control-label">Phone Number
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <fieldset style="padding:0 !important;border: 1px solid #ece2e2 !important">
                  <int-phone-prefix [(ngModel)]="dealRegistration.phone" (input)="validateField('phone',false)" (blur)="validateField('phone',false)"
                    [ngModelOptions]="{standalone: true}"></int-phone-prefix>
                </fieldset>
                <span *ngIf="phoneError" style="color: #f55d7a">{{phoneErrorMessage}}</span>
              </div>





            </div>
            <!-- right page -->
            <div class="col-sm-6 col-xs-12">



              <div class="form-group" [attr.class]="leadStreet">
                <label class="control-label">Lead Address
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <textarea type="text" maxlength="100"  class="form-control" name="leadstreet" [(ngModel)]=" dealRegistration.leadStreet"
                  [ngModelOptions]="{standalone: true}" (input)="validateField('leadStreet',false)" id="leadStreet" [disabled]="parent == 'manage-leads'"></textarea>
              </div>
              <div class="form-group" [attr.class]="leadCity">
                <label class="control-label">Lead City
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100" name="city"  class="form-control" [(ngModel)]=" dealRegistration.leadCity"
                  [ngModelOptions]="{standalone: true}" (input)="validateField('leadCity',false)" id="leadCity" [disabled]="parent == 'manage-leads'"
                />
              </div>

              <div class="form-group" [attr.class]="leadState">
                <label class="control-label">Lead State/Province
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100"  class="form-control" name="lead state" [(ngModel)]=" dealRegistration.leadState"
                  [ngModelOptions]="{standalone: true}" id="leadState" (input)="validateField('leadState',false)" [disabled]="parent == 'manage-leads'"
                />
              </div>
              <div class="form-group" [attr.class]="leadPostalCode">
                <label class="control-label">Lead Postal Code
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="10" name="companyName"  class="form-control" [(ngModel)]=" dealRegistration.postalCode"
                  [ngModelOptions]="{standalone: true}" id="leadPostalCode" (input)="validateField('leadPostalCode',false)"
                  [disabled]="parent == 'manage-leads'" />
              </div>

              <div class="form-group" [attr.class]="country">
                <label class="control-label">Lead Country
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <select class="form-control"  [(ngModel)]="dealRegistration.leadCountry" [ngModelOptions]="{standalone: true}"
                  placeholder="Country" id="leadCountry" (input)="validateField('leadCountry',false)" [disabled]="parent == 'manage-leads'">
                  <option *ngFor="let country of countryNames.countries" [value]="country" [selected]="dealRegistration.leadCountry==country">{{country}}</option>
                </select>
              </div>
              <div class="form-group" [attr.class]="websiteDivClass">
                <label class="control-label">Website
                  <font style="color: #f55d7a">
                    <b>*</b>
                  </font>
                </label>
                <input type="text" maxlength="100" id="website" name="website"  class="form-control" [(ngModel)]="dealRegistration.website"
                  (input)="validateField('website',false)" (blur)="validateField('website',false)" [disabled]="parent == 'manage-leads'"
                />
                <span *ngIf="websiteError" style="color: #f55d7a">{{websiteErrorMessage}}</span>
              </div>


            </div>
          </div>
        </div>
        <div class=" row " style="margin-bottom: 50px;border: 1px solid darkslategrey;margin: 10px;padding: 10px">
          <h2 class="caption">Deal Details</h2>
          <div class="form-group" [attr.class]="title">
            <label class="control-label">Title
              <font style="color: #f55d7a">
                <b>*</b>
              </font>
            </label>
            <input type="text" maxlength="100" name="titleName"  class="form-control" [(ngModel)]=" dealRegistration.title"
              [ngModelOptions]="{standalone: true}" id="title" (input)="validateField('title',false)" [disabled]="parent == 'manage-leads'"
            />
          </div>
          <div class="form-group" [attr.class]="dealType">
            <label class="control-label">Deal Type
              <font style="color: #f55d7a">
                <b>*</b>
              </font>
            </label>
            <input type="text" maxlength="100"  class="form-control" [(ngModel)]=" dealRegistration.dealType"
              [ngModelOptions]="{standalone: true}" id="dealType" (input)="validateField('dealType',false)" [disabled]="parent == 'manage-leads'"
            />
          </div>
          
          <div class="form-group" [attr.class]="opportunityAmount">
            <label class="control-label">Opportunity Amount
              <font style="color: #f55d7a">
                <b>*</b>
              </font>
            </label>
            <input type="number" maxlength="10"  class="form-control" [(ngModel)]=" dealRegistration.opportunityAmount"
              [ngModelOptions]="{standalone: true}" id="opportunityAmount" (input)="validateField('opportunityAmount',false)"
              [disabled]="parent == 'manage-leads'" />
          </div>
          <div class="form-group" [attr.class]="estimatedCloseDate">
            <label class="control-label">Estimated Close date
              <font style="color: #f55d7a">
                <b>*</b>
              </font>
            </label>
            <input type="text"  class="form-control flatpickr square-box" [(ngModel)]=" dealRegistration.estimatedCloseDate "
              [ngModelOptions]="{standalone: true}" id="estimatedCloseDate" (input)="validateField('estimatedCloseDate',false)"
              [disabled]="parent == 'manage-leads'" />
          </div>
        </div>
        <div class=" row col-sm-12 col-xs-12" style="margin-bottom: 50px">

          <div *ngIf="form!= null && form.campaignDealQuestionDTOs != null">
            <div *ngFor="let question of form.campaignDealQuestionDTOs;let i=index">
              <div class="col-sm-6 col-xs-12" *ngIf="i%2 ==0">
                <div class="form-group" [attr.class]="question.question">
                  <label class="control-label">{{question.question}}
                    <font style="color: #f55d7a">
                      <b>*</b>
                    </font>
                  </label>
                  <input type="text" maxlength="100" name="{{question.question}}"  class="form-control"
                    [(ngModel)]="question.answer" [ngModelOptions]="{standalone: true}" id="question_{{question.id}}" (input)="validateField(question,true)"
                    [disabled]="parent == 'manage-leads'" />
                </div>
              </div>
              <div class="col-sm-6 col-xs-12" *ngIf="i%2 !=0">
                <div class="form-group" [attr.class]="question.question">
                  <label class="control-label">{{question.question}}
                    <font style="color: #f55d7a">
                      <b>*</b>
                    </font>
                  </label>
                  <input type="text" maxlength="100" name="{{question.question}}"  class="form-control"
                    [(ngModel)]="question.answer" [ngModelOptions]="{standalone: true}" id="question_{{question.id}}" (input)="validateField(question,true)"
                    [disabled]="parent == 'manage-leads'" />
                </div>
              </div>

            </div>
          </div>
        </div>

        <div class="form-group">
          <a class="dashboard-stat yellow-gold" style="padding: 9px 0;margin-top: 10px" (click)="addProperties()">
            <i class="fa fa-plus-square p0" style="margin: 0 5px;"></i>
            Add Your Comments
          </a>
        </div>
        <div class="col-xs-12" id="reply-onclick-div" style="position: relative; bottom: 4px;">
          <fieldset *ngIf="properties?.length>0">
            <legend>Add Your Comments</legend>
            <div *ngFor="let property of properties;let i=index">
              <div class="portlet light dashboard-stat2">
                <div class="portlet-title custom-change-css" [ngClass]="{'colorBlue':isEven(i+1), 'colorRed':!isEven(i+1)}">
                  <div class="col-xs-6">
                    <h4 class="text-left" style="color:#fff">Comment-{{i+1}}</h4>
                  </div>
                  <div class="col-xs-6">
                    <div class="pull-right" id="question-icons">
                      <button type="button" class="btn-danger button-blue" (click)="remove(i+1,property.id)">
                        <span class="glyphicon glyphicon-trash"></span>
                      </button>
                      <button type="button" class="btn-primary button-blue" (click)="addProperties()">
                        <span class="glyphicon glyphicon-plus"></span>
                      </button>
                      <button type="button" class="btn-primary button-blue" (click)="commentsection(property)" *ngIf=" property.isSaved">
                        <span class="glyphicon glyphicon-comment"></span>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <form class="role add-reply" id="form-{{property.divId}}">
                    <div class="col-xs-10" style="padding:0">
                      <div class="form-group" [attr.class]="property.validationStausKey">
                        <label class="control-label">Descrption
                          <font style="color: #f55d7a">
                            <b>*</b>
                          </font>
                        </label>
                        <input type="text" maxlength="100"  class="form-control" [(ngModel)]=" property.key" [ngModelOptions]="{standalone: true}"
                          id="question" (input)="validateQuestion(property)" [disabled]="property.isDisabled" />
                      </div>
                      <div class="form-group" [attr.class]="property.validationStausValue">
                        <label class="control-label">Comment
                          <font style="color: #f55d7a">
                            <b>*</b>
                          </font>
                        </label>
                        <textarea type="text" maxlength="1000"  class="form-control" [(ngModel)]=" property.value" [ngModelOptions]="{standalone: true}"
                          id="comment" (input)="validateComment(property)" [disabled]="property.isDisabled"></textarea>
                      </div>
                    </div>
                  </form>


                  <div *ngIf=" property.isCommentSection ">

                    <app-manage-deal-comments [lead]="dealRegistration" [property]="property"></app-manage-deal-comments>
                  </div>

                </div>
              </div>
            </div>
          </fieldset>
        </div>
        <hr>
        <div class="pull-right" *ngIf="!parent">
          <button type="submit" id="saveDeal" [disabled]=" !isDealRegistrationFormValid" (click)="save()" class="btn green-haze"
          *ngIf="submitButtonText.length >0" >{{submitButtonText}}</button>
          <!--  <button type="submit" id="updateDeal" (click)="update()"class="btn green-haze">Update</button> -->
        </div>
      </form>


    </div>
  </div>
</div>
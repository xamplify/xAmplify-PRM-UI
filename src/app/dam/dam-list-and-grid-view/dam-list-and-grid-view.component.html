<div style="position: relative; top: -10px;">
	<app-response-message [customResponse]="customResponse"	*ngIf="customResponse.isVisible"></app-response-message>
</div>
<ngx-loading [show]="loading"
	[config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="row">
	<div class="col-md-12">
		<div class="portlet light clearfix mDamResponse" style="min-height: 644px;">
			<ng-container *ngIf="!isGridViewHistory && !assetDetailsPreview">
			<div class="portlet-title" style="border-bottom: none">
				<div class="row">
					<div class="page-toolbar col-xs-12">
						<div class="btn-group pull-right">
							<ng-container class='m10'>
								 <span	class="btn btn-xs l-g-view"	[class.disabled]="modulesDisplayType.isListView" data-toggle="tooltip" data-placement="bottom" title="List View" (click)="setViewType('l')"> 
									<i class="fa fa-th-list p10" aria-hidden="true"></i></span> &nbsp; 
									<span class="btn btn-xs l-g-view margin-space" [class.disabled]="modulesDisplayType.isGridView"	data-toggle="tooltip" data-placement="bottom" title="Grid View"	(click)="setViewType('g')"> 
										<i class="fa fa-th-large p10" aria-hidden="true"></i>
									</span>
									 <!-- <ng-container>
										<span class="btn btn-xs  l-g-view margin-space" data-toggle="tooltip" data-placement="bottom" title="Folder Grid View"  (click)="setViewType('Folder-Grid')">
										<i  class="fa fa-folder p10" aria-hidden="true"></i>
										</span>
										<span class="btn btn-xs  l-g-view margin-space folder-list-span-custom-width" data-toggle="tooltip" data-placement="bottom" title="Folder List View"  (click)="setViewType('Folder-List')">
										<img src="assets/images/folder-list.png" class="folder-list-image-custom-css" alt=""/>
										</span>
                        			</ng-container>
									<span  class="btn btn-xs  l-g-view margin-space" data-toggle="tooltip" data-placement="bottom" title="Go back" (click)="setViewType('Folder-Grid')">
									<i class="fa fa-arrow-up p10" aria-hidden="true"></i></span> -->
							</ng-container>
							<div class="inputs mDamTop" style="float: right">
								<a class="close-circle ref-mar" (click)="refreshList()"	title="Refresh">
									<i class="fa fa-refresh" aria-hidden="true"></i>
								</a>
								<div style="float: left;">
									<ng-container *ngIf="isPartnerView">
										<select class="form-control mDamSort"	[(ngModel)]="sortOption.publishedDamSortOption"	(ngModelChange)="sortAssets($event)"style="position: relative; right: -3px;">
											<option	*ngFor="let option of sortOption.publishedDamSortDropDownOptions" [ngValue]="option">{{option.name}}</option>
										</select> 
									</ng-container>
									<ng-container *ngIf="!isPartnerView">
										<select	class="form-control mDamSort" [(ngModel)]="sortOption.damSortOption"	(ngModelChange)="sortAssets($event)" style="position: relative; right: -3px;">
											<option	*ngFor="let option of sortOption.damSortDropDownOptions" [ngValue]="option">{{option.name}}</option>
										</select> 
									</ng-container>
								</div>
								<div class="portlet-input input-inline input-small"	style="margin-right: 10px;">
									<div class="input-icon right mDamSearch"	style="position: relative; right: -11px;">
										<input type="text" style="height: 34px;" class="form-control"	[(ngModel)]="sortOption.searchKey"	[ngModelOptions]="{standalone: true}" placeholder="search..." (keypress)="eventHandler($event.keyCode)">
										<button	class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="sortOption.searchKey" (click)="sortOption.searchKey='';searchAssets();"></button>
										<button type="submit" class="search-box-item-click"	(click)="searchAssets()">
											<i class="fa fa-search" aria-hidden="true"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<app-list-loader
				*ngIf="listLoader.isLoading && modulesDisplayType.isListView"></app-list-loader>
			<app-grid-loader
				*ngIf="listLoader.isLoading && modulesDisplayType.isGridView"></app-grid-loader>
			<!---List View----->
			<section
				*ngIf="modulesDisplayType.isListView && !listLoader.isLoading">
				<div class="table-responsive">
					<table class='table tgrid table-hover table-sm'
						id="manage-assets-table" *ngIf="pagination.pagedItems?.length>0"
						aria-describedby="manageAssetTables">
						<thead>
							<tr>
								<th colspan="2" style="width: 45%" id="border-bottom"><span
									class="gridHeader" translate>Asset Details </span></th>
								<th class="text-center" style="width: 5%;" scope="row" translate>Type</th>
								<th class="text-center" style="width: 10%" scope="row" translate
									*ngIf="isPartnerView">Published On</th>
								<th class="text-center" style="width: 10%" scope="row" translate
									*ngIf="!isPartnerView">Created On</th>
								<th class="text-center" id="min-width" style="width: 30%;" translate>Actions</th>
							</tr>
						</thead>
						<tbody>
							<ng-container
								*ngFor="let asset of pagination.pagedItems ;let i =index">
							<tr>
								<td style="width: 10%;">
									<div class="thumbnail-wrapper">
										<img class="custom-image-css" src="{{asset?.thumbnailPath}}"
											alt="Image Not Found">
									</div>
								</td>
								<td>
									<h4 class="moreipsis mt5 mb5 f-w-600"
										title="{{asset?.assetName}}">
										<span><strong>{{asset?.assetName}}</strong></span>
									</h4>
									<h6 class="moreipsis" title="{{asset?.displayName}}">
										<span *ngIf="isPartnerView" translate> Published By <strong>{{asset?.displayName}}</strong></span>
										<span *ngIf="!isPartnerView" translate> Created By <strong>{{asset?.displayName}}</strong></span>
									</h6>
									<h6 class="moreipsis"
										*ngIf="!isPartnerView && asset?.beeTemplate">
										<span translate> Version <strong>{{asset?.versionInString}}</strong></span>
									</h6>
									<h6 class="moreipsis" *ngIf="isPartnerView"
										title="{{asset?.vendorCompanyName}}">
										<span translate> From <strong>{{asset?.vendorCompanyName
												| slice:0:20}}</strong> <strong
											*ngIf="asset?.vendorCompanyName?.length>20">..</strong>
										</span>
									</h6>
									<h6 style="padding-top: 5px;">
										<ng-container *ngIf="asset.tagNames?.length > 0">
											<div class="tag" title="{{asset.tagNames[0]}}">
												<ng-container *ngIf="asset.tagNames?.length == 1">{{asset.tagNames[0]}}
												</ng-container>
												<ng-container *ngIf="asset.tagNames?.length > 1">{{asset.tagNames[0] | slice:0:15}} <span
														*ngIf="asset.tagNames[0]?.length>15">..</span>
												</ng-container>
											</div>
											<ng-container *ngIf="asset.tagNames.length > 1">
												<div class="tag" title="{{asset.tagNames[1]}}">
													{{asset.tagNames[1] | slice:0:15}} <span *ngIf="asset.tagNames[1]?.length>15">..</span>
												</div>
											</ng-container>
											<span *ngIf="asset.tagNames?.length>2" class="tag-dots" data-toggle="tooltip" data-placement="top"
												title="{{asset.toolTipTagNames}}">...</span>
										</ng-container>
									</h6>
									<h6 *ngIf="asset?.published" class="view-banner published" translate>Published</h6>
								</td>
								<td class="text-center">{{asset?.assetType}}</td>
								<td class="text-center"><app-timestamp
										[dateAndTime]="asset?.displayTime"> </app-timestamp></td>
								<td>
									<div
										[className]="asset?.history ? 'actions-block override-actions':'actions-block override-actions custom-width-icon'">
										<ng-container *ngIf="asset?.status=='COMPLETED'">
										<a *ngIf="asset?.history &&!isPartnerView  && asset?.edit" title="History"	(click)="expandHistory(asset,i)"> 
											<i class="fa"	[ngClass]="{'fa-history': !asset?.expand, 'fa-minus': asset?.expand}" aria-hidden="true"></i>
										</a> 
										<a *ngIf="asset?.beeTemplate && !isPartnerView && asset?.edit"	title="Design" (click)="addOrEdit(asset.id)">
											 <i class="fa fa-paint-brush" aria-hidden="true"></i>
										</a> 
										<a *ngIf="asset?.beeTemplate && isPartnerView && asset?.edit" title="Edit"	(click)="addOrEdit(asset.id)">
											 <i class="fa fa-edit"	aria-hidden="true"></i>
										</a> 
										<a *ngIf="!isPartnerView && asset?.edit" title="Edit"	(click)="editDetails(asset.id)">
											 <i class="fa fa-edit"	aria-hidden="true"></i>
										</a> 
										<a *ngIf="!isPartnerView && asset?.showPreviewIcon"	title="Preview" (click)="preview(asset)">
											 <i	class="fa fa-eye" aria-hidden="true"></i>
										</a> 
										<a *ngIf="!isPartnerView" title="Publish" (click)="openPublishPopup(asset.id)">
											 <i	class="fa fa-share" aria-hidden="true"></i>
										</a> 
										<a *ngIf="!isPartnerView" title="Download"	(click)="openPopup(asset)">
											 <i class="fa fa-download"	aria-hidden="true"></i>
										</a> 
										<a title="View Analytics" (click)="viewAnalytics(asset)">
											<i class="fa fa-line-chart" aria-hidden="true"></i>
										</a> 
										<a *ngIf="isPartnerView" title="View Details"
											(click)="viewDetails(asset)">
											 <i class="fa fa-eye" aria-hidden="true"></i>
										</a>
										<a *ngIf="!isPartnerView && asset?.delete " title="Delete"
											(click)="confirmDelete(asset)"> 
											<i class="fa fa-trash-o" aria-hidden="true"></i>
										</a>
									 </ng-container>
									</div>
								</td>
							</tr>
							<tr [ngClass]="{'hidden': !asset?.expand}">
								<td [attr.colspan]="colspanValue">
									<div class="table-responsive">
										<table class="table tgrid table-condensed"
											aria-describedby="asset-history" id="asset-history">
											<thead>
												<tr>
													<th colspan="2" style="width: 35%" id="border-bottom">
														<span class="gridHeader" translate>Asset Details</span>
													</th>
													<th class="text-center" scope="row" translate>Type</th>
													<th class="text-center" scope="row" translate>Created
														On</th>
													<th class="text-center" id="min-width" translate>Actions</th>
												</tr>
											</thead>
											<tbody>
												<app-auto-response-loader *ngIf="historyLoader.isLoading">
												</app-auto-response-loader>
												<ng-container *ngIf="!historyLoader.isLoading">
												<tr
													*ngFor="let asset of historyPagination.pagedItems ;let i =index"
													id="history-tr">
													<td style="width: 10%;">
														<div class="thumbnail-wrapper">
															<img class="custom-image-css"
																src="{{asset?.thumbnailPath}}" alt="Image Not Found">
														</div>
													</td>
													<td>
														<h4 class="moreipsis mt5 mb5 f-w-600"
															title="{{asset?.assetName}}">
															<span><strong>{{asset?.assetName}}</strong></span>
														</h4>
														<h6 class="moreipsis" title="{{asset?.displayName}}">
															<span translate> Created By <strong>{{asset?.displayName}}</strong></span>
														</h6>
														<h6 class="moreipsis"
															*ngIf="!isPartnerView && asset?.beeTemplate">
															<span translate> Version <strong>{{asset?.versionInString}}</strong></span>
														</h6>
														<h6 *ngIf="asset?.published" class="view-banner published"
															translate>Published</h6>
													</td>
													<td class="text-center">{{asset?.assetType}}</td>
													<td class="text-center"><app-timestamp
															[dateAndTime]="asset?.displayTime"> </app-timestamp></td>
													<td id="actions-row">
														<div class="actions-block override-actions custom-width-icon">
															<a title="Design" (click)="addOrEdit(asset.id)"> <i
																class="fa fa-paint-brush" aria-hidden="true"></i>
															</a>
															 <a *ngIf="!isPartnerView" title="Edit"
																(click)="editDetails(asset.id)"> <i
																class="fa fa-edit" aria-hidden="true"></i>
															</a> 
															<a title="Preview" (click)="preview(asset)"> <i
																class="fa fa-eye" aria-hidden="true"></i>
															</a> 
															<a title="Publish" (click)="openPublishPopup(asset.id)">
																<i class="fa fa-share" aria-hidden="true"></i>
															</a> 
															<a title="Download" (click)="openPopup(asset)"> <i
																class="fa fa-download" aria-hidden="true"></i>
															</a> 
															<a title="View Analytics" (click)="viewAnalytics(asset)">
																<i class="fa fa-line-chart" aria-hidden="true"></i>
															</a> 
															<a title="Delete" (click)="confirmDelete(asset)"> <i
																class="fa fa-trash-o" aria-hidden="true"></i>
															</a>
														</div>
													</td>
												</tr>
												</ng-container>
											</tbody>
										</table>
										<!---Pagination-->
										<div *ngIf="historyPagination.totalRecords==0 && !historyLoader.isLoading" class="alert alert-info text-center">
											<strong>No Data Found.</strong>
										</div>
										<div *ngIf="historyPagination.pagedItems.length !== 0"
											[hidden]="historyLoader.isLoading">
											<app-pagination [pagination]="historyPagination"
												(notifyParent)="setHistoryPage($event)"
												(notifyParentDropDown)="listAssetsHistory($event)">
											</app-pagination>
										</div>
									</div>
								</td>
							</tr>
							</ng-container>
						</tbody>
					</table>
				</div>
			</section>
			<!----Grid View------->
			<section *ngIf="modulesDisplayType.isGridView && !listLoader.isLoading">
				<div class="row" *ngIf="modulesDisplayType.isGridView && !listLoader.isLoading && !listLoader.isServerError">
					<div class="col-md-3 col-sm-4 col-xs-12" *ngFor="let asset of pagination.pagedItems ;let i =index"	id="assetList_{{asset.id}}">
						<div class="grid-box min-h default-cursor box-shadow mHeight">
							<img class="img-class mxv" src="{{asset?.thumbnailPath}}"
								alt="{{asset?.assetName}}">
							<h4 class="ellipsis mt5 mb5 f-w-600" title="{{asset?.assetName}}">
								{{asset?.assetName | slice:0:25}} <span
									*ngIf="asset?.assetName?.length>25">...</span><br>
								<br>
							</h4>
							<div>
								<span class="view-banner-dam">{{asset?.assetType}}</span>
								<h6 translate>
									<span *ngIf="isPartnerView">Published On</span> <span
										*ngIf="!isPartnerView">Created On</span> <strong> <app-timestamp
											[showInLine]="'true'" [dateAndTime]="asset?.displayTime">
										</app-timestamp>
									</strong>
								</h6>
								<h6 title="{{asset?.displayName}}" translate>
									By <strong>{{asset?.displayName | slice:0:17}}</strong> <span
										*ngIf="asset?.displayName?.length>17">..</span>
								</h6>
								
								<h6 class="moreipsis"
									*ngIf="!isPartnerView && asset?.beeTemplate">
									<span translate> Version <strong>{{asset?.versionInString}}</strong></span>
								</h6>
								<h6 *ngIf="isPartnerView" title="{{asset?.vendorCompanyName}}">
									From <strong>{{asset?.vendorCompanyName | slice:0:17}}</strong> <span
										*ngIf="asset?.vendorCompanyName?.length>17">..</span>
								</h6>
							</div>
							<div class="ribbon">
								<span *ngIf="asset?.published" translate>Published</span>
							</div>
							
							<div class="bar auto-height">
								
								<app-asset-grid-view-actions [isPartnerView]="isPartnerView" [asset]="asset"
								 (assetGridViewActionsEmitter)="assetGridViewActionsEmitter($event)"
								(assetGridViewActionsPdfEmitter)="assetGridViewActionsPdfEmitter($event)"
								(assetGridViewActionsDeleteActionEmitter) = "assetGridViewActionsDeleteActionEmitter($event)"
								>
								</app-asset-grid-view-actions>
							</div>
						</div>
					</div>
				</div>
			</section>
			<!---Pagination-->
			<div *ngIf="pagination.totalRecords==0 && !listLoader.isLoading"
				class="alert alert-info text-center">
				<strong>No Data Found.</strong>
			</div>
			<div *ngIf="pagination.pagedItems.length !== 0"	[hidden]="listLoader.isLoading">
				<app-pagination [pagination]="pagination" (notifyParent)="setPage($event)" (notifyParentDropDown)="listItems($event)"></app-pagination>
			</div>
			</ng-container>

			<!-------PDF History------>
			<ng-container *ngIf="isGridViewHistory && !assetDetailsPreview">
			<h4 title="{{selectedAssetName}}">
				<strong>{{selectedAssetName | slice:0:25}}
					<span *ngIf="selectedAssetName?.length>25">...</span>
				</strong>
				 <a	class="close-circle" (click)="closeHistory()"> 
					 <i	class="fa fa-times" aria-hidden="true"></i>
				</a>
			</h4>
			<app-grid-loader *ngIf="historyLoader.isLoading"></app-grid-loader>
			<section *ngIf="!historyLoader.isLoading">
				<div class="row">
					<div class="col-md-3 col-sm-4 col-xs-12"
						*ngFor="let asset of historyPagination.pagedItems ;let i =index"
						id="assetList_{{asset.id}}">
						<div class="grid-box box-shadow">
							<img class="img-class mxv" src="{{asset?.thumbnailPath}}"
								alt="{{asset?.assetName}}">
							<h4 class="ellipsis mt5 mb5 f-w-600" title="{{asset?.assetName}}">
								{{asset?.assetName | slice:0:25}} <span
									*ngIf="asset?.assetName?.length>25">...</span><br>
								<br>
							</h4>
							<h4>Version {{asset?.versionInString}}</h4>
							<div>
								<span class="view-banner-dam">{{asset?.assetType}}</span>
								<h6 translate>
									<span *ngIf="isPartnerView">Published On</span> <span
										*ngIf="!isPartnerView">Created On</span> <strong> <app-timestamp
											[showInLine]="'true'" [dateAndTime]="asset?.displayTime">
										</app-timestamp>
									</strong>
								</h6>
								<h6 title="{{asset?.displayName}}" translate>
									By <strong>{{asset?.displayName | slice:0:17}}</strong> <span
										*ngIf="asset?.displayName?.length>17">..</span>
								</h6>
								<h6 *ngIf="isPartnerView" title="{{asset?.vendorCompanyName}}">
									By <strong>{{asset?.vendorCompanyName | slice:0:17}}</strong> <span
										*ngIf="asset?.vendorCompanyName?.length>17">..</span>
								</h6>
							</div>
							<div class="ribbon">
								<span *ngIf="asset?.published" translate>Published</span>
							</div>
							<div class="bar auto-height">
								<a *ngIf="asset?.beeTemplate" title="Design"
									(click)="addOrEdit(asset.id)"> <i class="fa fa-paint-brush"
									aria-hidden="true"></i>
								</a> <a *ngIf="!isPartnerView" title="Edit"
									(click)="editDetails(asset.id)">
									 <i class="fa fa-edit"
									aria-hidden="true"></i>
								</a> <a title="Preview" (click)="preview(asset)"> <i
									class="fa fa-eye" aria-hidden="true"></i>
								</a> <a *ngIf="!isPartnerView" title="Publish"
									(click)="openPublishPopup(asset.id)"> <i
									class="fa fa-share" aria-hidden="true"></i>
								</a> <a title="Download" (click)="openPopup(asset)"> <i
									class="fa fa-download" aria-hidden="true"></i>
								</a> <a title="View Analytics" (click)="viewAnalytics(asset)"> <i
									class="fa fa-line-chart" aria-hidden="true"></i>
								</a> <a *ngIf="!isPartnerView" title="Delete" class="delete"
									(click)="confirmDelete(asset)"> <i class="fa fa-trash-o"
									aria-hidden="true"></i>
								</a>
							</div>
						</div>
					</div>
				</div>
			</section>
			<div
				*ngIf="historyPagination.totalRecords==0 && !historyLoader.isLoading"
				class="alert alert-info text-center">
				<strong>No Data Found.</strong>
			</div>
			<div *ngIf="historyPagination.pagedItems.length !== 0"
				[hidden]="historyLoader.isLoading">
				<app-pagination [pagination]="historyPagination"
					(notifyParent)="setPage($event)"
					(notifyParentDropDown)="listAssetsHistory($event)">
				</app-pagination>
			</div>
			</ng-container>
			<!-------END of PDF History------>			
		</div>
	</div>
</div>

<!--Download Pdf Modal Popup-->
<ng-container *ngIf="showPdfModalPopup">
<app-download-asset-popup [asset]="asset" [isPartnerView]="isPartnerView" (downloadAssetPopupEventEmitter)="downloadAssetPopupEventEmitter()"></app-download-asset-popup>
</ng-container>
<!---Publish Pop Up-->
<ng-container *ngIf="showPublishPopup"> 
<app-partner-company-and-groups-modal-popup
	[companyId]="loggedInUserCompanyId" [inputId]="selectedAssetId" [moduleName]="'dam'"
	(notifyOtherComponent)="notificationFromPublishToPartnersComponent()"></app-partner-company-and-groups-modal-popup>
</ng-container>
<!---Preview Pop Up-->
<ng-container *ngIf="isPreview">
	<app-preview-asset-popup [asset]="asset" (previewAssetPopupEmitter)="previewAssetPopupEmitter()"></app-preview-asset-popup>
</ng-container>
<!--Delete Asset-->
<ng-container *ngIf="deleteAsset">
	<app-delete-assets [asset]="asset" (deleteAssetLoaderEmitter)="deleteAssetLoaderEmitter()"
	 (deleteAssetSuccessEmitter)="deleteAssetSuccessEmitter()" 
	 (deleteAssetCancelEmitter)="deleteAssetCancelEmitter()">
	</app-delete-assets>
</ng-container>

<ng-container *ngIf="!referenceService.loaderFromAdmin">
<div class="page-content ml0">
  <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
  <div class="page-bar">
    <ul class="page-breadcrumb">
      <li>
        <i class="fa fa-home" aria-hidden="true"></i>
        <a (click)="detailsTielsView = false">Admin Report</a>
      </li>
      <li *ngIf="detailsTielsView">
        <i class="fa fa-angle-right" aria-hidden="true"></i>
        <a>Vendor Report</a>
      </li>
    </ul>
  </div>
  <div>
   <app-list-all-users *ngIf="!detailsTielsView"></app-list-all-users> 
  <app-demo-request *ngIf="!detailsTielsView"></app-demo-request>
	  <section *ngIf="!detailsTielsView">
	  <!-- -Top 10 Recent Registered Users -->
	  <app-recent-logged-in-users [type]="'registered'" (notifyAdminReportComponent)="selectedVendorDetails($event)"></app-recent-logged-in-users>
	  <!-- ---Top 10 Recent LoggedIn Users -->
	  <app-recent-logged-in-users [type]="'logged in'" (notifyAdminReportComponent)="selectedVendorDetails($event)"></app-recent-logged-in-users>
    </section>
    <div class="col-xs-12" *ngIf="!detailsTielsView">
      <app-list-loader [rowsCount]="12" *ngIf="isListLoading"></app-list-loader>
      <div class="portlet light">
        <div class="portlet-title">
          <div class="caption">Vendor Report</div>
		  <div class="inputs sort-class col-xs-5" align="right" style="float: right; margin-top: 2px;">
      <div class="col-xs-6" [ngClass]="{'search-css': !referenceService.isMobileScreenSize(), 'mobile-css':referenceService.isMobileScreenSize() }">
        <select class="form-control" [(ngModel)]="sortOption" (ngModelChange)="sortByOption($event)">
			<ng-container *ngFor="let sort of sortOptions; let i = index">
				<option [ngValue]="sort">{{sort.name}}</option>
			</ng-container>
		</select>
      </div>
      <div class="col-xs-6 portlet-input input-inline search-class" [ngStyle]="{'width':referenceService.isMobileScreenSize()? '100%': 'unset'}">
        <div class="input-icon right" style="width: 230px; margin-left: -22px;">
          <input type="text" [(ngModel)]="searchKey" [ngModelOptions]="{standalone: true}" class="form-control" placeholder="Search"
            (keypress)="eventHandler($event.keyCode)">

          <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="searchKey" (click)="searchKey='';search()"></button>
          <button type="submit" class="search-box-item-click" (click)="search()"><i class="fa fa-search"></i></button>
        </div>
      </div>
    </div>
        </div>
        <div class="portlet-body clearfix">
          <div *ngIf="!isListLoading">
            <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
            <div class="table-responsive" *ngIf="pagination.totalRecords">
              <table class='table tgrid'>
                <thead>
                  <tr>
                    <th style="width: 20%;">NAME</th>
                    <th class='text-center'>COMPANY</th>
                    <th class='text-center'>ROLE</th>
                    <th class='text-center'>STATUS</th>
                    <th class='text-center'>REGISTRATION DATE</th>
                    <th class='text-center'>LAST LOGIN</th>
                    <th class='text-center'>UPDATED TIME</th>
                    <th class="text-center">ACTIONS</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let report of vendorsDetails;let i = index">
                    <!-- this div for ngFor -->
                    <tr (click)="selectedVendorDetails(report)" class="highletedRow">
                      <td>
                        <app-user-info [userInfo]="report">
                        </app-user-info>
                      </td>
                      <td align="center">{{report.companyName}}</td>
                      <td align="center">
                        <span *ngIf="report.roleId==2">Org_Admin</span>
                        <span *ngIf="report.roleId==13">Vendor</span>
                        <span *ngIf="report.roleId==20">PRM</span>
                      </td>
                      <td align="center">{{report.userStatus}}</td>
                      <td align="center">
                        <app-timestamp [dateAndTime]="report.dateReg"> </app-timestamp>
                      </td>
                      <td align="center">
                        <app-timestamp [dateAndTime]="report.dateLastLogin"> </app-timestamp>
                      </td>
                      <td align="center">
                        <app-timestamp [dateAndTime]="report.updatedTime"> </app-timestamp>
                      </td>
                      <td align="center">
                        <a data-toggle="tooltip" data-placement="top" title="Company profile details" (click)="getVendorCompanyProfile(report)"> 
								<i class="fa fa-building-o" style="font-size: 20px;"></i></a>

                        <a data-toggle="tooltip" data-placement="top" title="My profile details" (click)="getVendorMyProfile(report)"> 
								<i class="fa fa fa-user-o" style="font-size: 20px;margin-left:5px"></i></a>
								
						<a data-toggle="tooltip" data-placement="top" title="Send welcome email" (click)="$event.stopPropagation();sendWelcomeEmail(report)"> 
								<i class="fa fa fa-envelope" style="font-size: 20px;margin-left:5px"></i></a>
								
						<a data-toggle="tooltip" data-placement="top" title="Copy link" (click)="$event.stopPropagation();openLinkInPopup(report)"> 
							<i class="fa fa fa-copy" style="font-size: 20px;margin-left:5px"></i></a>


 						 <a data-toggle="tooltip" data-placement="top" title="Activate/Deactivate" (click)="$event.stopPropagation();activateOrDeactivate(report)"> 
								<i class="fa fa-universal-access" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i></a>

                       <!--  <a data-toggle="tooltip" data-placement="top" title="Change Role" (click)="$event.stopPropagation();changeStatus(report)"> 
								<i class="fa fa-pencil-square-o" style="font-size: 20px;margin-left:5px"></i></a> -->

                        <!-- <a data-toggle="tooltip" data-placement="top" title="Change Access" (click)="$event.stopPropagation();getAccess(report)"> 
                <i class="fa fa-universal-access" style="font-size: 20px;margin-left:5px"></i></a> -->
                
                <a data-toggle="tooltip" data-placement="top" title="Edit Modules" (click)="$event.stopPropagation();displayModuleAccess(report)"> 
                  <i class="fa fa-pencil-square-o" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i></a>
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <app-pagination [pagination]="pagination" [type]="'admin-reports'" (notifyParent)="setPage($event)" (notifyParentDropDown)="onChangeAllContactUsers($event)"></app-pagination>
    </div>
<!-----------Partner Companies------->
  <app-admin-partner-companies *ngIf="!detailsTielsView"></app-admin-partner-companies>
  
    <section *ngIf="detailsTielsView">
      <div class="portlet light">
        <div class="portlet-title">
          <div class="caption">Vendor Report</div>
        </div>
        <div class="portlet-body clearfix">
            <div class="table-responsive">
              <table class='table tgrid'>
                <thead>
                  <tr>
                    <th style="width: 20%;">NAME</th>
                    <th>COMPANY</th>
                    <th>STATUS</th>
                    <th class='text-center'>REGISTRATION DATE</th>
                    <th class='text-center'>LAST LOGIN</th>
                    <th class='text-center'>UPDATED TIME</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container>
                    <!-- this div for ngFor -->
                    <tr>
                      <td>
                        <app-user-info [userInfo]="companyAndUserDetails">
                        </app-user-info>
                      </td>
                      <td>{{companyAndUserDetails?.companyName}}</td>
                      <td>{{companyAndUserDetails?.userStatus}}</td>
                      <td align="center">
                        <app-timestamp [dateAndTime]="companyAndUserDetails?.dateReg"> </app-timestamp>
                      </td>
                      <td align="center">
                        <app-timestamp [dateAndTime]="companyAndUserDetails?.dateLastLogin"> </app-timestamp>
                      </td>
                      <td align="center">
                        <app-timestamp [dateAndTime]="companyAndUserDetails?.updatedTime"> </app-timestamp>
                      </td>
                    </tr>
                  </ng-container>

                </tbody>
              </table>
            </div>
        </div>
      </div>

      <div class="clearfix"></div>

      <app-dashboard-stats></app-dashboard-stats>
    </section>
  </div>
  <app-scroll-top></app-scroll-top>
  
  
   <section>
  <!-- ---Access Modal Pop Up -->
  <div class="modal right " id="access-modal" data-backdrop="static">
			<div class="modal-dialog modal-lg" style="width: 75%;right:0">
				<div class="modal-content">
 			   <ngx-loading [show]="updateFormLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
					<div class="modal-header">
						<button type="button" class="close-circle" data-dismiss="modal">
							<i class="fa fa-times"></i>
						</button>
						<h4 class="modal-title text-center" id="email-template-title">Available Modules</h4>
					</div>
					<div class="modal-body">
						<app-response-message [customResponse]="updateFormCustomResponse" *ngIf="updateFormCustomResponse.isVisible"></app-response-message>
						<div class="portlet-body clearfix">
						<div class="table-responsive" style="overflow-x:inherit">
							<table class="table table-striped  table-hover" style="width:100%">
							  <tr>
							    <th>Email Campaign</th>
							    <td><input type="checkbox" [(ngModel)]="campaignAccess.emailCampaign"></td>
							  </tr>
							  <tr>
							    <th>Video Campaign</th>
							    <td><input type="checkbox" [(ngModel)]="campaignAccess.videoCampaign"></td>
							  </tr>
							  <tr>
							    <th>Social Campaign</th>
							    <td><input type="checkbox" [(ngModel)]="campaignAccess.socialCampaign"></td>
							  </tr>
							  <tr>
							    <th>Event Campaign</th>
							    <td><input type="checkbox" [(ngModel)]="campaignAccess.eventCampaign"></td>
							  </tr>
							  <tr>
							    <th>Leads</th>
							    <td><input type="checkbox" [(ngModel)]="campaignAccess.leads"></td>
							  </tr>
							  <tr>
							    <th>Form Builder</th>
							   <td><input type="checkbox" [(ngModel)]="campaignAccess.formBuilder"></td>
							  </tr>
							   <tr>
							    <th>Page</th>
							   	<td><input type="checkbox" [(ngModel)]="campaignAccess.landingPage"></td>
							  </tr>
							  <tr>
							    <th>Page Campaign</th>
							   	<td><input type="checkbox" [(ngModel)]="campaignAccess.landingPageCampaign"></td>
							  </tr>
							</table>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" (click)="updateAccess()" class="btn btn-info">Update</button>
						<a data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
					</div>
				</div>
			</div>
		</div>
  </section>
</div>
<app-dynamic-email-content #dynamicEmailContentComponent></app-dynamic-email-content>

  <!-- ----------------------Copy Link Modal------------------- -->
  <div class="modal right " id="user-alias-modal" data-backdrop="static">
    <div class="modal-dialog modal-lg" style="width: 75%;right:0">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close-circle" data-dismiss="modal">
            <i class="fa fa-times"></i>
          </button>
          <h4 class="modal-title text-center">ACCOUNT LINK OF USER</h4>
        </div>
        <div class="modal-body">
          <app-response-message [customResponse]="copiedLinkCustomResponse" *ngIf="copiedLinkCustomResponse.isVisible">
          </app-response-message>
          <!-- <input type="text" class="form-control" readonly="readonly" value="{{authenticationService.APP_URL}}axAa/{{userAlias}}" #userAliasId> -->
          <input type="text"  class="form-control" readonly="readonly" value="{{accessAccountVanityURL}}" #userAliasId>
        </div>
        <div class="modal-footer">
          <!-- <a class="btn btn-info" href="{{authenticationService.APP_URL}}f/{{form.alias}}" target="blank">Open in new tab</a> -->
          <a class="btn btn-primary" (click)="copyAliasUrl(userAliasId)">Copy Link</a>
          <a data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
        </div>
      </div>
    </div>
  </div>
</ng-container>



<ng-container *ngIf="!referenceService.loaderFromAdmin">
<div class="page-content ml0">
  <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
  <div class="page-bar">
    <ul class="page-breadcrumb">
      <li>
        <i class="fa fa-home" aria-hidden="true"></i>
        <a (click)="detailsTielsView = false">Admin Report</a>
      </li>
      <li *ngIf="detailsTielsView">
        <i class="fa fa-angle-right" aria-hidden="true"></i>
        <a>Vendor Report</a>
      </li>
    </ul>
  </div>
  <!--Upgrade Account-->
  <div class="page-bar">
    <ul class="page-breadcrumb float-right">
      <li class="topnav-button-css">
        <button class="btn btn-primary" (click)="openUpgradeAccountModal()">
          <span>Upgrade Partner Account</span>
          <i class="fa fa-level-up" aria-hidden="true"></i>
          </button>
    </li>
    </ul>
  </div>

  <div>
    <!--List All Users-->
    <app-list-all-users *ngIf="!detailsTielsView"></app-list-all-users> 
    <!--Demo Requests-->
    <app-demo-request *ngIf="!detailsTielsView"></app-demo-request>
    <!--Top 10 Recent Registered / Loggedin Users-->
	  <section *ngIf="!detailsTielsView">
      <div class="wrap-collabsible">
        <input id="collapsible-recent-users" class="toggle" type="checkbox">
        <label for="collapsible-recent-users" class="lbl-toggle">Top 10 recent registered/logged in users</label>
        <div class="collapsible-content">
          <div>
             <!-- -Top 10 Recent Registered Users -->
            <app-recent-logged-in-users [type]="'registered'" (notifyAdminReportComponent)="selectedVendorDetails($event)"></app-recent-logged-in-users>
            <!-- ---Top 10 Recent LoggedIn Users -->
            <app-recent-logged-in-users [type]="'logged in'" (notifyAdminReportComponent)="selectedVendorDetails($event)"></app-recent-logged-in-users>
          </div>
        </div>
      </div>
    </section>
    <!---Vendor Report-->
    <app-vendor-report *ngIf="!detailsTielsView"></app-vendor-report>
    <div class="col-xs-12" *ngIf="!detailsTielsView">
      <app-list-loader [rowsCount]="12" *ngIf="isListLoading"></app-list-loader>
      <div class="portlet light">
        <div class="portlet-title">
          <div class="caption">Vendor Report</div>
		  <div class="inputs sort-class col-xs-5" style="float: right; margin-top: 2px;">
      <div class="col-xs-6" [ngClass]="{'search-css': !referenceService.isMobileScreenSize(), 'mobile-css':referenceService.isMobileScreenSize() }">
        <select class="form-control SeclectBoxPaddingsAbj" [(ngModel)]="sortOption" (ngModelChange)="sortByOption($event)">
			<ng-container *ngFor="let sort of sortOptions; let i = index">
				<option [ngValue]="sort">{{sort.name}}</option>
			</ng-container>
		</select>
      </div>
      <div class="col-xs-6 portlet-input input-inline search-class" [ngStyle]="{'width':referenceService.isMobileScreenSize()? '100%': 'unset'}">
        <div class="input-icon right" style="width: 230px; margin-left: -22px;">
          <input type="text" [(ngModel)]="searchKey" [ngModelOptions]="{standalone: true}" class="form-control" placeholder="Search"
            (keypress)="eventHandler($event.keyCode)">

          <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="searchKey" (click)="searchKey='';search()"></button>
          <button type="submit" class="search-box-item-click" (click)="search()"><i class="fa fa-search"></i></button>
        </div>
      </div>
    </div>
        </div>
        <div class="portlet-body clearfix">
          <div *ngIf="!isListLoading">
            <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
            <div class="table-responsive" *ngIf="pagination.totalRecords">
              <table class='table tgrid'  aria-describedby="">
                <thead>
                  <tr>
                    <th style="width: 20%;" scope="col">NAME</th>
                    <th class='text-center' scope="col">COMPANY</th>
                    <th class='text-center' scope="col">ROLE</th>
                    <th class='text-center' scope="col">STATUS</th>
                    <th class='text-center' scope="col">REGISTRATION DATE</th>
                    <th class='text-center' scope="col">LAST LOGIN</th>
                    <th class='text-center' scope="col">UPDATED TIME</th>
                    <th class="text-center" scope="col">ACTIONS</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngFor="let report of vendorsDetails;let i = index">
                    <!-- this div for ngFor -->
                    <tr (click)="selectedVendorDetails(report)" class="highletedRow">
                      <td>
                        <app-user-info [userInfo]="report">
                        </app-user-info>
                      </td>
                      <td>{{report.companyName}}</td>
                      <td>
                        <span *ngIf="report.roleId==2">OrgAdmin</span>
                        <span *ngIf="report.roleId==13">Vendor</span>
                        <span *ngIf="report.roleId==20">PRM</span>
                        <span *ngIf="report.roleId==18">Marketing</span>
                      </td>
                      <td>{{report.userStatus}}</td>
                      <td>
                        <app-timestamp [dateAndTime]="report.dateReg"> </app-timestamp>
                      </td>
                      <td>
                        <app-timestamp [dateAndTime]="report.dateLastLogin"> </app-timestamp>
                      </td>
                      <td>
                        <app-timestamp [dateAndTime]="report.updatedTime"> </app-timestamp>
                      </td>
                      <td class="inline-custom-width" (click)="$event.stopPropagation();">
                        <a title="Company profile details" (click)="getVendorCompanyProfile(report)"> 
                          <i class="fa fa-building-o" style="font-size: 20px;" aria-hidden="true"></i>
                        </a>
                        <a  title="My profile details" (click)="getVendorMyProfile(report)"> 
                          <i class="fa fa fa-user-o" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i>
                        </a>
						            <a  title="Send welcome email" (click)="$event.stopPropagation();sendWelcomeEmail(report)"> 
                          <i class="fa fa fa-envelope" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i>
                        </a>
                        <a  title="Copy link" (click)="$event.stopPropagation();openLinkInPopup(report)"> 
                          <i class="fa fa fa-copy" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i>
                        </a>
                        <a  title="Activate/Deactivate" (click)="$event.stopPropagation();activateOrDeactivate(report)"> 
                            <i class="fa fa-universal-access" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i>
                        </a>
                        <a  title="Edit Modules" (click)="$event.stopPropagation();displayModuleAccess(report)"> 
                          <i class="fa fa-pencil-square-o" style="font-size: 20px;margin-left:5px" aria-hidden="true"></i>
                        </a>
                        <a  title="Edit Module Names" (click)="$event.stopPropagation();editModuleNames(report)"> 
                          <i class="fa fa-font" style="font-size: 20px;" aria-hidden="true"></i>
                        </a>
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <app-pagination [pagination]="pagination" [type]="'admin-reports'" (notifyParent)="setPage($event)" (notifyParentDropDown)="onChangeAllContactUsers($event)"></app-pagination>
    </div>
    <!-----------Partner Companies------->
    <app-admin-partner-companies *ngIf="!detailsTielsView"></app-admin-partner-companies>
    <!------Vendor Invitation Reports-->
    <app-vendor-invitation-report *ngIf="!detailsTielsView"></app-vendor-invitation-report>
    <!------Marketing Role Requests-->
    <app-marketing-role-requests *ngIf="!detailsTielsView"></app-marketing-role-requests>
    <app-processing-campaigns [scheduledCampaigns]="false"  *ngIf="!detailsTielsView"></app-processing-campaigns>
    <app-processing-campaigns [scheduledCampaigns]="true" *ngIf="!detailsTielsView"></app-processing-campaigns>
    <app-active-queries *ngIf="!detailsTielsView"></app-active-queries>
    <app-active-threads-info *ngIf="!detailsTielsView"></app-active-threads-info>
    <section *ngIf="detailsTielsView">
      <div class="portlet light">
        <div class="portlet-title">
          <div class="caption">Vendor Report</div>
        </div>
        <div class="portlet-body clearfix">
            <div class="table-responsive">
              <table class='table tgrid' aria-describedby="">
                <thead>
                  <tr>
                    <th style="width: 20%;" scope="col">NAME</th>
                    <th scope="col">COMPANY</th>
                    <th scope="col">STATUS</th>
                    <th class='text-center' scope="col">REGISTRATION DATE</th>
                    <th class='text-center' scope="col">LAST LOGIN</th>
                    <th class='text-center' scope="col">UPDATED TIME</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container>
                    <!-- this div for ngFor -->
                    <tr>
                      <td>
                        <app-user-info [userInfo]="companyAndUserDetails">
                        </app-user-info>
                      </td>
                      <td>{{companyAndUserDetails?.companyName}}</td>
                      <td>{{companyAndUserDetails?.userStatus}}</td>
                      <td>
                        <app-timestamp [dateAndTime]="companyAndUserDetails?.dateReg"> </app-timestamp>
                      </td>
                      <td>
                        <app-timestamp [dateAndTime]="companyAndUserDetails?.dateLastLogin"> </app-timestamp>
                      </td>
                      <td>
                        <app-timestamp [dateAndTime]="companyAndUserDetails?.updatedTime"> </app-timestamp>
                      </td>
                    </tr>
                  </ng-container>

                </tbody>
              </table>
            </div>
        </div>
      </div>
      <div class="clearfix"></div>
      <app-dashboard-stats></app-dashboard-stats>
    </section>
  </div>
  <app-scroll-top></app-scroll-top>
  
  
   <section>
    <!-- ---Access Modal Pop Up -->
    <div class="modal right " id="access-modal" data-backdrop="static">
        <div class="modal-dialog modal-lg" style="width: 75%;right:0">
          <div class="modal-content">
          <ngx-loading [show]="updateFormLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
            <div class="modal-header">
              <button type="button" class="close-circle" data-dismiss="modal">
                <i class="fa fa-times"></i>
              </button>
              <h4 class="modal-title text-center" id="email-template-title">Available Modules</h4>
            </div>
            <div class="modal-body">
              <app-response-message [customResponse]="updateFormCustomResponse" *ngIf="updateFormCustomResponse.isVisible"></app-response-message>
              <div class="portlet-body clearfix">
              <div class="table-responsive" style="overflow-x:inherit">
                <table class="table table-striped  table-hover" style="width:100%">
                  <tr>
                    <th>Email Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.emailCampaign"></td>
                  </tr>
                  <tr>
                    <th>Video Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.videoCampaign"></td>
                  </tr>
                  <tr>
                    <th>Social Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.socialCampaign"></td>
                  </tr>
                  <tr>
                    <th>Event Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.eventCampaign"></td>
                  </tr>
                  <tr>
                    <th>Leads</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.leads"></td>
                  </tr>
                  <tr>
                    <th>Form Builder</th>
                  <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.formBuilder"></td>
                  </tr>
                  <tr>
                    <th>Page</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.landingPage"></td>
                  </tr>
                  <tr>
                    <th>Page Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.landingPageCampaign"></td>
                  </tr>
                </table>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" (click)="updateAccess()" class="btn btn-info">Update</button>
              <a data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
            </div>
          </div>
        </div>
    </div>
  </section>
</div>
<app-dynamic-email-content #dynamicEmailContentComponent></app-dynamic-email-content>

  <!-- ----------------------Copy Link Modal------------------- -->
  <div class="modal fade right " id="user-alias-modal" data-backdrop="static">
    <div class="modal-dialog modal-lg" style="width: 75%;right:0">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close-circle" data-dismiss="modal">
            <i class="fa fa-times" aria-hidden="true"></i>
          </button>
          <h4 class="modal-title text-center">ACCOUNT LINK OF USER</h4>
        </div>
        <div class="modal-body">
          <app-response-message [customResponse]="copiedLinkCustomResponse" *ngIf="copiedLinkCustomResponse.isVisible">
          </app-response-message>
          <input type="text"  class="form-control" readonly="readonly" value="{{accessAccountVanityURL}}" #userAliasId>
        </div>
        <div class="modal-footer">
          <a class="btn btn-primary" (click)="copyAliasUrl(userAliasId)">Copy Link</a>
          <a data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
        </div>
      </div>
    </div>
  </div>
</ng-container>

<!-- ---------------------Upgrade Account------------------ -->
<div class="modal fade right" id="upgrade-account-modal" data-backdrop="static">
  <div class="modal-dialog full-width">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title text-center">Upgrade Account</h4>
        <div class="table-responsive">
          <table class='table tgrid table-bordered' aria-describedby="">
            <thead>
              <tr>
                <th style="width: 10%;" scope="row">Enter Email</th>
                <th scope="row" style="width: 50%;">
                  <input type="email" class="form-control" placeholder="Enter Email" autocomplete="off" [(ngModel)]="emailId"
                   [ngModelOptions]="{standalone: true}" (keypress)="upgradeAccountOnKeyPress($event.keyCode)">
                  <span *ngIf="!validEmailId" class="required"><strong>Please Enter Email</strong></span>
                </th>
                  <th scope="row">
                    <button [disabled]="upgradeAccountLoader" class="btn btn-primary" (click)="findCompanyInfo()">Search</button>
                    <button (click)="closeUpgradeAccountModal()" [disabled]="upgradeAccountLoader" class="btn btn-danger float-right">Close</button>
                  </th>
                </tr>
            </thead>
          </table>
        </div>
      </div>
      <div class="modal-body">
        <app-response-message [showCloseIcon]="false" [customResponse]="upgradeAccountResponse" *ngIf="upgradeAccountResponse?.isVisible"></app-response-message>
        <app-modal-popup-loader *ngIf="upgradeAccountLoader"></app-modal-popup-loader>
        <div *ngIf="!upgradeAccountLoader && (upgradeAccountStatusCode==200 || upgradeAccountStatusCode==400)">
          <!--Company Info--->
          <div class="table-responsive">
              <table class='table tgrid' aria-describedby="">
                <thead>
                  <tr>
                  <th>Company Name</th>
                  <th class="text-center">Company Profile Name</th>
                  <th class="text-center">Company Type</th>
                  <th *ngIf="upgradeAccountStatusCode==200" class="text-center">Upgrade Account</th>
                </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{{companyInfo?.companyName}}</td>
                    <td class="text-center">{{companyInfo?.companyProfileName}}</td>
                    <td [className]="companyInfo?.companyType=='Partner' && upgradeAccountStatusCode==200 ? 'text-center success':'text-center info'">
                      <strong>{{companyInfo?.companyType}}</strong></td>
                    <td class="text-center" *ngIf="upgradeAccountStatusCode==200"> 
                      <select id="upgrade-account-type" class="form-control" *ngIf="companyInfo?.companyType=='Partner'" (change)="upgradeAccountType()">
                        <option value="0">--Please Select Option--</option>
                        <option value="20">PRM</option>
                        <option value="18">Marketing</option>
                        <option value="13">Vendor</option>
                        <option value="2">Org Admin</option>
                      </select>
                      <strong class="required" *ngIf="companyInfo?.companyType!='Partner'">Upgrade Option Available Only For Partner Accounts.</strong>
                    </td>
                  </tr>
                </tbody>
              </table>
          </div>
          
          <!----Admins And Team Members----->
          <div class="table-responsive" *ngIf="adminsAndTeamMembers?.length>0">
            <table class="table tgrid table-bordered"  aria-describedby="">
              <thead>
                <th>
                  <h4  translate>
                    <img src="../../../assets/images/user-permission.png" alt="No Image Found">
                    Admins & Team Members {{adminAndTeamMembers?.length}}
                </h4>
                </th>
                <th class="text-center">
                  <i class="fa fa-user" aria-hidden="true"></i><br>Admin
                </th>
                <th class="text-center">
                  <i class="fa fa-lock" aria-hidden="true"></i><br>Status
                </th>
              </thead>
              <tbody>
                <tr *ngFor="let adminOrTeamMember of adminsAndTeamMembers;let i=index">
                  <td>
                    <app-user-info [isPartnerEntityInfo]="true" [userInfo]="adminOrTeamMember"></app-user-info>
                    <span class="active-status" *ngIf="adminOrTeamMember?.primaryAdmin">
                      <strong>Primary Admin:<i class="fa fa-check active-status"></i></strong>
                    </span>
                  </td>
                  <!---Second Admin---->
                  <td class="text-center">
                    <div class="actions-block float-none">
                      <i  [className]="adminOrTeamMember?.secondAdmin || adminOrTeamMember?.primaryAdmin ? 'fa fa-check active-status':'fa fa-times required'" aria-hidden="true"></i >
                    </div>
                  </td>
                  <!---Enabled/Disabled---->
                  <td class="text-center" *ngIf="adminOrTeamMember?.status=='UNAPPROVED'" [title]="adminOrTeamMember?.status=='UNAPPROVED'? 'This team member account is not activated yet':'Enable/Disable team member'">
                    <div class="actions-block float-none">
                      <i class="fa fa-times required" aria-hidden="true"></i>
                    </div>
                  </td>
                  <td class="text-center" *ngIf="adminOrTeamMember?.status!='UNAPPROVED' && adminOrTeamMember?.status!='DECLINE'">
                  <div class="actions-block float-none">
                      <i class="fa fa-check active-status" aria-hidden="true"></i>
                    </div>
                  </td>
                  <td class="text-center" *ngIf="adminOrTeamMember?.status=='DECLINE'" title="This team member is inactive">
                    <div class="actions-block float-none">
                      <i class="fa fa-times required" aria-hidden="true"></i>
                    </div>
                  </td>
                  <!---Enabled/Disabled---->
                </tr>
              </tbody>
            </table>
          </div>

          

        </div>
      </div>
    </div>
  </div>
</div>



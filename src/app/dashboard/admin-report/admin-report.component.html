<ng-container *ngIf="!referenceService.loaderFromAdmin">
<div class="page-content ml0">
  <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
  <div class="page-bar">
    <ul class="page-breadcrumb">
      <li>
        <i class="fa fa-home" aria-hidden="true"></i>
        <a (click)="detailsTielsView = false">Admin Report</a>
      </li>
    </ul>
  </div>

 <ng-container *ngIf="!isVanityUrlEnabled">
  <div class="page-bar">
    <ul class="page-breadcrumb float-right">
      <!--Merge Partner Companies- XNFR-564-->
      <li class="mt10 uppercase-text">
        <button type="button" class="btn btn-danger" (click)="goToMergePartnerCompanies()"><span class="mr10">Merge Partner Companies</span><i class="fa fa-handshake" aria-hidden="true"></i></button>
      </li>
      <!--Integration Details-->
      <li class="mt10 uppercase-text">
        <button class="btn btn-primary" (click)="openIntegrationDetailsModalPopup()"><span>Find Integration Details</span></button>
      </li>
      <!--Update Email Address-->
      <li class="mt10 uppercase-text">
        <button class="btn btn-primary" (click)="openUpdateEmailAddressModalPopup()"><span>Update Email Address</span></button>
      </li>
       <!--Find Account Details-->
       <li class="mt10 uppercase-text">
        <button class="btn btn-primary" (click)="openFindUserOrCompanyDetailsModalPopup()"><span>Find Account Details</span></button>
      </li>
      <!--Upgrade Account-->
      <li class="mt10 uppercase-text">
        <button class="btn btn-primary" (click)="openUpgradeAccountModal()"><span>Upgrade Account</span><i class="fa fa-level-up" aria-hidden="true"></i></button>
      </li>
      <!--Create An Account-->
      <li class="mt10 uppercase-text">
          <button class="btn btn-primary" (click)="createNewAccount()"><span>Create An Account</span><i class="fa fa-user" aria-hidden="true"></i></button>
      </li>
    </ul>
  </div>
  <div class="page-bar">
    <ul class="page-breadcrumb">
       <!--Approved Users-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#all-approved-users', name:SUPER_ADMIN_MODULE_CONTSTANTS.allApprovedUsers}"></ng-template>
      <!--Vendor Report-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#vendor-report', name:SUPER_ADMIN_MODULE_CONTSTANTS.vendorReport}"></ng-template>
      <!--Processing User Lists-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#processing-user-lists', name:SUPER_ADMIN_MODULE_CONTSTANTS.processingUserLists}"></ng-template>
      <!--Demo Requests-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#demo-requests', name:SUPER_ADMIN_MODULE_CONTSTANTS.demoRequests}"></ng-template>
      <!--MDF Account Requests-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#mdf-account-requests', name:SUPER_ADMIN_MODULE_CONTSTANTS.mdfAccountRequests}"></ng-template>
      <!--Top 10-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#top10-registered-and-logged-in-users', name:SUPER_ADMIN_MODULE_CONTSTANTS.top10recentRegisteredAndLoggedInUsers}"></ng-template>
      <!--Partner Companies-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#partner-companies', name:SUPER_ADMIN_MODULE_CONTSTANTS.partnerCompanies}"></ng-template>
      <!--Vendor Invitation Reports-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#vendor-invitation-reports', name:SUPER_ADMIN_MODULE_CONTSTANTS.vendorInvitationReports}"></ng-template>
      <!--Marketing Requests-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#marketing-requests', name:SUPER_ADMIN_MODULE_CONTSTANTS.marketingRequests}"></ng-template>
      <!--Processing Campaigns-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#processing-campaigns', name:SUPER_ADMIN_MODULE_CONTSTANTS.processingCampaigns}"></ng-template>
      <!--Scheduled Campaigns-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#scheduling-campaigns', name:SUPER_ADMIN_MODULE_CONTSTANTS.scheduledCampaigns}"></ng-template>
      <!--Active Queries-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#active-queries', name:SUPER_ADMIN_MODULE_CONTSTANTS.activeQueries}"></ng-template>
      <!--Upload GlassMorphism Images-->
      <ng-template [ngTemplateOutlet]="listItemTemplateButton" [ngTemplateOutletContext]="{id:'#upload-default-glassmorphism-images', name:SUPER_ADMIN_MODULE_CONTSTANTS.uploadDefaultGlassMorphismImages}"></ng-template>
    </ul>
  </div>
  <div>
    <button class="btn btn-success full-width uppercase-text" (click)="expandOrCollpase()"><span>Expand / Collapse All</span></button>
    <!--List All Users-->
    <app-list-all-users></app-list-all-users>
     <!---Vendor Report-->
     <app-vendor-report></app-vendor-report>
    <!--Processing User Lists-->
    <app-processing-user-lists></app-processing-user-lists>
    <!--Demo Requests-->
    <app-demo-request [filterType]="SUPER_ADMIN_MODULE_CONTSTANTS.demoRequests"></app-demo-request>
    <!--MDF Account Requests-->
    <app-demo-request [filterType]="SUPER_ADMIN_MODULE_CONTSTANTS.mdfAccountRequests"></app-demo-request>
    <!--Top 10 Recent Registered / Loggedin Users-->
	  <section>
      <div class="wrap-collabsible" id="top10-registered-and-logged-in-users">
        <input id="collapsible-recent-users" name="collapsibleCheckBox" class="toggle" type="checkbox" checked>
        <label for="collapsible-recent-users" name="collapsibleCheckBox" class="lbl-toggle">Top 10 recent registered/logged in users</label>
        <div class="collapsible-content">
          <div>
             <!-- -Top 10 Recent Registered Users -->
            <app-recent-logged-in-users [type]="'registered'" (notifyAdminReportComponent)="selectedVendorDetails($event)"></app-recent-logged-in-users>
            <!-- ---Top 10 Recent LoggedIn Users -->
            <app-recent-logged-in-users [type]="'logged in'" (notifyAdminReportComponent)="selectedVendorDetails($event)"></app-recent-logged-in-users>
          </div>
        </div>
      </div>
    </section>
    <!-----------Partner Companies------->
    <app-admin-partner-companies></app-admin-partner-companies>
    <!------Vendor Invitation Reports-->
    <app-vendor-invitation-report></app-vendor-invitation-report>
    <!------Marketing Role Requests-->
    <app-marketing-role-requests></app-marketing-role-requests>
    <!------Active Queries-->
    <app-active-queries></app-active-queries>
    <!------Active Threads Info-->
    <app-active-threads-info></app-active-threads-info>
    <!--Support Account Users---->
    <app-support-account-users></app-support-account-users>
  </div>
</ng-container>

<!--Vanity Url Login-->
  <div *ngIf="isVanityUrlEnabled">
     <!--List All Users For Logged In Vendor Vanity-->
     <app-list-all-users></app-list-all-users>
     <!--List All Partners For Logged In Vendor Vanity-->
     <app-list-all-users [showPartners]="true"></app-list-all-users>
  </div>
      <!-- Add Background Image OF GlassMorphism Light and Dark Start-->
<section>
  <div class="wrap-collabsible" id="upload-default-glassmorphism-images">
    <input id="collapsible-upload-image" name="collapsibleCheckBox" class="toggle" type="checkbox" checked>
    <label for="collapsible-upload-image" name="collapsibleCheckBox" class="lbl-toggle">Upload Default GlassMorphism Images</label>
    <div class="collapsible-content">
      <div class="row">
       <app-background-image-upload [type]="'GLASSMORPHISMLIGHT'"></app-background-image-upload>
       <app-background-image-upload [type]="'GLASSMORPHISMDARK'"></app-background-image-upload>
      </div>
    </div>
  </div>
</section>
<!-- Add Background Image OF GlassMorphism Light and Dark end-->

  <app-scroll-top></app-scroll-top>
   <section>
    <!-- ---Access Modal Pop Up -->
    <div class="modal right " id="access-modal" data-backdrop="static">
        <div class="modal-dialog modal-lg" style="width: 75%;right:0">
          <div class="modal-content">
          <ngx-loading [show]="updateFormLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
            <div class="modal-header">
              <button type="button" class="close-circle" data-dismiss="modal">
                <i class="fa fa-times"></i>
              </button>
              <h4 class="modal-title text-center" id="email-template-title">Available Modules</h4>
            </div>
            <div class="modal-body">
              <app-response-message [customResponse]="updateFormCustomResponse" *ngIf="updateFormCustomResponse.isVisible"></app-response-message>
              <div class="portlet-body clearfix">
              <div class="table-responsive" style="overflow-x:inherit">
                <table class="table table-striped  table-hover" style="width:100%">
                  <tr>
                    <th>Email Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.emailCampaign"></td>
                  </tr>
                  <tr>
                    <th>Video Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.videoCampaign"></td>
                  </tr>
                  <tr>
                    <th>Social Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.socialCampaign"></td>
                  </tr>
                  <tr>
                    <th>Event Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.eventCampaign"></td>
                  </tr>
                  <tr>
                    <th>Leads</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.leads"></td>
                  </tr>
                  <tr>
                    <th>Form Builder</th>
                  <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.formBuilder"></td>
                  </tr>
                  <tr>
                    <th>Page</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.landingPage"></td>
                  </tr>
                  <tr>
                    <th>Page Campaign</th>
                    <td><input class="checkBox_shadow" type="checkbox" [(ngModel)]="campaignAccess.landingPageCampaign"></td>
                  </tr>
                </table>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" (click)="updateAccess()" class="btn btn-info">Update</button>
              <a data-dismiss="modal" class="btn btn-default" style="float: right">Close</a>
            </div>
          </div>
        </div>
    </div>
  </section>
</div>
<app-dynamic-email-content #dynamicEmailContentComponent></app-dynamic-email-content>

</ng-container>

<!-- ---------------------Upgrade Account/Find User Or Company Details------------------ -->
<div class="modal fade right" id="upgrade-account-modal" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog full-width">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title text-center">{{upgradeAccountOrFindUserOrCompanyDetailsHeader}}</h4>
      </div>
      <div class="modal-body" id="">
        <table class='table tgrid table-bordered' aria-describedby="">
          <thead>
            <!--Enter Email-->
            <tr *ngIf="isUpgradeAccountOptionClicked">
              <th scope="row">Enter Email</th>
              <th scope="row">
                <input type="email" class="form-control" placeholder="Enter Email" autocomplete="off" [(ngModel)]="emailId" (input)="emailId = emailId.toLowerCase()"
                 [ngModelOptions]="{standalone: true}" (keypress)="upgradeAccountOnKeyPress($event.keyCode)" >
                <span *ngIf="!validEmailId" class="required"><strong>Please Enter Email</strong></span>
              </th>
            </tr>
            <ng-container *ngIf="isFindUserOrCompanyDetailsOptionClicked">
              <tr>
                <th scope="row">Select Type</th>
                <th scope="row">
                  <select (ngModelChange)="setFilterType($event)" class="form-control" id="companyIdOrUserId" name="companyIdOrUserId" [(ngModel)]="accountDetailsDto.filterType">
                    <option value="userId">User Id</option>
                    <option value="companyId">Company Id</option>
                    <option value="email">Email Id</option>
                  </select>
                </th>
              </tr>
               <tr>
                <th scope="row">Enter {{accountDetailsDto?.labelName}}</th>
                <th scope="row" *ngIf="accountDetailsDto?.filterType=='userId' || accountDetailsDto?.filterType=='companyId'">
                  <input  type="number" class="form-control" placeholder="Enter Number" min="1" autocomplete="off"
                   [(ngModel)]="accountDetailsDto.companyIdOrUserId">
                  <span *ngIf="!validCompanyOrUserId" class="required"><strong>Please Enter Valid {{accountDetailsDto?.labelName}}</strong></span>
                </th>
                <th scope="row" *ngIf="accountDetailsDto?.filterType=='email'">
                  <input type="email" class="form-control"  placeholder="Enter Email" autocomplete="off" 
                  [(ngModel)]="accountDetailsDto.emailId" (input)="accountDetailsDto.emailId = accountDetailsDto.emailId.toLowerCase()"
                  (keypress)="findCompanyInfoOnKeyPress($event.keyCode)"
                  [ngModelOptions]="{standalone: true}">
                  <span *ngIf="!validEmailId" class="required"><strong>Please Enter Email</strong></span>
                </th>
              </tr>
            </ng-container>

            <tr>
              <th></th>
                <th scope="row">
                  <button (click)="closeUpgradeAccountModal()" [disabled]="upgradeAccountLoader" class="btn btn-danger float-right">Close</button>
                  <button [disabled]="upgradeAccountLoader" class="btn btn-primary float-right" (click)="findCompanyInfo()">Search</button>
                </th>
            </tr>
          </thead>
        </table>
        <app-response-message [showCloseIcon]="false" [customResponse]="upgradeAccountResponse" *ngIf="upgradeAccountResponse?.isVisible"></app-response-message>
        <app-modal-popup-loader *ngIf="upgradeAccountLoader"></app-modal-popup-loader>
        <div *ngIf="!upgradeAccountLoader && (upgradeAccountStatusCode==200 || upgradeAccountStatusCode==400)">
          <!--Company Info--->
          <div class="table-responsive">
              <table class='table tgrid' aria-describedby="">
                <thead>
                  <tr>
                  <th>Company Name</th>
                  <th class="text-center">Vanity Url Link</th>
                  <th class="text-center">Company Profile Name</th>
                  <th class="text-center">Company Type</th>
                  <th *ngIf="upgradeAccountStatusCode==200 && isUpgradeAccountOptionClicked" class="text-center">Upgrade Account</th>
                </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{{companyInfo?.companyName}}</td>
                    <td class="pointer" class="text-center"><a href="{{companyInfo?.vanityUrl}}" target="_blank" rel="noopener">Click Here</a></td>
                    <td class="text-center">{{companyInfo?.companyProfileName}}</td>
                    <td [className]="(companyInfo?.companyType=='Partner'||companyInfo?.companyType=='Vendor') && upgradeAccountStatusCode==200 ? 'text-center success':'text-center info'">
                      <strong>{{companyInfo?.companyType}}</strong></td>
                    <td class="text-center" *ngIf="upgradeAccountStatusCode==200 && isUpgradeAccountOptionClicked">
                      <!--Upgrading Partner Account-->
                      <select id="upgrade-account-type" class="form-control" *ngIf="companyInfo?.companyType=='Partner'" (change)="upgradeAccountType()">
                        <option value="0">--Please Select Option--</option>
                        <option value="20">PRM</option>
                        <option value="18">Marketing</option>
                        <option value="13">Vendor</option>
                        <option value="2">Org Admin</option>
                      </select>
                      <!--Upgrading Vendor To OrgAdmin-->
                      <select id="upgrade-account-type" class="form-control" *ngIf="companyInfo?.companyType=='Vendor'" (change)="upgradeAccountType()">
                        <option value="0">--Please Select Option--</option>
                        <option value="2">Org Admin</option>
                      </select>
                      <strong class="required" *ngIf="companyInfo?.companyType!='Partner' && companyInfo?.companyType!='Vendor' ">Upgrade Option Available Only For Partner / Vendor Accounts.</strong>
                    </td>
                  </tr>
                </tbody>
              </table>
          </div>

          <!----Admins And Team Members----->
          <div class="table-responsive" *ngIf="adminsAndTeamMembers?.length>0">
            <table class="table tgrid table-bordered"  aria-describedby="">
              <thead>
                <th>
                  <h4>
                    <img src="../../../assets/images/user-permission.png" alt="No Image Found">
                    Admins & Team Members {{adminAndTeamMembers?.length}}
                </h4>
                </th>
                <th class="text-center">
                  <i class="fa fa-user" aria-hidden="true"></i><br>Admin
                </th>
                <th class="text-center">
                  <i class="fa fa-lock" aria-hidden="true"></i><br>Status
                </th>
                <th class="text-center">
                  <i class="fa fa-sign-in" aria-hidden="true"></i><br>Login As
                </th>
              </thead>
              <tbody>
                <tr *ngFor="let adminOrTeamMember of adminsAndTeamMembers;let i=index"
                 [ngClass]="((isUpgradeAccountOptionClicked && emailId==adminOrTeamMember?.emailId)
                   || (isFindUserOrCompanyDetailsOptionClicked && (accountDetailsDto?.filterType=='userId'
                       && accountDetailsDto?.companyIdOrUserId==adminOrTeamMember?.teamMemberUserId) ||
                        ( accountDetailsDto?.filterType=='email' && accountDetailsDto?.emailId==adminOrTeamMember?.emailId))) ? 'searched-result':''">
                  <td>
                    <app-user-info [isPartnerEntityInfo]="true" [userInfo]="adminOrTeamMember"></app-user-info>
                    <span class="active-status" *ngIf="adminOrTeamMember?.primaryAdmin">
                      <strong>Primary Admin:<i class="fa fa-check active-status"></i></strong>
                    </span>
                  </td>
                  <!---Second Admin---->
                  <td class="text-center">
                    <div class="actions-block float-none">
                      <i  [className]="adminOrTeamMember?.secondAdmin || adminOrTeamMember?.primaryAdmin ? 'fa fa-check active-status':'fa fa-times required'" aria-hidden="true"></i >
                    </div>
                  </td>
                  <!---Enabled/Disabled---->
                  <td class="text-center" *ngIf="adminOrTeamMember?.status=='UNAPPROVED'" [title]="adminOrTeamMember?.status=='UNAPPROVED'? 'This team member account is not activated yet':'Enable/Disable team member'">
                    <div class="actions-block float-none">
                      <i class="fa fa-times required" aria-hidden="true"></i>
                    </div>
                  </td>
                  <td class="text-center" *ngIf="adminOrTeamMember?.status!='UNAPPROVED' && adminOrTeamMember?.status!='DECLINE'">
                  <div class="actions-block float-none">
                      <i class="fa fa-check active-status" aria-hidden="true"></i>
                    </div>
                  </td>
                  <td class="text-center" *ngIf="adminOrTeamMember?.status=='DECLINE'" title="This team member account is declined by admin.">
                    <div class="actions-block float-none">
                      <i class="fa fa-times required" aria-hidden="true"></i>
                    </div>
                  </td>
                  <!--Login As-->
                  <td class="text-center">
                    <div class="actions-block float-none">
                      <a (click)="loginAs(adminOrTeamMember)"><i class="fa fa-sign-in" aria-hidden="true"></i></a>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--Update Password-->
<app-update-password #updatePasswordComponent></app-update-password>

<!--Update Email Address-->
<app-update-email-address #updateEmailAddressComponent></app-update-email-address>

<!--Find Integration Details-->
<app-integration-details #integrationDetailsComponent></app-integration-details>

<ng-template #listItemTemplateButton let-id="id" let-name="name">
  <li class="mt10">
    <button  [scrollTo]="id" [scrollDuration]="1000" [scrollOffset]="-100" class="btn btn-success uppercase-text">
      <span>{{name}}</span><i class="fa fa-caret-down"></i>
    </button>
  </li>
</ng-template>

  <!-- Group Preview Popup -->
  <app-team-member-group-preview-popup *ngIf="isPreviewRolesButtonClicked" [modulesFromUpgradeAccountModal]="modules"
    (previewGroupPopupEventEmitter)="isPreviewRolesButtonClicked=false"></app-team-member-group-preview-popup>
  <!-- End of  Group Preview Popup -->

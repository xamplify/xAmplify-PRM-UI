

<!-- <iframe [src]="safeUrl" frameborder="0"></iframe> -->
<iframe #chartFrame [src]="safeUrl" width="100%" height="600" frameborder="0"></iframe>
<!-- <div class="summary-container" #reportContent id="reportContent">
  <header class="summary-header" *ngIf="reportData">
    <h1> {{ reportData.header }}</h1> -->
    <!-- <p class="subtitle">Contact: {{ reportData.contact_details.name }}</p> -->
  <!-- </header> -->

  <!-- <main class="summary-main" *ngIf="reportData"> -->
    <!-- Contact Details -->
    <!-- <section class="card">
      <h2 class="section-title">Contact Details</h2>
      <div class="contact-card-custom">
        <div class="contact-item">
          <strong class="contact-label">Name:</strong> {{ reportData.contact_details.name }}
        </div>
        <div class="contact-item">
          <strong class="contact-label">Email:</strong>
          <a [href]="'mailto:' + reportData.contact_details.email" class="link">{{ reportData.contact_details.email }}</a>
        </div>
        <div class="contact-item">
          <strong class="contact-label">Company:</strong> {{ reportData.contact_details.company }}
        </div>
        <div class="contact-item">
          <strong class="contact-label">Phone Numbers:</strong>
          <ul class="contact-phone-list">
            <li *ngFor="let phone of reportData.contact_details.phone_numbers">{{ phone }}</li>
          </ul>
        </div>
        <div class="contact-item">
          <strong class="contact-label">Address:</strong> {{ reportData.contact_details.address }}
        </div>
        <div class="contact-item">
          <strong class="contact-label">Additional Info:</strong> {{ reportData.contact_details.additional_info }}
        </div>
      </div>
    </section> -->

    <!-- Charts Overview -->
    <!-- <div class="charts-grid">
      <section class="card">
        <h2 class="section-title">Leads Overview</h2>
        <p class="summary-text">{{ reportData.leads.summary }}</p>
        <h3 class="chart-title">Leads by Pipeline Stage</h3>
        <div class="chart-container"> -->
          <!-- <canvas #leadPipelineChartCanvas id="leadPipelineChartCanvas"></canvas> -->
          <!-- <canvas #leadPipelineChartCanvas></canvas>
        </div>
      </section>
      <section class="card">
        <h2 class="section-title">Deals Analysis</h2>
        <p class="summary-text">{{ reportData.deals.summary }}</p>
        <h3 class="chart-title">Deals by Amount</h3>
        <div class="chart-container"> -->
          <!-- <canvas #dealAmountBarChartCanvas id="dealAmountBarChartCanvas"></canvas> -->
          <!-- <canvas #dealAmountBarChartCanvas id="dealAmountBarChartCanvas"></canvas>

        </div>
      </section>
    </div>
    
    <section class="card">
      <h2 class="section-title">Campaign Engagement</h2>
      <p class="summary-text">{{ reportData.campaigns.summary }}</p>
      <h3 class="chart-title">Campaigns by Type</h3>
      <div class="chart-container"> -->
        <!-- <canvas #campaignTypePieChartCanvas id="campaignTypePieChartCanvas"></canvas> -->
        <!-- <canvas #campaignTypePieChartCanvas></canvas>
      </div>
    </section> -->

    <!-- Lead Records -->
    <!-- <section class="card">
      <h2 class="section-title">Lead Records</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Company</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Campaign</th>
              <th>Created</th>
              <th>Stage</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let lead of reportData.leads.lead_records">
              <td>{{ lead.id }}</td>
              <td>{{ lead.first_name || '' }} {{ lead.last_name }}</td>
              <td>{{ lead.company }}</td>
              <td>{{ lead.email }}</td>
              <td>{{ lead.phone || 'N/A' }}</td>
              <td>{{ lead.campaign }}</td>
              <td>{{ formatDisplayDate(lead.created_time) }}</td>
              <td>
                <span class="badge badge-lead">{{ lead.pipeline_stage }}</span>
              </td>
            </tr>
            <tr *ngIf="reportData.leads.lead_records.length === 0">
              <td colspan="8" class="empty-table-message">No lead records found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section> -->

    <!-- Deal Records -->
    <!-- <section class="card">
      <h2 class="section-title">Deal Records</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Title</th>
              <th>Amount</th>
              <th>Close Date</th>
              <th>Campaign</th>
              <th>Pipeline</th>
              <th>Stage</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let deal of reportData.deals.deal_records">
              <td>{{ deal.title }}</td>
              <td class="font-medium">{{ formatDisplayCurrency(deal.amount) }}</td>
              <td>{{ formatDisplayDate(deal.close_date) }}</td>
              <td>{{ deal.campaign }}</td>
              <td>{{ deal.pipeline }}</td>
              <td>
                <span class="badge badge-deal">{{ deal.stage }}</span>
              </td>
            </tr>
             <tr *ngIf="reportData.deals.deal_records.length === 0">
              <td colspan="6" class="empty-table-message">No deal records found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section> -->

    <!-- Campaign Records -->
    <!-- <section class="card">
      <h2 class="section-title">Campaign Records</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Launch Time</th>
              <th>Associated With</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let campaign of reportData.campaigns.campaign_records">
              <td>{{ campaign.name }}</td>
              <td>
                <span class="badge"
                      [class.badge-campaign-regular]="campaign.campaign_type === 'REGULAR'"
                      [class.badge-campaign-video]="campaign.campaign_type === 'VIDEO'"
                      [class.badge-campaign-event]="campaign.campaign_type === 'EVENT'"
                      [class.badge-campaign-default]="!['REGULAR', 'VIDEO', 'EVENT'].includes(campaign.campaign_type)">
                  {{ campaign.campaign_type }}
                </span>
              </td>
              <td>{{ formatDisplayDate(campaign.launch_time) }}</td>
              <td>{{ campaign.associated_with }}</td>
              <td>{{ campaign.details }}</td>
            </tr>
            <tr *ngIf="reportData.campaigns.campaign_records.length === 0">
              <td colspan="5" class="empty-table-message">No campaign records found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section> -->

    <!-- Key Takeaways & Strategic Recommendations -->
    <!-- <div class="key-info-grid">
      <section class="card">
        <h2 class="section-title">Key Takeaways</h2>
        <ul class="info-list">
          <li *ngFor="let takeaway of reportData.key_takeaways" class="info-list-item">
            <span class="list-icon list-icon-takeaway">âœ“</span>
            <span>{{ takeaway }}</span>
          </li>
        </ul>
      </section>

      <section class="card">
        <h2 class="section-title">Strategic Recommendations</h2>
        <ul class="info-list">
          <li *ngFor="let recommendation of reportData.strategic_recommendations" class="info-list-item">
            <span class="list-icon list-icon-recommendation">ðŸ’¡</span>
            <span>{{ recommendation }}</span>
          </li>
        </ul>
      </section>
    </div>
  </main>

  <footer class="summary-footer">
    <p>&copy; {{ currentYear }} Executive Report. All rights reserved.</p>
  </footer>
</div> -->

<!-- <div id="pdfContainer" #pdfContainer
     [style.display]="showPdf ? 'block' : 'none'"
     style="position: fixed; top: 0; left: 0; width: 100vw; height: auto; z-index: 9999; background: white; overflow: visible;">
  <header class="summary-header" *ngIf="reportData">
    <h1> {{ reportData.header }}</h1> -->
    <!-- <p class="subtitle">Contact: {{ reportData.contact_details.name }}</p> -->
  <!-- </header> -->

  <!-- <main class="summary-main" *ngIf="reportData"> -->
    <!-- Contact Details -->
    <!-- <section class="card">
      <h2 class="section-title">Contact Details</h2>
      <div class="contact-card-custom">
        <div class="contact-item">
          <strong class="contact-label">Name:</strong> {{ reportData.contact_details.name }}
        </div>
        <div class="contact-item">
          <strong class="contact-label">Email:</strong>
          <a [href]="'mailto:' + reportData.contact_details.email" class="link">{{ reportData.contact_details.email }}</a>
        </div>
        <div class="contact-item">
          <strong class="contact-label">Company:</strong> {{ reportData.contact_details.company }}
        </div>
        <div class="contact-item">
          <strong class="contact-label">Phone Numbers:</strong>
          <ul class="contact-phone-list">
            <li *ngFor="let phone of reportData.contact_details.phone_numbers">{{ phone }}</li>
          </ul>
        </div>
        <div class="contact-item">
          <strong class="contact-label">Address:</strong> {{ reportData.contact_details.address }}
        </div>
        <div class="contact-item">
          <strong class="contact-label">Additional Info:</strong> {{ reportData.contact_details.additional_info }}
        </div>
      </div>
    </section> -->

    <!-- Charts Overview -->
    <!-- <div class="charts-grid">
      <section class="card">
        <h2 class="section-title">Leads Overview</h2>
        <p class="summary-text">{{ reportData.leads.summary }}</p>
        <h3 class="chart-title">Leads by Pipeline Stage</h3>
        <div class="chart-container"> -->
          <!-- <canvas #leadPipelineChartCanvas id="leadPipelineChartCanvas"></canvas> -->
          <!-- <canvas #leadPipelineChartCanvas></canvas>
        </div>
      </section>
      <section class="card">
        <h2 class="section-title">Deals Analysis</h2>
        <p class="summary-text">{{ reportData.deals.summary }}</p>
        <h3 class="chart-title">Deals by Amount</h3>
        <div class="chart-container">  -->
          <!-- <canvas #dealAmountBarChartCanvas id="dealAmountBarChartCanvas"></canvas> -->
          <!-- <canvas #dealAmountBarChartCanvas></canvas>

        </div>
      </section>
    </div> -->
    
    <!-- <section class="card">
      <h2 class="section-title">Campaign Engagement</h2>
      <p class="summary-text">{{ reportData.campaigns.summary }}</p>
      <h3 class="chart-title">Campaigns by Type</h3>
      <div class="chart-container"> -->
        <!-- <canvas #campaignTypePieChartCanvas id="campaignTypePieChartCanvas"></canvas> -->
        <!-- <canvas #campaignTypePieChartCanvas></canvas>
      </div>
    </section> -->

    <!-- Lead Records -->
    <!-- <section class="card">
      <h2 class="section-title">Lead Records</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Company</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Campaign</th>
              <th>Created</th>
              <th>Stage</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let lead of reportData.leads.lead_records">
              <td>{{ lead.id }}</td>
              <td>{{ lead.first_name || '' }} {{ lead.last_name }}</td>
              <td>{{ lead.company }}</td>
              <td>{{ lead.email }}</td>
              <td>{{ lead.phone || 'N/A' }}</td>
              <td>{{ lead.campaign }}</td>
              <td>{{ formatDisplayDate(lead.created_time) }}</td>
              <td>
                <span class="badge badge-lead">{{ lead.pipeline_stage }}</span>
              </td>
            </tr>
            <tr *ngIf="reportData.leads.lead_records.length === 0">
              <td colspan="8" class="empty-table-message">No lead records found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section> -->

    <!-- Deal Records -->
    <!-- <section class="card">
      <h2 class="section-title">Deal Records</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Title</th>
              <th>Amount</th>
              <th>Close Date</th>
              <th>Campaign</th>
              <th>Pipeline</th>
              <th>Stage</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let deal of reportData.deals.deal_records">
              <td>{{ deal.title }}</td>
              <td class="font-medium">{{ formatDisplayCurrency(deal.amount) }}</td>
              <td>{{ formatDisplayDate(deal.close_date) }}</td>
              <td>{{ deal.campaign }}</td>
              <td>{{ deal.pipeline }}</td>
              <td>
                <span class="badge badge-deal">{{ deal.stage }}</span>
              </td>
            </tr>
             <tr *ngIf="reportData.deals.deal_records.length === 0">
              <td colspan="6" class="empty-table-message">No deal records found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section> -->

    <!-- Campaign Records -->
    <!-- <section class="card">
      <h2 class="section-title">Campaign Records</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Type</th>
              <th>Launch Time</th>
              <th>Associated With</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let campaign of reportData.campaigns.campaign_records">
              <td>{{ campaign.name }}</td>
              <td>
                <span class="badge"
                      [class.badge-campaign-regular]="campaign.campaign_type === 'REGULAR'"
                      [class.badge-campaign-video]="campaign.campaign_type === 'VIDEO'"
                      [class.badge-campaign-event]="campaign.campaign_type === 'EVENT'"
                      [class.badge-campaign-default]="!['REGULAR', 'VIDEO', 'EVENT'].includes(campaign.campaign_type)">
                  {{ campaign.campaign_type }}
                </span>
              </td>
              <td>{{ formatDisplayDate(campaign.launch_time) }}</td>
              <td>{{ campaign.associated_with }}</td>
              <td>{{ campaign.details }}</td>
            </tr>
            <tr *ngIf="reportData.campaigns.campaign_records.length === 0">
              <td colspan="5" class="empty-table-message">No campaign records found.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section> -->

    <!-- Key Takeaways & Strategic Recommendations -->
    <!-- <div class="key-info-grid">
      <section class="card">
        <h2 class="section-title">Key Takeaways</h2>
        <ul class="info-list">
          <li *ngFor="let takeaway of reportData.key_takeaways" class="info-list-item">
            <span class="list-icon list-icon-takeaway">âœ“</span>
            <span>{{ takeaway }}</span>
          </li>
        </ul>
      </section>

      <section class="card">
        <h2 class="section-title">Strategic Recommendations</h2>
        <ul class="info-list">
          <li *ngFor="let recommendation of reportData.strategic_recommendations" class="info-list-item">
            <span class="list-icon list-icon-recommendation">ðŸ’¡</span>
            <span>{{ recommendation }}</span>
          </li>
        </ul>
      </section>
    </div>
  </main>

  <footer class="summary-footer">
    <p>&copy; {{ currentYear }} Executive Report. All rights reserved.</p>
  </footer>
</div> -->

<!-- <div #pdfCaptureArea style="position: absolute; top: -10000px; left: -10000px;"></div> -->

<div class="download-btns">
  <button class="asset-btn" (click)="downloadIframeAsHTML()">Download HTML</button>
  <!-- <button class="asset-btn" (click)="downloadIframeAsDOC()">Download Doc</button> -->
  <button class="asset-btn" (click)="downloadIframeAsPDF()">Download PDF</button>
</div>


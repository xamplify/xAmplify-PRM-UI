<div class="modal fade right" id="partnerCompaniesPopup" tabindex="-1" role="dialog" aria-labelledby="partnerCompaniesPopup" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog" [ngClass]="isModalPopupshow ? '' : 'full-width'" role="document">
     <div class="modal-content">
        <div class="modal-header">
           <button *ngIf="!ngxLoading" type="button" class="close-circle" (click)="closePopup()">
           <i class="fa fa-times" aria-hidden="true"></i>
           </button>
           <h4 class="modal-title text-center">Publish To {{authenticationService?.partnerModule?.customName}}/List of {{authenticationService?.partnerModule?.customName}}</h4>
        </div>
        <div class="modal-body">
         <div class="thank-you-pop" *ngIf="sendSuccess">
            <ng-container *ngIf="statusCode==200">
               <i class="fa fa-check" id="font-size-success" aria-hidden="true"></i>
               <h4 class="event-success">{{responseMessage}}</h4>
            </ng-container>
            <ng-container *ngIf="statusCode!=200">
               <i class="fa fa-info-circle" id="font-size-info" aria-hidden="true"></i>
               <h4 class="event-info">{{responseMessage}}</h4>
            </ng-container>
         </div>
         <div class="col-md-12 col-lg-12 pl2 pr0"  *ngIf="!sendSuccess">
            <app-response-message class="pg8" [customResponse]="customResponse" *ngIf="customResponse.isVisible">
            </app-response-message>
            <div>
               <div>
                  <app-list-loader [hidden]="!modalPopupLoader"></app-list-loader>
               </div>
               <div class="row" [hidden]="modalPopupLoader">
                  <div class="col-md-12 col-lg-12">
                     <div class="panel with-nav-tabs panel-default">
                        <div class="panel-heading" id="company-and-group-tabs">
                           <ul class="nav nav-tabs">
                              <li id="partners-li" >
                                 <a class="partnersC" title="Click to see {{authenticationService?.partnerModule?.customName}} companies" href="#partners" data-toggle="tab" (click)="findPartnerCompaniesByFilterIndex(pagination);showFilter=true;selectedTab=1">{{authenticationService?.partnerModule?.customName}}</a>
                              </li>
                              <li id="partnerGroups-li">
                                 <a class="partnerGroupsC" title="Click to see List of {{authenticationService?.partnerModule?.customName}}"   href="#partnerGroups" data-toggle="tab"  (click)="findPartnerGroups(partnerGroupsPagination);showFilter=false;selectedTab=2">List of {{authenticationService?.partnerModule?.customName}}</a>
                              </li>
                           </ul>
                        </div>
                        <div class="panel-body">
                           <div class="tab-content">
                              <!----Search Option----->
                              <div class="page-toolbar">
                                 <div class="btn-group pull-right">
                                    <div class="inputs float-right" style="display: inline-flex;">
                                       <div class="portlet-input input-inline" id="search-div">
                                          <div class="input-icon right" id="icon">

                                             <!----Partner Company Search---->
                                             <ng-container *ngIf="selectedTab==1">
                                                <input type="text" id="sort-text" class="form-control" [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}" placeholder="Search..." (keypress)="partnersSearchOnKeyEvent($event.keyCode)">
                                                <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="sortOption.searchKey" (click)="sortOption.searchKey='';searchPartners();"></button>
                                                <button type="submit" class="search-box-item-click" (click)="searchPartners()">
                                                <i class="fa fa-search" aria-hidden="true"></i>
                                                </button>
                                             </ng-container>

                                              <!----Partner Group Search---->
                                              <ng-container *ngIf="selectedTab==2">
                                                <input type="text" id="sort-text" class="form-control"
                                                [(ngModel)]="partnerGroupsSortOption.searchKey" [ngModelOptions]="{standalone: true}"
                                                placeholder="Search..." (keypress)="partnerGroupsSearchOnKeyEvent($event.keyCode)">
                                                <button class="glyphicon glyphicon-remove search-box-item-clear"
                                                   *ngIf="partnerGroupsSortOption.searchKey"
                                                   (click)="partnerGroupsSortOption.searchKey='';searchPartnerGroups();"></button>
                                                <button type="submit" class="search-box-item-click" (click)="searchPartnerGroups()">
                                                   <i class="fa fa-search" aria-hidden="true"></i>
                                                </button>
                                              </ng-container>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <!---XNFR-85---->
                              <app-team-member-filter-option *ngIf="showFilter && !authenticationService?.module?.isMarketingCompany" (teamMemberFilterOptionEventEmitter)="getSelectedIndex($event)"></app-team-member-filter-option>
                              <div class="tab-pane fade in" id="partners">
                                 <br/><br/>
                                 <ng-container *ngIf="!sendSuccess">
                                    <div class="alert alert-success text-center" *ngIf="selectedPartnershipIds?.length>0">
                                       <strong>Selected Companies : {{selectedPartnershipIds?.length}}</strong>
                                    </div>
                                    <app-list-loader *ngIf="httpRequestLoader.isLoading"></app-list-loader>
                                    <ng-container *ngIf="!httpRequestLoader.isLoading">
                                       <div class="table-responsive">
                                          <table class="table tgrid table-hover table-sm" *ngIf="pagination.pagedItems?.length>0" id="parnter-companies" aria-describedby="damPartnersTableDescription">
                                             <thead>
                                                <tr>
                                                   <th scope="col"></th>
                                                   <th scope="col">Company Logo</th>
                                                   <th scope="col" class="text-center">Company Name</th>
                                                   <th scope="col">Created Time</th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                                <ng-container *ngFor="let partner of pagination.pagedItems ;let i =index">
                                                <tr [class.row-selected]="selectedPartnershipIds.indexOf(partner.partnershipId)>-1">
                                                   <td class="cw">
                                                      <div class="actions-block left-float">
                                                      <a  (click)="viewTeamMembers(partner)" title="View/Hide Team Members">
                                                         <i class="fa" [ngClass]="{'fa-angle-right': !partner.expand, 'fa-angle-down': partner.expand}" aria-hidden="true"></i>
                                                      </a>
                                                      </div>
                                                   </td>
                                                   <td style="width: 10%;" title="{{partner?.companyName}}">
                                                      <div class="thumbnail-wrapper">
                                                         <img alt="No image found" onerror="this.src='assets/images/company-profile-logo.png';" [src]="authenticationService.MEDIA_URL+partner.companyLogo">
                                                      </div>
                                                   </td>
                                                <td title="{{partner?.companyName}}" class="text-center">
                                                   <span>{{partner?.companyName | slice:0:20}}</span>
                                                   <span *ngIf="partner?.companyName.length>20">...</span>
                                                </td>
                                                <td>
                                                   <app-timestamp  [dateAndTime]="partner?.displayTime">
                                                   </app-timestamp>
                                                </td>
                                                </tr>
                                                <tr *ngIf="partner?.expand">
                                                   <td colspan="4">
                                                      <div class="table-responsive x-hidden">
                                                         <div class="portlet-input input-inline float-right mb10p" id="search-div">
                                                            <div class="input-icon right" id="icon">
                                                               <input type="text" id="sort-text" class="form-control" [(ngModel)]="teamMembersPagination.searchKey" [ngModelOptions]="{standalone: true}" placeholder="search..." (keypress)="adminAndTeamMembersKeySearch($event.keyCode)">
                                                               <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="teamMembersPagination?.searchKey" (click)="teamMembersPagination.searchKey='';searchAdminsAndTeamMembers();"></button>
                                                               <button type="submit" class="search-box-item-click" (click)="searchAdminsAndTeamMembers()">
                                                               <i class="fa fa-search" aria-hidden="true"></i>
                                                               </button>
                                                            </div>
                                                         </div>
                                                         <ng-container *ngIf="!teamMembersLoader.isLoading && adminsAndTeamMembersErrorMessage.isVisible">
                                                            <div class="custom-response-padding">
                                                               <app-response-message [customResponse]="adminsAndTeamMembersErrorMessage"></app-response-message>
                                                         </div>
                                                         </ng-container>
                                                         <div *ngIf="!adminsAndTeamMembersErrorMessage.isVisible">
                                                         <app-auto-response-loader *ngIf="teamMembersLoader.isLoading"></app-auto-response-loader>
                                                         <ng-container *ngIf="!teamMembersLoader.isLoading">
                                                         <table  class="table tgrid table-condensed table-bordered child-table-xamp" aria-describedby="team-members-info" id="admin-and-team-members-{{partner?.partnershipId}}">
                                                            <thead>
                                                                  <tr>
                                                                  <th scope="row" class="text-center">
                                                                     <input type="checkbox"  [(ngModel)]="isHeaderCheckBoxChecked"  (change)="selectAllTeamMembersOfTheCurrentPage($event,partner.partnershipId)">
                                                                  </th>
                                                                  <th scope="row">Entity Info</th>
                                                                  </tr>
                                                               </thead>
                                                               <tbody>
                                                                  <tr *ngFor="let adminAndTeamMember of teamMembersPagination.pagedItems;let i = index;" id="publishToPartners-{{adminAndTeamMember.userId}}" [class.row-selected]="selectedTeamMemberIds.indexOf(adminAndTeamMember.userId)>-1" (click)="highlightSelectedAdminOrTeamMemberRowOnRowClick(adminAndTeamMember.userId,partner.partnershipId,$event)" >
                                                                     <td class="text-center">
                                                                        <input type="checkbox" id="{{adminAndTeamMember.userId}}"  [checked]="selectedTeamMemberIds.indexOf(adminAndTeamMember.userId)>-1" name="adminOrTeamMemberCheckBox[]"   value="{{adminAndTeamMember.userId}}" (click)="highlightAdminOrTeamMemberRowOnCheckBoxClick(adminAndTeamMember.userId,partner.partnershipId,$event)">
                                                                     </td>
                                                                     <td>
                                                                        <app-user-info [isPartnerEntityInfo]="false" [userInfo]="adminAndTeamMember">
                                                                        </app-user-info>
                                                                     </td>
                                                                  </tr>
                                                               </tbody>
                                                            </table>
                                                            </ng-container>
                                                            <!---Pagination-->
                                                            <div *ngIf="teamMembersPagination.totalRecords==0 && !teamMembersLoader.isLoading" class="alert alert-info">
                                                               <strong>No Data Found.</strong>
                                                            </div>
                                                         </div>
                                                      </div>
                                                   </td>
                                                </tr>
                                                </ng-container>
                                             </tbody>
                                          </table>
                                       </div>
                                       <!-- End of 24 -->
                                       <div *ngIf="pagination.totalRecords==0 && !httpRequestLoader.isLoading" class="alert alert-info">
                                          <strong>No Data Found.</strong>
                                       </div>
                                    </ng-container>
                                 </ng-container>
                                 <div *ngIf="pagination.pagedItems.length !== 0 && !httpRequestLoader.isLoading" class="pg8">
                                 <app-pagination [pagination]="pagination" (notifyParent)="navigateToNextPage($event)" (notifyParentDropDown)="findPartnerCompanies($event)">
                                 </app-pagination>
                                 </div>
                              </div>
                              <div class="tab-pane fade" id="partnerGroups">
                                 <br/><br/>
                                 <div class="alert alert-success text-center" *ngIf="selectedPartnerGroupIds?.length>0">
                                    <strong>
                                       Selected Lists : {{selectedPartnerGroupIds?.length}}
                                    </strong>
                                 </div>
                                 <app-list-loader *ngIf="httpRequestLoader.isLoading"></app-list-loader>
                                 <ng-container *ngIf="!httpRequestLoader.isLoading">
                                    <div class="table-responsive">
                                       <table class="table tgrid table-condensed table-bordered" *ngIf="partnerGroupsPagination.pagedItems?.length>0"
                                          id="parnter-groups-table" aria-describedby="partnerGroupsDescription">
                                          <thead>
                                             <tr>
                                                <th scope="col" class="text-center">
                                                   <input type="checkbox" [(ngModel)]="isParnterGroupHeaderCheckBoxChecked"
                                                      id="parnterGroupsHeaderCheckBox"
                                                      (change)="selectOrUnselectAllPartnerGroupsOfTheCurrentPage($event)">
                                                </th>
                                                <th scope="col" *ngIf="showExpandButton"></th>
                                                <th scope="col" class="text-center">List Name</th>
                                                <th scope="col" class="text-center">Count</th>
                                                <th scope="col" class="text-center">Created Time</th>
                                                <th scope="col" class="text-center">Preview</th>
                                             </tr>
                                          </thead>
                                          <tbody>
                                             <ng-container *ngFor="let partnerGroup of partnerGroupsPagination.pagedItems;let i = index;">
                                                <tr id="partnerGroups-tr-{{partnerGroup.id}}"
                                                   [class.row-selected]="selectedPartnerGroupIds.indexOf(partnerGroup.id)>-1"
                                                   (click)="highlightSelectedPartnerGroupOnRowClick(partnerGroup.id,$event)">
                                                   <td class="text-center">
                                                      <input type="checkbox" id="{{partnerGroup.id}}" [checked]="selectedPartnerGroupIds.indexOf(partnerGroup.id)>-1"
                                                         name="partnerGroupsCheckBox[]" value="{{partnerGroup.id}}"
                                                         (click)="$event.stopPropagation();highlightPartnerGroupRowOnCheckBoxClick(partnerGroup.id,$event);">
                                                   </td>
                                                   <td class="cw" *ngIf="showExpandButton">
                                                      <div class="actions-block left-float">
                                                        <a (click)="$event.stopPropagation();viewMatchedContacts(partnerGroup)" title="Matched Results">
                                                          <i class="fa" [ngClass]="{'fa-angle-right': !partnerGroup.expand, 'fa-angle-down': partnerGroup.expand}"
                                                            aria-hidden="true"></i>
                                                        </a>
                                                      </div>
                                                    </td>
                                                   <td title="{{partnerGroup?.groupName}}" class="text-center">
                                                      <span>{{partnerGroup?.groupName | slice:0:40}}</span>
                                                      <span *ngIf="partnerGroup?.groupName.length>40">...</span>
                                                   </td>
                                                   <td class="text-center">
                                                      {{partnerGroup.numberOfPartners}}
                                                   </td>
                                                   <td class="text-center">
                                                      <app-timestamp [dateAndTime]="partnerGroup?.displayTime">
                                                      </app-timestamp>
                                                   </td>
                                                   <td class="text-center">
                                                      <div class="actions-block none-float" (click)="$event.stopPropagation();previewUserListUsers(partnerGroup)">
                                                         <a><i class="fa fa-eye" aria-hidden="true"></i></a>
                                                      </div>
                                                   </td>
                                                </tr>
                                                <tr role="row" *ngIf="partnerGroup?.expand">
                                                   <td colspan="12">
                                                     <app-userlist-users [searchKey]="partnerGroupsPagination.searchKey" [userListId]="partnerGroup.id"></app-userlist-users>
                                                   </td>
                                                 </tr>
                                             </ng-container>
                                          </tbody>
                                       </table>
                                    </div>
                                    <!-- End of 24 -->
                                    <div *ngIf="partnerGroupsPagination.totalRecords==0 && !httpRequestLoader.isLoading" class="alert alert-info">
                                       <strong>No Data Found.</strong>
                                    </div>
                                 </ng-container>
                                 <div *ngIf="partnerGroupsPagination.pagedItems.length !== 0" class="pg8" [hidden]="httpRequestLoader.isLoading">
                                    <app-pagination [pagination]="partnerGroupsPagination" (notifyParent)="navigatePartnerGroups($event)"
                                       (notifyParentDropDown)="findPartnerGroups($event)">
                                    </app-pagination>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
     </div>
     <div class="modal-footer" *ngIf="!httpRequestLoader.isLoading && !modalPopupLoader">
         <button class="btn btn-danger" *ngIf="(selectedTeamMemberIds?.length>0 || selectedPartnershipIds?.length>0 || selectedPartnerGroupIds?.length>0) && !sendSuccess " (click)="clearAll()">Clear All</button>
        <button type="submit" class="btn green-haze" [disabled]="(selectedTeamMemberIds?.length==0 && selectedPartnerGroupIds?.length==0) && !isEdit" *ngIf="!sendSuccess" (click)="publish()">Submit</button>
        <button type="submit" class="btn btn-default" (click)="closePopup()">Close</button>
     </div>
  </div>
</div>
</div>
<ng-container *ngIf="showUsersPreview">
<app-preview-user-list [userListName]="selectedPartnerGroupName" [userListId]="selectedPartnerGroupId" (notifyParentComponent)="resetValues()"></app-preview-user-list>
</ng-container>

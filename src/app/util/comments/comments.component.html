<!--Comments ModalPopUp------->
<div id="commentsModalPopUp" class="modal fade right" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog modal-css" role="document">
     <!-- Modal content-->
     <div class="modal-content"  style="overflow-x: hidden;">
        <ngx-loading [show]="commentModalPopUpLoader" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
        <div class="modal-header">
           <a title="Close" class="close-circle" (click)="closeModalPopUp()">
               <i class="fa fa-times" aria-hidden="true"></i>
            </a>
            <a title="Refresh" class="close-circle mr5" (click)="findComments()">
               <i class="fa fa-refresh" aria-hidden="true"></i>
            </a>
           <h4 class="modal-title" style="font-weight: 600;" translate>Add Comments</h4>
        </div>
        <div class="modal-body" style="max-height: 100%;">
           <app-modal-popup-loader *ngIf="commentModalPopUpLoader"></app-modal-popup-loader>
           <ng-container *ngIf="!commentModalPopUpLoader">
              <div class="comment-details">
                 <div class="row mix-grid p10" style=" background: #f1f1f1; ">
                    <div class="col-md-2" >
                       <div class="frame">
                          <img style="height: 80px;width: 80px;" class="img-circle" src="{{companyAndUserAndModuleDetailsDto?.companyLogo}}" alt="">
                       </div>
                    </div>
                    <div class="col-md-10" style="text-align: left;">
                       <div>
                          <h5 class="mt10 mb0"  title="{{companyAndUserAndModuleDetailsDto?.companyName}}">
                             <span><strong>Company Name </strong></span>: {{companyAndUserAndModuleDetailsDto?.companyName | slice:0:30}}
                             <span *ngIf="companyAndUserAndModuleDetailsDto?.companyName?.length>30">..</span>
                          </h5>
                       </div>
                       <div *ngIf="companyAndUserAndModuleDetailsDto?.createdBy!=companyAndUserAndModuleDetailsDto?.emailId">
                          <h5 class="mt10 mb0"  title="{{companyAndUserAndModuleDetailsDto?.createdBy}}">
                             <span><strong>Name </strong></span>: {{companyAndUserAndModuleDetailsDto?.createdBy | slice:0:30}}
                             <span *ngIf="companyAndUserAndModuleDetailsDto?.createdBy?.length>30">..</span>
                          </h5>
                       </div>
                       <div>
                          <h5 class="mt10 mb0"  title="{{companyAndUserAndModuleDetailsDto?.emailId}}">
                             <span><strong>Email Id </strong></span>: {{companyAndUserAndModuleDetailsDto?.emailId | slice:0:30}}
                             <span *ngIf="companyAndUserAndModuleDetailsDto?.emailId?.length>30">..</span>
                          </h5>
                       </div>
                       <div>
                          <h5 class="mt10 mb0">
                             <span><strong>Created On </strong></span>:
                             <app-display-date-and-time [dateAndTimeUTCString]="companyAndUserAndModuleDetailsDto?.createdDateInUTCString"></app-display-date-and-time>
                          </h5>
                       </div>
                       <div *ngIf="companyAndUserAndModuleDetailsDto?.status!='CREATED'">
                        <h5 class="mt10 mb0">
                           <span><strong>{{companyAndUserAndModuleDetailsDto?.status}} On </strong></span>:
                           <app-display-date-and-time [dateAndTimeUTCString]="companyAndUserAndModuleDetailsDto?.updatedDateInUTCString"></app-display-date-and-time>
                        </h5>
                     </div>
                       <div *ngIf="commentDto?.statusInString!='-'">
                          <h5 class="mt10 mb0"  title="{{commentDto?.statusInString}}">
                             <span><strong>Status</strong></span>:
                             <span *ngIf="!showStatusDropDown" class="view-banner-agency"  
                              [ngClass]="{'bgc-green': commentDto?.statusInString==='APPROVED', 
                                          'bgc-red': commentDto?.statusInString==='REJECTED',
                                          'bgc-orange':commentDto?.statusInString==='CREATED'}" translate>
                                          <strong>{{commentDto?.statusInString}}</strong> 
                                <a class="white">
                                   <i class="fa fa-edit fs-13px" (click)="showStatusDropDown=true"></i></a>          
                               </span>
                                <select *ngIf="showStatusDropDown"  [(ngModel)]="commentDto.statusInString" (ngModelChange)="showStatusDropDown=false"
                                class="view-banner-agency"  
                                    [ngClass]="{'bgc-green': commentDto?.statusInString==='APPROVED', 
                                          'bgc-red': commentDto?.statusInString==='REJECTED',
                                          'bgc-orange':commentDto?.statusInString==='CREATED'}">
                                 <option  *ngFor="let templateStatus of templateStatusArray" [ngValue]="templateStatus">
                                     {{templateStatus}}
                                 </option> 
                             </select>&nbsp;
                             <span *ngIf="isStatusUpdated" class="success"><strong>Status Updated Successfully</strong></span>
                          </h5>
                       </div>
                    </div>
                 </div>
              </div>
              <div class="comment-area comment-div" id="comments-div">
                 <ul class="comment-section" *ngFor="let comment of comments" style="margin: 0px">
                    <li [attr.class]="comment.commentedByUserId!=loggedInUserId ? 'comment author-comment':'comment user-comment'" style="width: 135%;">
                       <div class="info">
                          <a title="{{comment?.commentedBy}}">{{comment?.commentedBy| slice:0:30}}
                             <span *ngIf="comment?.commentedBy?.length>30">...</span>
                           </a>
                          <span *ngIf="comment?.commentedOn">
                             <app-timestamp-new [dateAndTime]="comment.commentedOn"> </app-timestamp-new>
                          </span>
                       </div>
                       <a class="avatar none">
                       <img onerror="this.src='assets/images/icon-user-default.png';" src="{{comment?.commentedUserProfilePicture}}" width="35" alt="Profile Avatar" />
                       </a>
                       <p>{{comment?.comment}}</p>
                    </li>
                 </ul>
              </div>
              <div class="write-new comment-text-area">
                 <textarea placeholder="Write your comment here"  [(ngModel)]="commentDto.comment" [ngModelOptions]="{standalone: true}" maxlength="5000" (input)="validateComment(commentDto)"></textarea>
                 <div>
                    <button (click)="save($event)" [disabled]="commentDto?.invalidComment" [style.pointer-events]="commentDto?.invalidComment ? 'none' : 'auto' "  class="btn btn-primary comment">Submit</button>
                 </div>
              </div>
           </ng-container>
        </div>
     </div>
  </div>
</div>
<app-scroll-top></app-scroll-top>

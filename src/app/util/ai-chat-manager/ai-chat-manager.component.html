<ngx-loading [show]="ngxLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<app-add-email-modal-popup *ngIf="showEmailModalPopup" [actionType]="actionType" [subjectText]="subjectText"
  [emailBody]="emailBody" (notifyClose)="closeEmailModalPopup($event)"></app-add-email-modal-popup>
<app-update-status *ngIf="openShareOption" [fromAi]="true" [OliverData]="socialContent"
  [isShowPageContent]="isOliverAiFromdam" (notifyClose)="closeSocialShare($event)"></app-update-status>
<div [ngClass]="isOliverAiFromdam || (isFromManagePartner && !isFromOnboardSection) ? '' : 'page-content'">
  <button *ngIf="isBeeTemplateComponentCalled" class="btn close_btn" (click)="closeBee()">×</button>
  <app-bee-template-util *ngIf="isBeeTemplateComponentCalled"[beeContainerInput]="beeContainerInput" (notifyParentComponent)="readBeeTemplateData($event)"></app-bee-template-util>
  <app-add-dam *ngIf="openAssetPage" [isFromOliverPopup]="true" [assetData]="emittdata" (notifyEmit)="closeDesignTemplate($event)"></app-add-dam>
  <app-create-template *ngIf="showTemplate" [isFromOliverPopUp]="true" (notifyEmit)="closeDesignTemplate($event)">
  </app-create-template>
   <app-add-landing-page *ngIf="showPage" [isFromOliver]="true" (notifyEmit)="closeDesignTemplate($event)"></app-add-landing-page>
  <div *ngIf="selectTemplate" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 p0">
    <app-choose-emailtemplate  [selectedTemplateList]="selectedTemplateList"
      (notifyData)="closeSelectionTemplate($event)" [pageView]="chatGptIntegrationSettingsDto.designPage"></app-choose-emailtemplate>
  </div>
<app-ppt-design-picker *ngIf="showPptDesignPicker" [pptData]="pptData" [fromOliverPopup]="false" (notifyData)="emitSelectedTemplate($event)"></app-ppt-design-picker>

  <div *ngIf="!openHistory && !openShareOption && !isBeeTemplateComponentCalled && !selectTemplate && !showTemplate && !openAssetPage && !showPage && !showPptDesignPicker" class="pdf_body">
    <button class="btn close_btn mt5" (click)="closeAi()">×</button>
    <div>
      <h3 class="text-center mb15 assist_text mt0">How may I assist you?</h3>
      <div class="pdf_card">
        <div class="pdf_child">
          <div *ngIf="!isFromFolderView && !isFromContactJourney && !isFromManageContact && !isFromManagePartner"  class="file-info">
            <div class="file-icon">
              <div class="d-flex document_flex">
                <!-- <div class="pdf-text">PDF</div> -->
                <div *ngIf="isPdfUploading" class="fileloader mr10"></div>
                <ng-container *ngIf="!isPdfUploading">
                  <img class="mr10" [src]="getFileIcon()" alt="file" width="28px" height="28px">
                </ng-container>
                <a title="{{ assetDetailsViewDtoOfPartner?.assetName }}">
                  {{ assetDetailsViewDtoOfPartner?.assetName | slice:0:20 }}
                  <span
                    *ngIf="assetDetailsViewDtoOfPartner?.assetName?.length > 20">...</span>.{{assetDetailsViewDtoOfPartner?.assetType}}
                </a>
              </div>
              <div class="published-on">{{UploadedFile ? 'Uploaded On' :'Published On'}}:{{ assetDetailsViewDtoOfPartner?.displayTime | date:'MMM d, yyyy, h:mm a' }}
              </div>
            </div>
            <div class="file-details">
              <h5>Asset Name: {{assetDetailsViewDtoOfPartner?.assetName}}</h5>
              <p>Folder:{{assetDetailsViewDtoOfPartner?.categoryName}}</p>
              <p>Published By:{{assetDetailsViewDtoOfPartner?.displayName}}</p>
              <p *ngIf="!isOliverAiFromdam">From: {{assetDetailsViewDtoOfPartner?.vendorCompanyName}}</p>
            </div>
          </div>
          <div *ngIf="isFromFolderView" class="file-info">
            <div class="file-icon">
              <div class="d-flex document_flex">
                <!-- <div class="pdf-text">PDF</div> -->
                <div *ngIf="isPdfUploading" class="fileloader mr10"></div>
                <ng-container *ngIf="!isPdfUploading"><img class=" mr10" src="assets/images/fileIconOliver.svg" alt="PDF"
                    width="28px" height="28px">
                </ng-container>
                <a title="{{ folderName }}" data-toggle="tooltip" data-placement="top">
                  {{ folderName | slice:0:20 }}
                  <span *ngIf="folderName?.length > 20">...</span>
                </a>
              </div>
              <div class="published-on">Created On:{{ folderCreatedOn | date:'MMM d, yyyy, h:mm a' }}
              </div>
            </div>
            <div class="file-details">
              <h5>Created By: {{folderCreatedBy}}</h5>
              <p>From:{{folderFrom}}</p>
              <span class="Track-countbg">Digital Asset {{folderAssetCount}}</span>
            </div>
          </div>

          <div *ngIf="isFromContactJourney || isFromManageContact || isFromManagePartner" class="file-info">
            <div class="file-icon" *ngIf="selectedContact != undefined && callActivity == undefined">
              <div class="d-flex document_flex">
                <div *ngIf="ngxLoading" class="fileloader mr10"></div>
                <ng-container *ngIf="!ngxLoading && selectedContact != undefined"><img *ngIf="selectedContact.imageSourcePath != undefined" class="mr10"
                  src="{{selectedContact.imageSourcePath}}" alt="CONTACT" width="28px" height="28px">
                <img *ngIf="selectedContact.imageSourcePath == undefined" class="mr10"
                  src="assets/admin/pages/media/works/contacts2.png" alt="CONTACT" width="28px" height="28px">
                </ng-container>
                <a *ngIf="selectedContact?.contactName" title="{{ selectedContact?.contactName }}">
                  {{ selectedContact?.contactName | slice:0:25 }}
                  <span *ngIf="selectedContact?.contactName?.length > 25">...</span>
                </a>
                <a *ngIf="selectedContact?.contactName == undefined || selectedContact?.contactName?.length == 0"
                  title="{{ selectedContact?.emailId }}">
                  {{ selectedContact?.emailId | slice:0:25 }}
                  <span *ngIf="selectedContact?.emailId?.length > 25">...</span>
                </a>
              </div>
              <div *ngIf="selectedContact?.contactName" class="published-on">Email Id: {{selectedContact.emailId }}
              </div>
            </div>
            <div class="file-icon" *ngIf="callActivity != undefined">
              <div class="d-flex document_flex">
                <div *ngIf="ngxLoading" class="fileloader mr10"></div>
                <ng-container *ngIf="!ngxLoading && callActivity != undefined">
                  <img class="mr10" *ngIf="callActivity.direction == 'Outgoing'"
                    src="assets/admin/pages/media/works/outgoing-call.png" alt="CONTACT" width="28px" height="28px">
                  <img class="mr10" *ngIf="callActivity.direction == 'Incoming'"
                    src="assets/admin/pages/media/works/incoming-call.png" alt="CONTACT" width="28px" height="28px">
                </ng-container>
                <a *ngIf="callActivity?.direction" title="{{ callActivity?.direction }}">
                  {{callActivity.direction | slice:0:35}} Call
                  <span *ngIf="callActivity?.direction?.length > 25">...</span>
                </a>
              </div>
              <div class="published-on">{{(callActivity.direction=='Incoming' || callActivity.direction=='Missed')?'From:':'To:'}}
                {{callActivity.callInfoString}}
              </div>
            </div>
            <div class="file-details">
              <span class="aligin-para" *ngIf="selectedContact != undefined && callActivity == undefined">
                <p *ngIf="selectedContact?.mobileNumber"><b>Mobile Number:</b> {{selectedContact.mobileNumber}}</p>
              </span>
              <span class="aligin-para" *ngIf="callActivity != undefined">
                <p *ngIf="callActivity?.mobileNumber"><b>Mobile Number:</b> {{callActivity.mobileNumber}}</p>
              </span>
              <span class="Track-countbg" *ngIf="selectedContact != undefined && callActivity == undefined && !isFromManageContact && !isFromManagePartner">
                <p *ngIf="chatGptSettingDTO.totalRecords == undefined || chatGptSettingDTO.totalRecords == 0">Recordings: 0
                </p>
                <p *ngIf="chatGptSettingDTO.totalRecords > 0">Recordings: {{chatGptSettingDTO.totalRecords}}</p>
              </span>
              <span class="Track-countbg" *ngIf="callActivity != undefined">
                <p>Duration: {{callActivity.duration}}</p>
              </span>
            </div>
          </div>

          <div class="input-section">
            <input type="text" (keypress)="searchDataOnKeyPress($event.keyCode)" class="form-control"
              [(ngModel)]="inputText" (input)="validateInputText()" placeholder="Ask me!">
          </div>
        </div>
        <div class="action-buttons action-btn-align">
          <div *ngIf="!isFromFolderView" class="btn-group">
            <button *ngIf="false" class="btn plus-btn" (click)="pdfInput.click()">
              <span class="fa fa-plus"></span>
              <input type="file" accept="application/pdf" (change)="onFileSelected($event)" #pdfInput style="display: none;" />
            </button>
            <button *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Analyze Asset')">Analyze Asset</button>
            <button *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Summarize in detail')">Summarize in detail</button>
            <button *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Summarize with Key Quotes')">Summarize with Key
              Quotes</button>
            <button *ngIf="isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Analyze the files.')">Analyze the files</button>
            <button *ngIf="isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Summarize in detail')">Summarize in detail</button>
            <button *ngIf="isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Summarize with Key Insights')">Summarize with Key
              Insights</button>
            <button *ngIf="isFromManageContact" class="btn btn-pdf" (click)="setInputText('Give me the details of the contact')">Give me the details of the contact</button>
            <button *ngIf="isFromManageContact" class="btn btn-pdf" (click)="setInputText('Generate an Executive Summary of the contact')">Generate an Executive Summary...</button>
            <button *ngIf="isFromManageContact" class="btn btn-pdf" (click)="setInputText('Generate a QBR of the contact')">Generate a QBR of the contact</button>

            <button *ngIf="isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Give me the details of partner')"> Give me the details of partner</button>
            <button *ngIf="isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Generate an Executive Summary of the partner')">Generate an Executive Summary...</button>
            <button *ngIf="isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Generate a QBR of the partner')">Generate a QBR of the partner</button>
          </div>
          <div *ngIf="isFromFolderView" class="btn-group">
            <button class="btn btn-pdf" (click)="setInputText('Generate summaries')">Generate summaries</button>
            <button class="btn btn-pdf" (click)="setInputText('Compare documents')">Compare documents</button>
            <button class="btn btn-pdf" (click)="setInputText('Give an overview of documents')">Give an overview of documents</button>
          </div>


          <div>
            <button *ngIf="oliverPromptSuggestionDTOs?.length > 0" class="image-only-button" style="padding-right: 6px; height: 16px;"
              (click)="!assetLoader && openPrompts()">
              <img data-toggle="tooltip" data-placement="top" title="Prompt Suggestions" 
                src="assets/images/oliver-promps-icon.svg" alt="Suggested Prompts">
            </button>
            <button class="btn btn-primary" [disabled]="isPdfUploading || isLoading || inputText == ''"
              (click)="submitdata()">Submit</button>
          </div>
        
        </div>
          <div *ngIf="oliverPromptSuggestionDTOs?.length > 0 && (showPromptBoxAbove || showInsightPromptBoxAbove)">
            <div class="suggestion-direction"></div>
            <ng-container *ngTemplateOutlet="displayPrompts"></ng-container>
          </div>
      </div>
    </div>
  </div>
  <!-- chat history -->
  <div *ngIf="openHistory && !openShareOption && !isBeeTemplateComponentCalled && !selectTemplate && !showTemplate && !openAssetPage && !showPage && !showPptDesignPicker" [ngClass]="showPreview ? 'summarize-pdf-cards' : ''">
    <div *ngIf="showPreview" class="pdf-viewer">
      <div class="toolbar">
        <select class="zoom" [(ngModel)]="zoomLevel">
          <option value="50">50%</option>
          <option value="60">60%</option>
          <option value="100">100%</option>
          <option value="125">125%</option>
          <option value="150">150%</option>
          <option value="200">200%</option>
        </select>
        <button class="closed" (click)="closePreview()">✕</button>
      </div>
      <div class="pdf-zoom-wrapper">
        <div class="pdf-scaled">
          <object *ngIf="loadPreview" [attr.data]="assetUrl" [style.width]="scaledWidth" [style.height]="scaledHeight"
            style="border:none;">
          </object>
        </div>
      </div>
                 
    </div>
    <div class="resizer"></div>
    <div [ngClass]="showPreview ? 'preview-summarize-pdf-card': 'summarize-pdf-card'">
      <button *ngIf="!showPreview" class="close_pdf" (click)="closeAi()">&times;</button>
      <div class="scrollable-card">
        <div *ngFor="let message of messages;let i = index">
          <ng-container *ngIf="message.content">
            <div class="main-container">

              <!-- User Message -->
              <div class="message user" *ngIf="message.role === 'user'">
                <div class="summarize-card">
                  {{ message.content }}
                </div>
                <div class="avatar">
                  <img src="{{authenticationService.MEDIA_URL+assetDetailsViewDtoOfPartner.loggedInUserProfileImage}}"
                    alt="User" class="avatar" (error)="errorHandler($event)">
                </div>
              </div>

              <!-- Assistant Message -->
              <div class="d-flex" *ngIf="message.role === 'assistant'">
                <div class="avatar1 col-lg-1 col-sm-1">
                  <img src="assets/images/olivermsglogo.svg" alt="Assistant" class="avatar">
                </div>
                <div class="col-lg-11 col-sm-11">
                  <div class="content-card">
                    <div class="chat-container">
                      <div #markdownComponent class="chat-history">
                        <markdown *ngIf="message?.isReport == 'false'" [data]="message.content"></markdown>
                        <app-executive-summary-report *ngIf="message?.isReport == 'true'" [activeTab]="activeTab" [reportData]="message.content">
                        </app-executive-summary-report>
                      </div>
                    </div>
                  </div>
                  <div class="footer-icons mb10" *ngIf="message?.isReport == 'false'">
                    <div class="footer-icon"
                      [ngStyle]="{'background-color': (isSpeakingText && speakingIndex === i) ? '#e40707' : '#0d6efd'}"
                      data-toggle="tooltip"
                      [attr.data-original-title]="!(isSpeakingText && speakingIndex === i) ? 'Read aloud' : 'stop'"
                      data-placement="top">
                      <i [ngClass]="(isSpeakingText && speakingIndex === i) ? 'fas fa-volume-mute' : 'fa fa-volume-up fs-12'"
                        aria-hidden="true" (click)="speakTextOn(i, markdownComponent)"></i>
                    </div>
                    <div class="footer-icon" [ngStyle]="{'background-color': isEmailCopied && copiedIndex === i ? '#00FF13' : '#0d6efd'}"
                      data-toggle="tooltip"
                      [attr.data-original-title]="isEmailCopied && copiedIndex === i  ? 'copied' : 'Copy to Clipboard'"
                      data-placement="top">
                      <i class="fs-12" [ngClass]="isEmailCopied && copiedIndex === i  ? 'fa fa-check' : 'fa fa-clone'"
                        (click)="!isEmailCopied && copyAiText(markdownComponent,i)"></i>
                    </div>
                    <!-- <div class="footer-icon" title="Reload/Refresh">
                    <i class="fa fa-refresh fs-12"></i>
                  </div> -->
                  <!-- <button *ngIf="!isPartnerLoggedIn && authenticationService?.module?.design && !authenticationService?.module?.isPrmCompany" class="share-btn"
                    (click)="openSelectionTemplate(markdownComponent)">Design Template</button>
                  <button *ngIf="authenticationService.module.damAccess" class="share-btn" (click)="createAsset(markdownComponent)">Design
                    Pdf</button>
                  <button *ngIf="authenticationService.module.hasLandingPageAccess &&!authenticationService?.module?.isPrmCompany" class="share-btn" (click)="desginPage(markdownComponent)">Design Page</button> -->
                  <div class="dropdown-container">
                    <button class="share-btn dropdown-toggle">Design</button>
                    <div class="dropdown-menu">
                      <button
                        *ngIf="!isPartnerLoggedIn && authenticationService?.module?.design && !authenticationService?.module?.isPrmCompany"
                        class="share-btn" (click)="openSelectionTemplate(markdownComponent)">Design Template</button>
                      <button *ngIf="authenticationService.module.damAccess" class="share-btn"
                        (click)="createAsset(markdownComponent)">Design Pdf</button>
                      <button *ngIf="authenticationService.module.hasLandingPageAccess &&  !authenticationService?.module?.isPrmCompany"
                        class="share-btn" (click)="desginPage(markdownComponent)">Design Page</button>
                        <button class="share-btn" (click)="openPptDesignPicker(markdownComponent)">Design PPT</button>
                    </div>
                  </div>
                  <button class="share-btn" (click)="openEmailModalPopup(markdownComponent)">Send Email</button>
                  <button *ngIf="socialShareOption" class="share-btn" (click)="openSocialShare(markdownComponent)">Social Share</button>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
        <!-- Assistant Loader -->
        <div class="d-flex main-container aligin-center" *ngIf="isLoading">
          <div class="avatar1 col-lg-1 col-sm-1">
            <img src="assets/images/olivermsglogo.svg" alt="Assistant" class="assitant">
          </div>
          <div class="col-lg-11 col-sm-11">
            <div class="status_message">{{statusMessage}}</div>
            <div class="assitLoader"></div>
          </div>
        </div>
      </div>

      <div>
        <div class="d-flex main-container">
          <div class="col-lg-1 col-sm-1 width_11"></div>
          <div class="form-section fixed-card col-lg-11 col-sm-11 width_89" style="margin-right: 18px;">
            <div class="panel-group" id="accordion">
              <div class="panel panel-default accordion_card">
                <div class="panel-heading accordion_card">
                  <h4 class="panel-title" *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner">
                    <a *ngIf="!isCollapsed && !isFromFolderView" (click)="toggleAction()"><span>
                        Asset Name:{{assetDetailsViewDtoOfPartner.assetName}} |
                        Folder:{{assetDetailsViewDtoOfPartner.categoryName}}</span>
                      <i class="fa fa-chevron-up toggle-icon"></i>
                    </a>
                    <a *ngIf="!isCollapsed && isFromFolderView" (click)="toggleAction()"><span>
                        Folder Name:{{folderName}} |
                        Created By:{{folderCreatedBy}}</span>
                      <i class="fa fa-chevron-up toggle-icon"></i>
                    </a>
                    <a *ngIf="isCollapsed" (click)="toggleAction()">
                      <span>
                        <div *ngIf="!isFromFolderView"  class="Ai_file">
                          <div class="Ai-icon" (click)="showAssetPreview()"[ngStyle]="showPreview ? {'width': '252px'} : {}">
                            <div class="d-flex document_flex">
                              <div *ngIf="isPdfUploading" class="fileloader mr10"></div>
                              <ng-container *ngIf="!isPdfUploading">
                                <img class="mr10" [src]="getFileIcon()" alt="file" width="28px" height="28px">
                              </ng-container>
                              <a title="{{ assetDetailsViewDtoOfPartner?.assetName }}">
                                {{ assetDetailsViewDtoOfPartner?.assetName | slice:0:20 }}
                                <span
                                  *ngIf="assetDetailsViewDtoOfPartner?.assetName?.length > 20">...</span>.{{assetDetailsViewDtoOfPartner?.assetType}}
                              </a>
                            </div>
                            <div class="published-on">{{UploadedFile ? 'Uploaded On' :'Published On'}}:{{
                              assetDetailsViewDtoOfPartner.displayTime | date:'MMM d, yyyy, h:mm a' }}
                            </div>
                          </div>
                          <div class="Ai-file-details">
                            <h5>Asset Name: {{assetDetailsViewDtoOfPartner?.assetName}}</h5>
                            <span class="aligin-para">
                              <p>Folder:{{assetDetailsViewDtoOfPartner?.categoryName}}</p>
                              <p>Published By:{{assetDetailsViewDtoOfPartner?.displayName}}</p>
                              <p *ngIf="!isOliverAiFromdam">From: {{assetDetailsViewDtoOfPartner?.vendorCompanyName}}
                              </p>
                            </span>
                          </div>
                        </div>
                        <div *ngIf="isFromFolderView" class="Ai_file">
                          <div class="Ai-icon" [ngStyle]="showPreview ? {'width': '252px'} : {}">
                            <div class="d-flex document_flex">
                              <div *ngIf="isPdfUploading" class="fileloader mr10"></div>
                              <ng-container *ngIf="!isPdfUploading">
                                <img class="mr10" src="assets/images/fileIconOliver.svg" alt="PDF" width="28px" height="28px">
                              </ng-container>
                              <a title="{{ folderName }}">
                                {{ folderName | slice:0:20 }}
                                <span *ngIf="folderName?.length > 20">...</span>
                              </a>
                            </div>
                            <div class="published-on">Created On:{{
                              folderCreatedOn | date:'MMM d, yyyy, h:mm a' }}
                            </div>
                          </div>
                          <div class="Ai-file-details">
                            <h5>Created By: {{folderCreatedBy}}</h5>
                            <span class="aligin-para">
                              <p>From:{{folderFrom}}</p>
                              <span class="Track-countbg">Digital Asset {{folderAssetCount}}</span>
                            </span>
                          </div>
                        </div>
                      </span>
                      <i class="fa fa-chevron-down toggle-icon"></i>
                    </a>
                  </h4>
                  <h4 class="panel-title" *ngIf="isFromContactJourney || isFromManageContact || isFromManagePartner">
                    <a *ngIf="!isCollapsed && selectedContact != undefined && callActivity == undefined" (click)="toggleAction()">
                      <div>
                        <span *ngIf="selectedContact.contactName">
                          Contact Name: {{selectedContact.contactName}} | </span><span>
                          Email Id: {{selectedContact.emailId}} </span><span *ngIf="!isFromManageContact && !isFromManagePartner"> | Recordings: {{chatGptSettingDTO.totalRecords == 0 || chatGptSettingDTO.totalRecords == undefined ? '0' : chatGptSettingDTO.totalRecords}}</span>
                      </div>
                      <i class="fa fa-chevron-up toggle-icon"></i>
                    </a>
                    <a *ngIf="!isCollapsed && callActivity != undefined" (click)="toggleAction()">
                      <div>
                        <span>
                          {{callActivity.direction | slice:0:35}} Call | </span>
                        <span>
                          {{(callActivity.direction=='Incoming' || callActivity.direction=='Missed')?'From:':'To:'}}
                          {{callActivity.callInfoString}} | Duration: {{callActivity.duration}}</span>
                      </div>
                      <i class="fa fa-chevron-up toggle-icon"></i>
                    </a>
                    <a *ngIf="isCollapsed && selectedContact != undefined && callActivity == undefined" (click)="toggleAction()">
                      <div class="Ai_file">
                        <div class="Ai-icon" [ngStyle]="showPreview ? {'width': '252px'} : {}">
                          <div class="d-flex document_flex">
                            <div *ngIf="ngxLoading" class="fileloader mr10"></div>
                            <ng-container *ngIf="!ngxLoading">
                              <img *ngIf="selectedContact.imageSourcePath != undefined" class="mr10"
                                src="{{selectedContact.imageSourcePath}}" alt="CONTACT" width="28px" height="28px">
                              <img *ngIf="selectedContact.imageSourcePath == undefined" class="mr10"
                                src="assets/admin/pages/media/works/contacts2.png" alt="CONTACT" width="28px" height="28px">
                            </ng-container>
                            <a *ngIf="selectedContact?.contactName" title="{{ selectedContact?.contactName }}">
                              {{ selectedContact?.contactName | slice:0:25 }}
                              <span *ngIf="selectedContact?.contactName?.length > 25">...</span>
                            </a>
                            <a *ngIf="selectedContact?.contactName == undefined || selectedContact?.contactName?.length == 0"
                              title="{{ selectedContact?.emailId }}">
                              {{ selectedContact?.emailId | slice:0:25 }}
                              <span *ngIf="selectedContact?.emailId?.length > 25">...</span>
                            </a>
                          </div>
                          <div *ngIf="selectedContact?.contactName" class="published-on">Email Id: {{selectedContact.emailId }}
                          </div>
                        </div>
                        <div class="Ai-file-details">
                          <span class="aligin-para">
                            <p *ngIf="selectedContact?.mobileNumber"><b>Mobile Number:</b> {{selectedContact.mobileNumber}}</p>
                          </span>
                          <span class="Track-countbg" *ngIf="!isFromManageContact && !isFromManagePartner">
                            <p *ngIf="chatGptSettingDTO.totalRecords == undefined || chatGptSettingDTO.totalRecords == 0">Recordings: 0
                            </p>
                            <p *ngIf="chatGptSettingDTO.totalRecords > 0">Recordings: {{chatGptSettingDTO.totalRecords}}</p>
                          </span>
                        </div>
                      </div>
                      <i class="fa fa-chevron-down toggle-icon"></i>
                    </a>
                    <a *ngIf="isCollapsed && callActivity != undefined" (click)="toggleAction()">
                      <div class="Ai_file">
                        <div class="Ai-icon" [ngStyle]="showPreview ? {'width': '252px'} : {}">
                          <div class="d-flex document_flex">
                            <div *ngIf="ngxLoading" class="fileloader mr10"></div>
                            <ng-container *ngIf="!ngxLoading">
                              <img class="mr10" *ngIf="callActivity.direction == 'Outgoing'"
                                src="assets/admin/pages/media/works/outgoing-call.png" alt="CONTACT" width="28px" height="28px">
                              <img class="mr10" *ngIf="callActivity.direction == 'Incoming'"
                                src="assets/admin/pages/media/works/incoming-call.png" alt="CONTACT" width="28px" height="28px">
                            </ng-container>
                            <a *ngIf="callActivity?.direction" title="{{ callActivity?.direction }}">
                              {{callActivity.direction | slice:0:35}} Call
                              <span *ngIf="callActivity?.direction?.length > 25">...</span>
                            </a>
                          </div>
                          <div class="published-on">{{(callActivity.direction=='Incoming' || callActivity.direction=='Missed')?'From:':'To:'}}
                            {{callActivity.callInfoString}}
                          </div>
                        </div>
                      </div>
                      <div class="Ai-file-details">
                        <span class="aligin-para">
                          <p *ngIf="callActivity?.mobileNumber"><b>Mobile Number:</b> {{callActivity.mobileNumber}}</p>
                        </span>
                        <span class="Track-countbg">
                          <p>Duration: {{callActivity.duration}}</p>
                        </span>
                      </div>
                      <i class="fa fa-chevron-down toggle-icon"></i>
                    </a>
                  </h4>
                </div>
                <div id="collapseOne" class="panel-collapse collapse in">
                  <div class="panel-body">
                    <input type="text" class="form-control" (keypress)="searchDataOnKeyPress($event.keyCode)"
                      [(ngModel)]="inputText" (input)="validateInputText()" placeholder="Ask me!">
                  </div>
                </div>
              </div>
            </div>
            <div class="action-buttons">
              <div *ngIf="!isFromFolderView">
                <!-- <button class="history-plusicon" (click)="pdfInput.click()">
              <span class="fa fa-plus"></span>
              <input type="file" accept="application/pdf" (change)="onFileSelected($event)" #pdfInput
                style="display: none;" />
            </button> -->
            <button *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="action-btn" (click)="setInputText('Analyze Asset')">Analyze Asset</button>
            <button *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="action-btn" (click)="setInputText('Summarize in detail')">Summarize in detail</button>
            <button *ngIf="!isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="action-btn" (click)="setInputText('Summarize with Key Quotes')">Summarize with Key
              Quotes</button>
            <button *ngIf="isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="action-btn" (click)="setInputText('Analyze the files.')">Analyze the files</button>
            <button *ngIf="isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="action-btn" (click)="setInputText('Summarize in detail')">Summarize in detail</button>
            <button *ngIf="isFromContactJourney && !isFromManageContact && !isFromManagePartner" class="action-btn" (click)="setInputText('Summarize with Key Insights')">Summarize with Key
              Insights</button>
            <button *ngIf="isFromManageContact" class="btn btn-pdf" (click)="setInputText('Give me the details of the contact')">Give me the details of the contact</button>
            <button *ngIf="isFromManageContact" class="btn btn-pdf" (click)="setInputText('Generate an Executive Summary of the contact')">Generate an Executive Summary...</button>
            <button *ngIf="isFromManageContact" class="btn btn-pdf" (click)="setInputText('Generate a QBR of the contact')">Generate a QBR of the contact</button>
            <button *ngIf="isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Give me the details of partner')">Give me the details of partner</button>
            <button *ngIf="isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Generate an Executive Summary of the partner')">Generate an Executive Summary...</button>
            <button *ngIf="isFromManagePartner" class="btn btn-pdf" (click)="setInputText('Generate a QBR of the partner')">Generate a QBR of the partner</button>
              
              </div>
              <div *ngIf="isFromFolderView">
                <button class="action-btn" (click)="setInputText('Generate summaries')">Generate summaries</button>
                <button class="action-btn" (click)="setInputText('Compare documents')">Compare documents</button>
                <button class="action-btn" (click)="setInputText('Give an overview of documents')">Give an overview of documents</button>
              </div>

              <div>
                <!-- XNFR-986 -->
                <button *ngIf="oliverPromptSuggestionDTOs?.length > 0" class="image-only-button" style="padding-right: 6px; height: 25px;" (click)="!assetLoader && openPrompts()">
                  <img data-toggle="tooltip" data-placement="top" title="Prompt Suggestions"
                    src="assets/images/oliver-promps-icon.svg" alt="Suggested Prompts">
                </button>
                <button class="submit-btn" [disabled]="isLoading || isPdfUploading || inputText == ''" (click)="AskAiTogetData()">
                  Submit</button>
              </div>
            </div>
            <div *ngIf="oliverPromptSuggestionDTOs?.length > 0 && (showPromptBoxAbove || showInsightPromptBoxAbove)">
              <div class="suggestion-direction"></div>
              <ng-container *ngTemplateOutlet="displayPrompts"></ng-container>
            </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- XNFR-986 -->
<ng-template #displayPrompts>
  <div style="margin-top: 8px;" class="suggestion-box-input" id="suggestionBox">
    <div class="suggestion-list">
      <div *ngFor="let prompt of oliverPromptSuggestionDTOs"
        (click)="setSuggestedInputText(prompt.promptMessage, prompt.id)">
        {{prompt.promptMessage}}
      </div>
    </div>
  </div>
</ng-template>
<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="page-content">
  <div class="page-bar">
    <ul class="page-breadcrumb">
       <li><i class="fa fa-home" aria-hidden="true"></i> <a translate>Home</a> 
          <i class="fa fa-angle-right" aria-hidden="true"></i>
       </li>
       <li><a translate>Campaign Analytics</a></li>
    </ul>
 </div>
 <div class="row">
   <div class="col-md-12 col-lg-12">
      <div class="portlet light" style="height:198px;">
         <div class="row" style="margin-top: 20px;">
            <app-box-loader [countLoader]=3 *ngIf="tilesLoader"></app-box-loader>
            <div *ngIf="!tilesLoader" class="col-md-12 col-lg-12" style="padding-left: 24px;padding-right: 30px;">
               <div class="row">
                  <div  id="vendor-details-tile" class="{{tileClass}}">
                     <div class="row">
                         <div class="flex margin-flex">
                             <span class='profile'>
                                 <span class='uppercase'>{{mdfPartnerDto?.contactCompany |slice:0:1}}</span>
                                 </span>
                                 <span class="margin-left" style="margin-left: 20px;">
                                     <h6 class='m0 user-email' *ngIf="mdfPartnerDto?.contactCompany?.length>0">
                                         <p class="user-company" title="{{mdfPartnerDto?.contactCompany}}">
                                             <span>{{mdfPartnerDto?.contactCompany |slice:0:23}}</span>
                                             <span *ngIf="mdfPartnerDto?.contactCompany?.length>23">..</span>
                                         </p>
                                       </h6>
                                       <br>
                                       <h5 *ngIf="mdfPartnerDto?.fullName?.length>0" class='ellipsis user-name' title="{{mdfPartnerDto?.fullName}}">
                                           {{mdfPartnerDto?.fullName | slice:0:27}}
                                         <span *ngIf="mdfPartnerDto?.fullName?.length>27">..</span>
                                        </h5>
                                        <a style="display: table;" title="{{mdfPartnerDto?.emailId}}">
                                         {{mdfPartnerDto?.emailId | slice:0:30}}<span *ngIf="mdfPartnerDto?.emailId?.length>30">...</span></a>
                                 </span>
                             </div>
                     </div>
                  </div>
                  <div title="Click to see details" class="{{tileClass}}">
                     <a class="dashboard-stat dashboard-stat-lighter green-soft">
                        <div class="visual">
                           <i aria-hidden="true" class=""></i>
                        </div>
                        <div class="details">
                           <div class="number">{{totalCampaignsCount}}</div>
                           <div class="desc">Total Campaigns</div>
                        </div>
                        <span class="morePadding">
                     <a  translate="" ng-reflect-translate="" class="more">Detailed view  
                     <i  aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                     </span>
                     </a>
                  </div>
                  <div title="Click to see details" class="{{tileClass}}">
                     <a class="dashboard-stat dashboard-stat-lighter purple-soft">
                        <div class="visual">
                           <i aria-hidden="true" class=""></i>
                        </div>
                        <div class="details">
                           <div class="number">{{activeCampaignsCount}}</div>
                           <div class="desc">Active Campaigns</div>
                        </div>
                        <span class="morePadding">
                     <a  translate="" ng-reflect-translate="" class="more">Detailed view  
                     <i  aria-hidden="true" class="m-icon-swapright m-icon-white"></i></a>
                     </span>
                     </a>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

 <div class="row">
  <div class="portlet box">
     <div class="clearfix">
        <div class="col-xs-12">
           <!-- BEGIN EXAMPLE TABLE PORTLET-->
           <div class="portlet box blue">
              <div class="portlet-title">
                 <div class="caption" translate>
                    <i class="fa fa-list" style="font-size: 19px;" aria-hidden="true"></i>
                    Campaign Analytics
                 </div>
                 <div class="inputs" align="right" style="float: right; padding: 4px">
                    <div style="float: left; margin: 0 10px;">
                      <select class="form-control" [(ngModel)]="sortOption.userLevelCampaignAnalyticsSortOption" (ngModelChange)="sortBy($event)">
                        <option *ngFor="let option of sortOption.userLevelCampaignAnalyticsSortDropDownOptions"
                            [ngValue]="option" translate>
                            {{option.name}}</option>
                    </select>
                    </div>
                    <div class="portlet-input input-inline">
                       <div class="input-icon right">
                          <input type="text" id="sort-text" class="form-control" [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}" placeholder="Search" (keypress)="eventHandler($event.keyCode)">
                          <button class="glyphicon glyphicon-remove search-box-item-clear"  *ngIf="sortOption.searchKey" (click)="sortOption.searchKey='';searchCampaigns();"></button>
                          <button type="submit" class="search-box-item-click" (click)="searchCampaigns()"><i class="fa fa-search" style="color:black !important" aria-hidden="true"></i></button>
                       </div>
                    </div>
                 </div>
              </div>
              <app-list-loader *ngIf="listLoader.isLoading"></app-list-loader>
              <div class="portlet-body table-responsive" style="overflow: hidden;" *ngIf="!listLoader.isLoading">
                 <div class="btn-group pull-right" style="margin-bottom: 10px; left: -16px;">
                    <div class="inputs" align="right" style="float: right"></div>
                 </div>
                 <div class="clearfix">
                    <div class="col-xs-12" style="padding: 10px 0;">
                       <div class="table-responsive">
                          <table class='table tgrid' aria-describedby="user-campaigns-list-table">
                             <thead>
                                <tr>
                                   <th translate>Campaign Name</th>
                                   <th  translate>Launched On</th>
                                   <th  translate>Latest View</th>
                                   <th  translate>Email Opened</th>
                                   <th translate>Clicked URLs</th>
                                   <th translate>Auto Responses</th>
                                   <th translate>History</th>
                                </tr>
                             </thead>
                             <tbody>
                              <ng-container *ngFor="let campaignAnalytics of pagination.pagedItems;let i=index">
                                <tr>
                                  <td title="Click to see campaign analytics">
                                    <a (click)="goToCampaignAnalytics(campaignAnalytics?.campaignId)">{{campaignAnalytics?.campaignName}}</a>
                                </td>
                                <td>
                                 <span *ngIf="!referenceService.isSafariBrowser()">{{campaignAnalytics?.launchedDisplayTime |date:'mediumDate'}} {{campaignAnalytics?.launchedDisplayTime |date:'shortTime'}}</span>
                                 <span *ngIf="referenceService.isSafariBrowser()">{{campaignAnalytics?.launchedDisplayTime}}</span>
                              </td>
                                  <td>
                                     <ng-container *ngIf="campaignAnalytics?.latestViewDisplayTime!='-'">
                                       <span *ngIf="!referenceService.isSafariBrowser()">{{campaignAnalytics?.latestViewDisplayTime |date:'mediumDate'}} {{campaignAnalytics?.latestViewDisplayTime |date:'shortTime'}}</span>
                                       <span *ngIf="referenceService.isSafariBrowser()">{{campaignAnalytics?.latestViewDisplayTime}}</span>
                                     </ng-container>
                                     <ng-container *ngIf="campaignAnalytics?.latestViewDisplayTime=='-'">
                                       <span>-</span>
                                    </ng-container>
                                  </td>
                                  <td>
                                    {{campaignAnalytics?.emailOpenedCount}}
                                  </td>
                                  <td>
                                    {{campaignAnalytics?.clickedUrlsCount}}
                                  </td>
                                  <td>
                                    <div class="actions-block" (click)="$event.stopPropagation()">
                                       <span class="circled-number" *ngIf="campaignAnalytics?.autoResponsesCount==0"
                                         style="margin-right: 50px;cursor: not-allowed">{{campaignAnalytics?.autoResponsesCount}}</span>
                                       <span class="circled-number" *ngIf="campaignAnalytics?.autoResponsesCount>0">
                                         {{campaignAnalytics?.autoResponsesCount}}</span>
                                       <a *ngIf="campaignAnalytics?.autoResponsesCount>0"
                                         (click)="$event.stopPropagation();showAutoResponseAnalytics(campaignAnalytics,i)"
                                         title="View Auto Response Analytics">
                                         <i class="fa"
                                           [ngClass]="{'fa-plus': !campaignAnalytics?.expanded, 'fa-minus': campaignAnalytics?.expanded}" aria-hidden="true"></i>
                                       </a>
                                       
                                     </div>
                                  </td>
                                  <td>
                                    <div class="actions-block" (click)="viewTimeLine(campaignAnalytics)" >
                                       <a title="View History">
                                          <i class="fa fa-history action-btn" aria-hidden="true"></i>
                                          </a>
                                       </div>
                                  </td>
                               </tr>
                                </ng-container>
                             </tbody>
                          </table>
                          <div *ngIf="pagination.pagedItems.length !== 0">
                            <app-pagination [pagination]="pagination" (notifyParent)="setPage($event)" (notifyParentDropDown)="listCampaignAnalytics($event)" [hidden]="listLoader.isLoading">
                            </app-pagination>
                        </div>
                        <div *ngIf="pagination.totalRecords==0 && !listLoader.isLoading" class="alert alert-info">
                            <strong>No Data Found.</strong>
                        </div>
                       </div>
                    </div>
                 </div>
              </div>
           </div>
           <!-- END EXAMPLE TABLE PORTLET-->
        </div>
     </div>
  </div>
</div>

</div>

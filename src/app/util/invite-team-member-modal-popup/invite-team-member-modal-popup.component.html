<ngx-loading [show]="ngxLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="modal fade right" id="invite_team_member_modal" role="dialog" aria-labelledby="myModalLabel"
  data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <a class="close-circle" (click)="closeModalPopup()" data-dismiss="modal">
          <i class="fa fa-times"></i></a>
        <h4 class="modal-title left" id="myModalLabel"> {{ tableHeader }} </h4>
      </div>
      <div class="modal-body">
        <app-modal-popup-loader *ngIf="isPopupLoading"></app-modal-popup-loader>
        <app-response-message [customResponse]="customResponse" *ngIf="customResponse?.isVisible"
          [showCloseIcon]="!isValidationMessage"></app-response-message>
        <div *ngIf="!isValidationMessage && !isPopupLoading">
          <!----- Email Ids ----->
          <div class="form-group">
            <label for="emailInput">To <span class="required">*</span></label>
            <tag-input [(ngModel)]='emailIds' #tagInput name="emails" #email="ngModel" [errorMessages]="errorMessages"
              [validators]="validators" [separatorKeyCodes]="[32,188,186,13,9]" [placeholder]="'Add email'"
              [secondaryPlaceholder]="'Enter email address(es)'" [clearOnBlur]="true" [addOnPaste]="true"
              [addOnBlur]="true" [pasteSplitPattern]="splitPattern" [onAdding]="onAddedFunc" theme='bootstrap'
              [onTextChangeDebounce]="40" required>
            </tag-input>
          </div>
          <!----- Team Member Group ----->
          <div class="form-group">
            <label>Team Member Group <span class="required">*</span></label>
            <div class="d-flex">
              <select class="form-control" (ngModelChange)="getPartnersCount($event)" [(ngModel)]="teamMemberGroupId"
                [ngModelOptions]="{standalone: true}">
                <option *ngFor="let teamMemberGroup of teamMemberGroups" [ngValue]="teamMemberGroup.id">
                  {{teamMemberGroup.name}}
                  <ng-template [ngTemplateOutlet]="defaultSSOGroupTextTemplate"
                    [ngTemplateOutletContext]="{teamMemberGroup:teamMemberGroup}"></ng-template>
                </option>
              </select>
              <button class="btn btn-info" [disabled]="teamMemberGroupId==0" data-toggle="tooltip"
                data-placement="bottom" title="click to view available modules "
                (click)="previewModules(teamMemberGroupId)">
                <i class="fa fa-eye white" aria-hidden="true"></i>
              </button>
            </div>
            <span *ngIf="teamMemberGroupId!=0 && !authenticationService?.module?.isOnlyPartnerCompany" class="info-text-color">
              <strong>
                <span [className]="teamMemberGroupPartnersCount>0 ? 'active-status' : 'inactive-status'">
                  {{teamMemberGroupPartnersCount}}</span>
                {{authenticationService?.partnerModule?.customName}} will be assigned to this team member
              </strong>
            </span>
          </div>
          <!----- Template Subject ----->
          <div class="form-group">
            <label>Email subject <span class="required">*</span></label>
            <input type="text" [(ngModel)]="vendorInvitation.subject" [ngModelOptions]="{standalone: true}"
              placeholder="Subject Line" class="form-control" name="subjectLine" maxlength="200" disabled />
          </div>
          <!----- Template Body ----->
          <div class="form-group">
            <label>Message <span class="required">*</span></label>
          </div>
          <div class="form-group" style="cursor: not-allowed;">
            <span [innerHTML]="inviteTeamMemberHtmlBody" class="plspx" style="pointer-events: none;"></span>
          </div>
        </div>
      </div>
      <div class="modal-footer" style="border: none">
        <button class="btn Btn-Gray neg_mrg_top4" (click)="closeModalPopup()" data-dismiss="modal">Cancel</button>
        <button type="submit" class="button bgcolor-unset"
          [disabled]="emailIds.length == 0 || !vendorInvitation.subject || isValidationMessage || teamMemberGroupId==0"
          (click)="sendTeamMemberInviteEmail()">
          <span class="btn Btn-Green transition txt_pd-top3">Send
            <i aria-hidden="true" class="fa fa-send"></i></span></button>
      </div>
    </div>
  </div>
</div>

<!--- Group Preview Popup --->
<app-team-member-group-preview-popup *ngIf="showModulesPopup" [teamMemberGroupId]="teamMemberGroupId"
  (previewGroupPopupEventEmitter)="hideModulesPreviewPopUp()"></app-team-member-group-preview-popup>
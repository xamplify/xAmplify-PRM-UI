<div *ngIf="!showAskOliverModalPopup">

<app-content-module-status-analytics [moduleType]="type" (filterContentByType)="filterContentByType($event)" [showApprovalTiles]="isApprovalRequiredForType()" [isPartnerView]="isPartnerView"
    *ngIf="!folderListViewExpanded">
</app-content-module-status-analytics>

<div [className]="folderListView ? 'message-class-folder-list':'message-class'">
    <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
</div>
<div class="row">
    <ngx-loading [show]="ngxloading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
    <div class="col-xs-12 col-sm-12 col-md-12 mTop mrg_top0">
        <div class="portlet light remove_cardBgcolor padding_0 clearfix light_bg_removal remove_space">
            <!--List/Grid View-->
            <div *ngIf="modulesDisplayType.isListView || modulesDisplayType.isGridView">
                <div class="portlet-title" style="border-bottom: none">
                    <div *ngIf="showRefreshNotification && !httpRequestLoader?.isLoading" class="alert alert-info">
                        <strong>Please <a (click)="listLearningTracks(pagination)">click here</a> to find latest
                            updates</strong>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 col-sm-4 col-lg-3" style="padding-left: 5px;">
                            <h4 class="pull-left m10 text-primary">{{suffixHeader}}{{titleHeader}}</h4>
                        </div>
                        <div class="page-toolbar col-xs-12 col-sm-8 col-lg-9" style="padding-top: 4px;"
                            *ngIf="!modulesDisplayType.isFolderGridView && !modulesDisplayType.isFolderListView">
                            <div class="btn-group pull-right mb10" style="display: flex;">
                                <button *ngIf="!isPartnerView" class="btn btn-primary mr7" style="border-radius: 7px;" (click)="navigateToAdd()">Add {{trackOrPlayBookText | titlecase}}</button>
                                <div class="">
                                    <div class="group-dropdown">
                                        <button
                                            [ngClass]="modulesDisplayType.isListView ? 'fa fa-th-list btn-xs l-g-view mr7' :modulesDisplayType.isGridView ?'fa fa-th-large btn-xs l-g-view mr7':
                                                modulesDisplayType.isFolderListView ? 'fa fa-th btn-xs l-g-view mr7': modulesDisplayType.isFolderGridView ?'fa fa-folder btn-xs l-g-view mr7':'fa fa-th-list btn-xs l-g-view mr7'"
                                            style="padding: 10px !important"></button>
                                        <div class="group-dd-content">
                                            <ng-container class='m10'>
                                                <span class="btn btn-xs l-g-view"[ngClass]="{'disabled-div': modulesDisplayType.isListView}" data-toggle="tooltip"
                                                    data-placement="bottom" title="List View"
                                                    (click)="!modulesDisplayType.isListView && setViewType('l')">
                                                    <i class="fa fa-th-list p10" aria-hidden="true" [class.disabled]="modulesDisplayType.isListView"></i>
                                                </span>
                                                <span class="btn btn-xs l-g-view margin-space" [ngClass]="{'disabled-div': modulesDisplayType.isGridView}"
                                                    data-toggle="tooltip" data-placement="bottom" title="Grid View"
                                                    (click)="!modulesDisplayType.isGridView && setViewType('g')">
                                                    <i class="fa fa-th-large p10" aria-hidden="true" [class.disabled]="modulesDisplayType.isGridView"></i>
                                                </span>
                                                <!----XNFR-170---->
                                                <ng-container *ngIf="!showUpArrowButton && !folderListView">
                                                    <span class="btn btn-xs l-g-view margin-space"
                                                        data-toggle="tooltip" data-placement="bottom"
                                                        title="Folder Grid View" (click)="setViewType('fg')">
                                                        <i class="fa fa-folder p10" aria-hidden="true"></i>
                                                    </span>
                                                    <span
                                                        class="btn btn-xs  l-g-view margin-space folder-list-span-custom-width"
                                                        data-toggle="tooltip" data-placement="bottom"
                                                        title="Folder List View" (click)="setViewType('fl')">
                                                        <i class="fa fa-th p10" aria-hidden="true"></i>
                                                    </span>
                                                </ng-container>
                                            </ng-container>
                                        </div>
                                    </div>
                                    <span *ngIf="showUpArrowButton" class="btn btn-xs l-g-view margin-space"
                                        data-toggle="tooltip" data-placement="bottom" title="Go back"
                                        (click)="setViewType('fg')" style="margin-top: -5px !important;">
                                        <i class="fa fa-arrow-up p10" aria-hidden="true"></i>
                                    </span>
                                </div>
                                <div class="inputs mDamTop align_mflex float-right">
                                    <a class="close-circle ref-mar" (click)="refreshPage()" title="Refresh"
                                        data-toggle="tooltip" data-placement="bottom">
                                        <i class="fa fa-refresh" aria-hidden="true"></i>
                                    </a>
                                    <div class="pb3 float-left mr7">
                                        <select *ngIf="!isPartnerView"
                                            class="form-control mDamSort SeclectBoxPaddingsAbj"
                                            [(ngModel)]="sortOption.damSortOption" (ngModelChange)="sortTracks($event)"
                                            style="position: relative;">
                                            <option *ngFor="let option of sortOption.damSortDropDownOptions"
                                                [ngValue]="option">{{option.name}}</option>
                                        </select>
                                        <select *ngIf="isPartnerView"
                                            class="form-control mDamSort SeclectBoxPaddingsAbj"
                                            [(ngModel)]="sortOption.damSortOptionForPartner"
                                            (ngModelChange)="sortTracks($event)"
                                            style="position: relative;">
                                            <option *ngFor="let option of sortOption.damSortDropDownOptionsForPartner"
                                                [ngValue]="option">{{option.name}}</option>
                                        </select>
                                    </div>
                                    <div class="portlet-input input-inline input-small" style="margin-right: 8px;">
                                        <div class="input-icon right mDamSearch rSearch"
                                            style="position: relative;">
                                            <input type="text" style="height: 34px;" class="form-control"
                                                [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}"
                                                placeholder="search..." (keypress)="eventHandler($event.keyCode)">
                                            <button class="glyphicon glyphicon-remove search-box-item-clear"
                                                *ngIf="sortOption.searchKey"
                                                (click)="sortOption.searchKey='';searchLearningTracks();"></button>
                                            <button type="submit" class="search-box-item-click"
                                                (click)="searchLearningTracks()">
                                                <i class="fa fa-search" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <!---End-->
                            </div>
                        </div>
                    </div>
                </div>
                <app-grid-loader *ngIf="httpRequestLoader.isLoading && modulesDisplayType.isGridView"></app-grid-loader>
                <app-list-loader
                    *ngIf=" httpRequestLoader.isLoading && modulesDisplayType.isListView"></app-list-loader>
                <section *ngIf="modulesDisplayType.isListView">
                    <ng-container *ngIf="!httpRequestLoader.isLoading">
                        <div class="table-responsive pd_top10">
                            <table class='table tgrid table-hover table-sm' id="manage-lms-list-table"
                                *ngIf="pagination.pagedItems?.length>0" aria-describedby="lms-list">
                                <thead>
                                    <tr>
                                        <th class="hidden-xs" colspan="2" style="width: 35%" id="border-bottom">
                                            <span class="ui-column-resizer gray"
                                                (mousedown)="referenceService.onMouseDown($event,'manage-lms-list-table',2)"></span>
                                            <span *ngIf="type == undefined || (type != undefined && type == 'TRACK')"
                                                class="gridHeader">Track</span>
                                            <span *ngIf="type != undefined && type == 'PLAYBOOK'"
                                                class="gridHeader">Playbook</span>
                                        </th>
                                        <th class="visible-xs" colspan="1" style="width: 45%" id="border-bottom">
                                            <span class="ui-column-resizer gray"
                                                (mousedown)="referenceService.onMouseDown($event,'manage-lms-list-table',1)"></span>
                                            <span *ngIf="type == undefined || (type != undefined && type == 'TRACK')"
                                                class="gridHeader" translate>Track</span>
                                            <span *ngIf="type != undefined && type == 'PLAYBOOK'"
                                                class="gridHeader">Playbook</span>
                                        </th>
                                        <th class="hidden-xs text-center" style="width: 15%;" translate scope="col"
                                            id="border-bottom">Tags</th>
                                        <th class="hidden-xs text-center" style="width: 15%;" translate scope="col"
                                            id="border-bottom">
                                            <span *ngIf="isPartnerView">Published On</span>
                                            <span *ngIf="!isPartnerView">Created On</span>
                                        </th>
                                        <ng-container *ngIf="isPartnerView && authenticationService?.companyProfileName !== 'versa-networks'">
                                            <th *ngIf="type == undefined || type == 'TRACK' || type == 'PLAYBOOK'" class="text-center"
                                                style="width: 15%;" translate id="border-bottom">Progress</th>
                                            <!-- <th *ngIf="type != undefined && type == 'PLAYBOOK'" class="text-center"
                                                id="border-bottom"></th> -->
                                        </ng-container>
                                        <ng-container *ngIf="!isPartnerView">
                                            <th class="text-center" id="border-bottom"></th>
                                        </ng-container>
                                        <th class="text-center" id="min-width" translate id="border-bottom">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let learningTrack of pagination.pagedItems ;let i =index">
                                        <!-- XNFR-1001  -->
                                        <td class="hidden-xs text-center" style="width: 10%;">
                                            <img class="img-track-list" *ngIf="!referenceService.isCloudFront"  [src]="learningTrack.featuredImage"
                                                onerror="this.src='assets/images/content/image.png';"
                                                alt="{{learningTrack?.title}}">
                                                <img class="img-track-list" *ngIf="referenceService.isCloudFront" [src]="learningTrack.cdnFeaturedImage"
                                                onerror="this.src='assets/images/content/image.png';"
                                                alt="{{learningTrack?.title}}">
                                        </td>
                                        <!-- XNFR-1001  -->
                                        <td>
                                            <h4 class="mt5 mb5 moreipsis" data-toggle="tooltip" data-placement="top"
                                                title="{{learningTrack.title}}">
                                                <span><b>{{titleHeader}} Title:</b> {{learningTrack.title}}</span>
                                            </h4>
                                            <h6 class="moreipsis">
                                                <span data-toggle="tooltip" data-placement="top"
                                                    title="{{learningTrack?.category?.name}}">
                                                    <b>Folder: </b> {{learningTrack?.category?.name}}
                                                </span>
                                            </h6>
                                            <h6 class="moreipsis">
                                                <span data-toggle="tooltip" data-placement="top"
                                                    title="{{learningTrack.createdByName}}"> <b>Created By: </b>
                                                    {{learningTrack.createdByName}}
                                                </span>
                                            </h6>
                                            <!-- XNFR-897 -->
                                            <h6 class="moreipsis" *ngIf="referenceService?.expireDescription(learningTrack.expireDate,tracksModule)">
                                                <span class="text-danger" data-toggle="tooltip" data-placement="top"
                                                title="{{referenceService?.expireDescription(learningTrack.expireDate,tracksModule)}}">
                                                    {{referenceService?.expireDescription(learningTrack?.expireDate,tracksModule)}}
                                                </span>
                                            </h6>
                                            <!-- XNFR-824 -->
                                            <span *ngIf="isApprovalRequiredForType() && !isPartnerView" class="view-banner" [ngClass]="{
                                                    'bgc-green': learningTrack?.approvalStatus === approvalStatus.APPROVED,
                                                    'bgc-red': learningTrack?.approvalStatus === approvalStatus.REJECTED,
                                                    'bgc-orange': learningTrack?.approvalStatus === approvalStatus.CREATED}" style="white-space: nowrap;" translate>
                                                {{getApprovalStatusText(learningTrack.approvalStatus)}}
                                            </span>
                                            <span style="white-space: nowrap;"
												*ngIf="!isApprovalRequiredForType() && !isPartnerView && learningTrack.approvalStatus == approvalStatus.REJECTED"
												class="view-banner asset-approval-labele-spacing bgc-red" translate>
												{{getApprovalStatusText(learningTrack.approvalStatus)}}
											</span>
                                            <h6 *ngIf="isPartnerView && learningTrack?.partnerStatus === 'deactivated'" class="green-banner inline-flex"
                                                data-toggle="tooltip" data-placement="top" title="Partnership is deactivated">DEACTIVATED</h6>
                                        </td>
                                        <td class="hidden-xs text-center">
                                            <ng-container *ngIf="learningTrack.tagNames?.length > 0">
                                                <div class="tag tablegray-tag">
                                                    <span data-toggle="tooltip" data-placement="top"
                                                        title="{{learningTrack.tagNames[0]}}">{{learningTrack.tagNames[0]}}</span>
                                                </div>
                                                <ng-container *ngIf="learningTrack.tagNames.length > 1">
                                                    <div class="tag tablegray-tag">
                                                        <span data-toggle="tooltip" data-placement="top"
                                                            title="{{learningTrack.tagNames[1]}}">{{learningTrack.tagNames[1]}}</span>
                                                    </div>
                                                </ng-container>
                                                <span *ngIf="learningTrack.tagNames?.length>2" class="tag-dots"
                                                    data-toggle="tooltip" data-placement="top"
                                                    title="{{learningTrack.toolTipTagNames}}">More</span>
                                            </ng-container>
                                        </td>
                                        <td class="hidden-xs text-center">
                                            <app-timestamp style="display: block;margin-bottom: 4px;"
                                                [isOnlyDate]="true"
                                                [dateAndTime]="learningTrack.createdDateString"></app-timestamp>
                                            <!---XNFR-327-->
                                            <h6 *ngIf="learningTrack?.published && !isPartnerView && !learningTrack?.publishingOrWhiteLabelingInProgress && !learningTrack?.publishingToPartnerList"
                                                class="green-banner inline-flex">Published</h6>
                                            <!---XNFR-327-->
                                        </td>
                                        <td>
                                            <div *ngIf="isPartnerView && (type == undefined || type == 'TRACK' || type == 'PLAYBOOK') && authenticationService?.companyProfileName !== 'versa-networks'"  class="text-center">
                                                <div class="progress">
                                                    <div class="progress-bar" data-toggle="tooltip" data-placement="top"
                                                        title="{{learningTrack.progress}}%"
                                                        [ngStyle]="{'width': learningTrack.progress + '%'}"
                                                        style="border-radius:1px;" role="progressbar"></div>
                                                </div>
                                                <span
                                                    *ngIf="learningTrack.progress != undefined">{{learningTrack.progress}}%</span>
                                                <span *ngIf="learningTrack.progress == undefined">0%</span>
                                            </div>
                                        </td>
                                        <td id="actions-row" class="text-center mActionAlign">
                                            <div *ngIf="!learningTrack?.publishingOrWhiteLabelingInProgress && !learningTrack?.publishingToPartnerList"
                                                class="actions-block override-actions custom-width-icon mb_whitespace"
                                                [ngClass]="{actionAlignment : !isPartnerView}">
                                                <a class="custom-icon"
                                                    *ngIf="learningTrack.canUpdate && !isPartnerView"
                                                    data-toggle="tooltip" data-placement="top" title="Preview & Edit"
                                                    (click)="edit(learningTrack.id)">
                                                    <i class="fa fa-pencil-square-o IconCustomization"
                                                        aria-hidden="true"></i>
                                                    <div class="clickicons"></div>
                                                </a>
                                                <a class="custom-icon"
                                                    *ngIf="learningTrack.published && !isPartnerView && learningTrack.canPublish"
                                                    data-toggle="tooltip" data-placement="top" title="Unpublish"
                                                    (click)=" UnpublishedModalPopUp(learningTrack.id, false, learningTrack)">
                                                    <i class="fa fa-reply IconCustomization" aria-hidden="true"></i>
                                                    <div class="clickicons"></div>
                                                </a>
                                                <a class="custom-icon"
                                                    *ngIf="!learningTrack.published && !isPartnerView && learningTrack.canPublish"
                                                    data-toggle="tooltip" data-placement="top" 
                                                    [attr.title]="setTooltipMessage(learningTrack)"
                                                    [attr.data-original-title]="setTooltipMessage(learningTrack)"
                                                    (mouseenter)="updateTooltip($event, learningTrack)"
                                                    (click)="((isApprovalRequiredForType() && !learningTrack?.createdByAnyApprovalManagerOrApprover && learningTrack?.approvalStatus != 'APPROVED') || (!isApprovalRequiredForType() && learningTrack?.approvalStatus != 'APPROVED') || referenceService?.isAccessToView(learningTrack?.expireDate)) ? '': confirmChangePublish(learningTrack.id, true, learningTrack)">
                                                    <i class="fa fa-share IconCustomization" aria-hidden="true"
                                                    [ngClass]="((isApprovalRequiredForType() && !learningTrack?.createdByAnyApprovalManagerOrApprover && learningTrack?.approvalStatus != 'APPROVED') || (!isApprovalRequiredForType() && learningTrack?.approvalStatus != 'APPROVED') || referenceService?.isAccessToView(learningTrack?.expireDate)) ? 'disabled gray':''"></i>
                                                    <div class="clickicons"></div>
                                                </a>
                                                <a class="custom-icon" data-toggle="tooltip" data-placement="top"
                                                    title="View" (click)="isPartnerView && learningTrack?.partnerStatus === 'deactivated' ? '' : view(learningTrack)">
                                                    <i class="fa fa-eye IconCustomization" aria-hidden="true" [ngClass]="(isPartnerView && learningTrack?.partnerStatus === 'deactivated') ? 'disabled gray' : ''"></i>
                                                    <div class="clickicons"></div>
                                                </a>
                                                <a class="custom-icon" *ngIf="!isPartnerView" data-toggle="tooltip"
                                                    data-placement="top" [title]=" ((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView)  ? 'Not yet published' : 'View Analytics' "
                                                    (click)="((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView)  ? '':viewAnalytics(learningTrack)" [ngClass]="((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView) ?'disabled-div' : ''">
                                                    <i class="fa fa-line-chart IconCustomization"
                                                        aria-hidden="true" [ngClass]="((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView) ?'disabled':''"></i>
                                                    <div class="clickicons"></div>
                                                </a>
                                                <!-- XNFR-824 -->
                                                <a *ngIf="isApprovalRequiredForType() && !isPartnerView" (click)="showCommentsAndHistoryModalPopup(learningTrack)" data-toggle="tooltip" data-placement="top"
                                                title="{{(!authenticationService?.module?.isAdmin || learningTrack?.createdByAnyApprovalManagerOrApprover) ? 'Comments/History' : 'Approve/Reject'}}">
                                                    <i class="{{fontAwesomeClassName.comments}} IconCustomization" aria-hidden="true"></i>
                                                </a>
                                                <a class="custom-icon" *ngIf="learningTrack.canDelete && !isPartnerView"
                                                    id="template-delete" data-toggle="tooltip" data-placement="top"
                                                    title="Delete" (click)="confirmDelete(learningTrack)">
                                                    <i class="fa fa-trash-o trashIconCustomization"
                                                        aria-hidden="true"></i>
                                                    <div class="del-icon"></div>
                                                </a>


                                            <a class="oliveIcon" *ngIf="authenticationService?.isOliverActive && type == 'PLAYBOOK'"
                                                data-toggle="tooltip" data-placement="top" title="Ask Oliver" (click)="askOliver(learningTrack)">
                                                <div class="oliveBackground">
                                                    <img src="assets/images/oliverAiLogo.svg" alt="Oliver Icon" class="oliveImg">
                                                </div>
                                            </a>


                                            </div>
                                            <!--XNFR-327-->
                                            <div *ngIf="learningTrack?.publishingOrWhiteLabelingInProgress || learningTrack?.publishingToPartnerList"
                                                class="actions-block override-actions custom-width-icon mb_whitespace">
                                                <a data-toggle="tooltip" data-placement="top" title="Refresh"
                                                    (click)="listLearningTracks(pagination)">
                                                    <i class="fa fa-refresh IconCustomization remove_border" aria-hidden="true"></i>
                                                </a>
                                                <p class="success mt5" *ngIf="learningTrack?.publishingToPartnerList || learningTrack?.publishingOrWhiteLabelingInProgress">
                                                    <strong><img src="assets/images/loading.gif"alt="Publishing is in progress"style="height:15px">{{XAMPLIFY_CONSTANTS?.pleaseWait}}</strong>
                                                </p>
                                            </div>
                                            <!--XNFR-327-->
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </ng-container>
                </section>
                <!--Grid View--->
                <div class="row p17 neg_mrg_top8 aligntowbtns"
                    *ngIf="modulesDisplayType.isGridView && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError">
                    <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12 tab_mt_grid GridviewSidePaddings"
                        *ngFor="let learningTrack of pagination.pagedItems ;let i =index"
                        id="LearningTrackListDiv_{{learningTrack.id}}">
                        <!-- XNFR-1001  -->
                        <div class="grid-box" id="box-dark-defalut-clr" style="min-height: 345px;">
                            <img class="img-grid-track" *ngIf="!referenceService.isCloudFront" [src]="learningTrack.featuredImage"
                                onerror="this.src='assets/images/content/image.png';" alt="{{learningTrack.title}}">
                                <img class="img-grid-track" *ngIf="referenceService.isCloudFront"  [src]="learningTrack.cdnFeaturedImage"
                                onerror="this.src='assets/images/content/image.png';" alt="{{learningTrack.title}}">
                                <!-- XNFR-1001  -->
                            <h4 class="assest-name GridViewCotent gridViewTextAlignmnent1" data-toggle="tooltip"
                                data-placement="bottom" title="{{learningTrack.title}}"
                                style="margin-bottom: 0px;padding: 0;margin-top: 10px;">
                                <span><b>{{titleHeader}} Title: </b>{{learningTrack.title | slice:0:59}}</span>
                                <span *ngIf="learningTrack.title?.length>59">...</span>
                            </h4>
                            <div class="mt5">
                                <div *ngIf="isPartnerView && (type == undefined || type == 'TRACK' || type == 'PLAYBOOK') && authenticationService?.companyProfileName !== 'versa-networks'"
                                    style="margin: 10px 15px 0px 15px;"  class="text-center">
                                    <div class="progress">
                                        <div class="progress-bar" data-toggle="tooltip" data-placement="top"
                                            title="{{learningTrack.progress}}%"
                                            [ngStyle]="{'width': learningTrack.progress + '%'}"
                                            style="border-radius:1px;" role="progressbar"></div>
                                    </div>
                                    <span class="progresleft"
                                        *ngIf="learningTrack.progress != undefined">{{learningTrack.progress}}%</span>
                                    <span class="progresleft" *ngIf="learningTrack.progress == undefined">0%</span>
                                    <br>
                                </div>
                                <h6 class="xamplify-ellipsis GridViewCotent" data-toggle="tooltip" data-placement="top"
                                    title="{{learningTrack?.category?.name}}">
                                    <b>Folder: </b>{{learningTrack?.category?.name | slice:0:17}}
                                    <span *ngIf="learningTrack?.category?.name?.length>17">..</span>
                                </h6>
                                <h6 class="xamplify-ellipsis GridViewCotent" data-toggle="tooltip" data-placement="top"
                                    title="{{learningTrack.createdByName}}">
                                    <b>By: </b>{{learningTrack.createdByName | slice:0:17}}
                                    <span *ngIf="learningTrack.createdByName?.length>17">..</span>
                                </h6>
                                <h6 class="xamplify-ellipsis GridViewCotent">
                                    <b> Created On: </b><app-timestamp [isOnlyDate]="true"
                                        [dateAndTime]="learningTrack.createdDateString"></app-timestamp>
                                </h6>
                                <!-- XNFR-897 -->
                                <h6 class="xamplify-ellipsis GridViewCotent">
                                    <span class="text-danger" data-toggle="tooltip" data-placement="top"
                                        title="{{referenceService?.expireDescription(learningTrack.expireDate,tracksModule)}}">
                                        {{referenceService?.expireDescription(learningTrack?.expireDate, tracksModule)}}
                                    </span>
                                </h6>
                                <!-- XNFR-824 -->
                                <span *ngIf="isApprovalRequiredForType() && !isPartnerView" class="view-banner" [ngClass]="{
                                    'bgc-green': learningTrack?.approvalStatus === approvalStatus.APPROVED,
                                    'bgc-red': learningTrack?.approvalStatus === approvalStatus.REJECTED,
                                    'bgc-orange': learningTrack?.approvalStatus === approvalStatus.CREATED}" style="white-space: nowrap; margin-left: 13px;float: left;" translate>
                                    {{getApprovalStatusText(learningTrack.approvalStatus)}}
                                </span>
                                <span style="white-space: nowrap; margin-left: 13px;float: left;" *ngIf="!isApprovalRequiredForType() && !isPartnerView && learningTrack.approvalStatus == approvalStatus.REJECTED"
                                    class="view-banner asset-approval-labele-spacing bgc-red" translate>
                                    {{getApprovalStatusText(learningTrack.approvalStatus)}}
                                </span>
                                <span *ngIf="isPartnerView && learningTrack?.partnerStatus === 'deactivated'" data-toggle="tooltip" data-placement="top"
                                    title="Partnership is deactivated" class="green-banner inline-flex track-deactivated">
                                    DEACTIVATED
                                </span>
                            </div>
                            <!---XNFR-327--->
                            <div class="ribbon tab-ribbon">
                                <span *ngIf="learningTrack.published && !isPartnerView && !learningTrack?.publishingOrWhiteLabelingInProgress">Published</span>
                            </div>
                            <!---XNFR-327--->
                            <div *ngIf="!learningTrack?.publishingOrWhiteLabelingInProgress && !learningTrack?.publishingToPartnerList"
                                 class="bar gridIconCustomization actionAlignment_sp_even"
                                style="padding: 0px 10px;flex-wrap: wrap;height: auto">
                                <div class="btnAlignPad edit_icons mbtnAlignPad">
                                    <a class="Iconhover custom-grid-icon"
                                        *ngIf="learningTrack.canUpdate && !isPartnerView" data-toggle="tooltip"
                                        data-placement="top" title="Preview & Edit" (click)="edit(learningTrack.id)">
                                        <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                        <div class="clickicons"></div>
                                    </a>
                                </div>
                                <div class="btnAlignPad mbtnAlignPad">
                                    <a class="Iconhover custom-grid-icon"
                                        *ngIf="learningTrack.published && !isPartnerView && learningTrack.canPublish"
                                        data-toggle="tooltip" data-placement="top" title="Unpublish"
                                        (click)="UnpublishedModalPopUp(learningTrack.id, false, learningTrack)">
                                        <i class="fa fa-reply" aria-hidden="true"></i>
                                        <div class="clickicons"></div>
                                    </a>
                                </div>
                                <div class="btnAlignPad edit_icons mbtnAlignPad">
                                    <a class="Iconhover custom-grid-icon"
                                        *ngIf="!learningTrack.published && !isPartnerView && learningTrack.canPublish"
                                        data-toggle="tooltip" data-placement="top" 
                                        [attr.title]="setTooltipMessage(learningTrack)"
                                        [attr.data-original-title]="setTooltipMessage(learningTrack)"
                                        (mouseenter)="updateTooltip($event, learningTrack)"
                                        (click)="((isApprovalRequiredForType() && !learningTrack?.createdByAnyApprovalManagerOrApprover && learningTrack?.approvalStatus != 'APPROVED') || (!isApprovalRequiredForType() && learningTrack?.approvalStatus != 'APPROVED') || referenceService?.isAccessToView(learningTrack?.expireDate)) ? '': confirmChangePublish(learningTrack.id, true, learningTrack)"
                                        [ngClass]="((isApprovalRequiredForType() && !learningTrack?.createdByAnyApprovalManagerOrApprover && learningTrack?.approvalStatus != 'APPROVED') || (!isApprovalRequiredForType() && learningTrack?.approvalStatus != 'APPROVED') || referenceService?.isAccessToView(learningTrack?.expireDate)) ? 'disabled-div gray':''">
                                        <i class="fa fa-share" aria-hidden="true" [ngClass]="((isApprovalRequiredForType() && !learningTrack?.createdByAnyApprovalManagerOrApprover && learningTrack?.approvalStatus != 'APPROVED') || (!isApprovalRequiredForType() && learningTrack?.approvalStatus != 'APPROVED') || referenceService?.isAccessToView(learningTrack?.expireDate)) ? 'disabled':''"></i>
                                        <div class="clickicons"></div>
                                    </a>
                                </div>
                                <div class="btnAlignPad edit_icons mbtnAlignPad">
                                    <a class="Iconhover custom-grid-icon"
                                        [ngClass]="(learningTrack?.partnerStatus === 'deactivated' && isPartnerView) ? 'disabled gray' : ''"
                                        data-toggle="tooltip" data-placement="top" title="View"
                                        (click)="(learningTrack?.partnerStatus === 'deactivated' && isPartnerView) ? '' : view(learningTrack)">
                                        <i class="fa fa-eye" aria-hidden="true"></i>
                                        <div class="clickicons"></div>
                                    </a>
                                </div>

                                <div class="btnAlignPad edit_icons mbtnAlignPad">
                                    <a class="Iconhover custom-grid-icon" *ngIf="!isPartnerView" data-toggle="tooltip"
                                        data-placement="top" [title]=" ((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView) ? 'Not yet published' : 'View Analytics' "
                                        (click)="((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView) ? '':viewAnalytics(learningTrack)" [ngClass]="((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView) ?'disabled-div' : ''">
                                        <i class="fa fa-line-chart" aria-hidden="true" [ngClass]="((!learningTrack.published && !isPartnerView && referenceService.isAccessToView(learningTrack.expireDate)) || learningTrack?.approvalStatus === approvalStatus.REJECTED ) || (!learningTrack.published && !isPartnerView) ?'disabled' : ''"></i>
                                        <div class="clickicons"></div>
                                    </a>
                                </div>
                                <!-- XNFR-824 -->
                                <a *ngIf="isApprovalRequiredForType() && !isPartnerView" (click)="showCommentsAndHistoryModalPopup(learningTrack)"
                                    data-toggle="tooltip" data-placement="top"
                                    title="{{(!authenticationService?.module?.isAdmin || learningTrack?.createdByAnyApprovalManagerOrApprover) ? 'Comments/History' : 'Approve/Reject'}}">
                                    <i class="{{fontAwesomeClassName.comments}}" aria-hidden="true"></i>
                                </a>

                                <div class="btnAlignPad edit_icons mbtnAlignPad">
                                    <a *ngIf="learningTrack.canDelete && !isPartnerView" data-toggle="tooltip"
                                        data-placement="top" title="Delete" class="delete custom-icon"
                                        (click)="confirmDelete(learningTrack)">
                                        <i class="fa fa-trash-o" aria-hidden="true"></i>
                                        <div class="del-icon"></div>
                                    </a>
                                </div>
                                
                                
                                <a class="Iconhover custom-grid-icon oliverhover" *ngIf="authenticationService?.isOliverActive && type == 'PLAYBOOK' " data-toggle="tooltip" data-placement="top"
                                    title="Ask Oliver" (click)="askOliver(learningTrack)">
                                        <img src="assets/images/oliverAiLogo.svg" alt="Oliver Icon" class="m0 oliverImgIcon">
                                </a>


                            </div>
                            <!--Refresh Icon-->
                            <!--XNFR-327-->
                            <div *ngIf="learningTrack?.publishingOrWhiteLabelingInProgress || learningTrack?.publishingToPartnerList"
                                class="bar auto-height gridIconCustomization iconAligntCu icons_align">
                                <a class="custom-grid-icon" data-toggle="tooltip" data-placement="top" title="Refresh"
                                    (click)="listLearningTracks(pagination)">
                                    <i class="fa fa-refresh remove_border" aria-hidden="true"></i>
                                    <div class="clickicons"></div>
                                </a>
                                <p class="success mt5" *ngIf="learningTrack?.publishingToPartnerList || learningTrack?.publishingOrWhiteLabelingInProgress">
                                    <strong><img src="assets/images/loading.gif"alt="Publishing is in progress"style="height:15px">{{XAMPLIFY_CONSTANTS?.pleaseWait}}</strong>
                                </p>
                            </div>
                            <!--XNFR-327-->
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="modulesDisplayType.isListView || modulesDisplayType.isGridView">
                    <div *ngIf="pagination.pagedItems.length !== 0" class="mrg_top2">
                        <app-pagination [pagination]="pagination" (notifyParent)="setPage($event)"
                            (notifyParentDropDown)="listLearningTracks($event)"
                            [hidden]="httpRequestLoader.isLoading"></app-pagination>
                    </div>
                    <!-- End of 24 -->
                    <div *ngIf="pagination.totalRecords==0 && !httpRequestLoader.isLoading" class="alert alert-info">
                        <strong *ngIf="type == undefined || type == 'TRACK'" translate>No Learning Tracks
                            Found.</strong>
                        <strong *ngIf="type != undefined && type == 'PLAYBOOK'" translate>No Playbooks Found.</strong>
                    </div>
                </ng-container>
            </div>
            <!--Folder List View / Folder Grid View -->
            <div *ngIf="modulesDisplayType.isFolderGridView || modulesDisplayType.isFolderListView">
                <app-folder-type-view-util [moduleId]="moduleId"
                    [modulesDisplayType]="modulesDisplayType"></app-folder-type-view-util>
            </div>
        </div>
        <!-- UnPublish Modal Popup-->
        <div class="modal fade in" id="unpublished-modal" data-backdrop="static">
            <div class="modal-dialog modal-copy" role="document">
                <div class="modal-content mSweetalertWid popup-cu-widthalign">
                    <div class="modal-header">
                        <h4 class="modal-title f-w-600" id="" translate="">Are you sure you want to unpublish this
                            {{trackOrPlayBookText}}?</h4>
                    </div>
                    <div class="modal-body">
                        <div>
                            <h4 class="modal-title-new">Please share your reason for unpublishing this {{trackOrPlayBookText}}.</h4>
                        </div>
                        <div class="form-check pointer mt15">
                            <input class="pointer radioButton_shadow" type="radio" (click)="selectedOption=true"
                                name="rdaction" value="Assets_or_Quiz">
                            <label class="option-color">{{type.toLowerCase() === 'track' ? ' Want to update Assets/Quiz' : ' Want to update Assets' }}</label><br>
                            <input class="pointer radioButton_shadow" type="radio" (click)="selectedOption=true"
                                name="rdaction" value="Partner_List">
                            <label class="option-color">Want to update the
                                {{authenticationService?.partnerModule?.customName}}/Group of
                                {{authenticationService?.partnerModule?.customName}}</label><br>
                            <input class="pointer radioButton_shadow" type="radio" (click)="selectedOption=true"
                                name="rdaction" value="Other">
                            <label class="option-color">Other</label><br>
                        </div>
                        <div>
                            <p class="warning-red-textcolor">* When you unpublish the {{trackOrPlayBookText}},all the related analytics
                                will no longer exists.</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn Btn-Gray" type="button" (click)="closePopUp()">Cancel</button>
                        <button class="button bgcolor-unset pd-top2" type="button" [disabled]="!selectedOption"
                            (click)="unPublishAction(UnPublishedId, false)">
                            <span class="btn Btn-Green transition text_pd5">Unpublish</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

<!-- XNFR-824 -->
<app-content-status-history-modal-popup
    *ngIf="callCommentsComponent && isApprovalRequiredForType() && !isPartnerView && !showAskOliverModalPopup"
    [entityId]="selectedDamId" [moduleType]="type" [createdByAnyApprovalManagerOrApprover]="createdByAnyApprovalManagerOrApprover" [title]="assetName"
    [createdById]="assetCreatedById" [createdByName]="assetCreatedByFullName" [videoId]="videoId"
    (closeModalPopup)="closeCommentsAndHistoryModalPopup()"
    (closeModalPopupAndRefresh)="closeCommentsAndHistoryModalPopupAndRefreshList()">
</app-content-status-history-modal-popup>

<app-ai-chat-manager *ngIf="showAskOliverModalPopup" [chatGptSettingDTO]="chatGptSettingDTO"
 [isFromManagePlaybooks]="isFromManagePlaybooks" [isPlaybookPartnerView]="isPartnerView"
     [selectedLearningTrack]="learningTrack" (notifyParent)="closeAskAI($event)"></app-ai-chat-manager>
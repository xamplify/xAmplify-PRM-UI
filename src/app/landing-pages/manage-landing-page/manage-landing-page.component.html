<ngx-loading [show]="ngxloading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
<div class="page-content">
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li><i class="fa fa-home" aria-hidden="true"></i>
                <a [routerLink]="referenceService.homeRouter">Home</a>
                <i class="fa fa-angle-right" aria-hidden="true"></i>
                <ng-container *ngIf="!isPartnerLandingPage">
                    <a [routerLink]="['../../design/add']">Create Design</a>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </ng-container>
            </li>
            <li>
                <a *ngIf="!isPartnerLandingPage">Manage Pages</a>
                <a *ngIf="isPartnerLandingPage">Pages Shared By Vendors</a>
            </li>
        </ul>
    </div>
    <div id="custom-response-div">
        <app-response-message *ngIf="customResponse.isVisible" [customResponse]="customResponse"></app-response-message>
    </div>
    <div class="row" *ngIf="statusCode==200">
        <div class="col-md-12">
            <div class="portlet light clearfix">
                <div class="portlet-title" style="border-bottom: none;">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-lg-12">
                            <div class="col-xs-12 col-sm-7 col-lg-7 p0">
                                <ul class="mix-filter">
                                    <li class="filter" (click)="showAllLandingPages('All',0)" [class.landing-page-selected]="0 == selectedLandingPageTypeIndex">All</li>
                                    <ng-container *ngIf="!isPartnerLandingPage">
                                        <li class="filter" (click)="showAllLandingPages('Regular&PUBLIC',1)" [class.landing-page-selected]="1 == selectedLandingPageTypeIndex">Regular (Public)</li>
                                        <li class="filter" (click)="showAllLandingPages('Regular&PRIVATE',2)" [class.landing-page-selected]="2 == selectedLandingPageTypeIndex">Regular (Private)</li>
                                        <li class="filter" (click)="showAllLandingPages('Co-Branded&PUBLIC',3)" [class.landing-page-selected]="3 == selectedLandingPageTypeIndex">Co-Branded (Public)</li>
                                        <li class="filter" (click)="showAllLandingPages('Co-Branded&PRIVATE',4)" [class.landing-page-selected]="4 == selectedLandingPageTypeIndex">Co-Branded (Private)</li>
                                    </ng-container>
                                    <ng-container *ngIf="isPartnerLandingPage">
                                        <li class="filter" (click)="showAllLandingPages('PUBLIC',5)" [class.landing-page-selected]="5 == selectedLandingPageTypeIndex">Public</li>
                                        <li class="filter" (click)="showAllLandingPages('PRIVATE',6)" [class.landing-page-selected]="6 == selectedLandingPageTypeIndex">Private</li>
                                    </ng-container>
                                </ul>
                            </div>
                            <div class="col-xs-12 col-sm-5 col-lg-5 p0">
                                <div class="page-toolbar">
                                    <div class="btn-group pull-right">
                                        <div class="inputs" id="right" style="display: inline-flex;">
                                            <div id="left" *ngIf="!isPartnerLandingPage">
                                                <select class="form-control" [(ngModel)]="sortOption.formsSortOption" (ngModelChange)="sortBy($event)" id="select-dropdown">
                          <option *ngFor="let option of sortOption.manageFormsSortOptions" [ngValue]="option">
                            {{option.name}}</option>
                        </select>
                                            </div>

                                            <div *ngIf="isPartnerLandingPage">
                                                <select class="form-control" [(ngModel)]="sortOption.partnerLandingPageSortOption" (ngModelChange)="sortBy($event)" id="select-dropdown">
                          <option *ngFor="let option of sortOption.partnerLandingPageSortOptions" [ngValue]="option">
                            {{option.name}}</option>
                        </select>
                                            </div>


                                            <div class="portlet-input input-inline" id="search-div">
                                                <div class="input-icon right" id="icon">
                                                    <input type="text" id="sort-text" class="form-control" [(ngModel)]="sortOption.searchKey" [ngModelOptions]="{standalone: true}" placeholder="search..." (keypress)="eventHandler($event.keyCode)">
                                                    <button class="glyphicon glyphicon-remove search-box-item-clear" *ngIf="sortOption.searchKey" (click)="sortOption.searchKey='';searchLandingPages();"></button>
                                                    <button type="submit" class="search-box-item-click" (click)="searchLandingPages()">
                            <i class="fa fa-search" aria-hidden="true"></i>
                          </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="portlet-body" style="padding: 0px 3px 0px 3px;">
                    <div class="row">
                        <app-landing-page-loader [maxBoxLength]=4 *ngIf="httpRequestLoader.isLoading"></app-landing-page-loader>
                        <ng-container *ngIf="!httpRequestLoader.isLoading">
                            <div class="col-md-3 col-sm-4 col-xs-12" *ngFor="let landingPage of pagination.pagedItems ;let i =index">
                                <div class="grid-box" id="landingPageListDiv_{{landingPage.id}}">
                                    <ng-container *ngIf="!isPartnerLandingPage">
                                        <span class="ribbon1" *ngIf="landingPage.coBranded"><span>Co-Branded</span></span>
                                        <span class="ribbon1" *ngIf="!landingPage.coBranded"><span>Regular</span></span>
                                    </ng-container>
                                    <img class="img-responsive center-block" src="{{landingPage.thumbnailPath}}" alt="Not Found">
                                    <div>
                                        <h4 id="landing-page-title" title="{{landingPage.name}}">{{landingPage.name|slice:0:23}} <span *ngIf="landingPage.name?.length>23">....</span></h4>
                                        <span class="view-banner">{{landingPage.type}}</span>
                                        <h6 *ngIf="!isPartnerLandingPage">Created On <strong>
                        <app-timestamp [isOnlyDate]="true" [dateAndTime]="landingPage.displayTime"> </app-timestamp>
                      </strong></h6>
                                        <h6 *ngIf="isPartnerLandingPage">Shared On <strong>
                        <app-timestamp [isOnlyDate]="true" [dateAndTime]="landingPage.displayTime"> </app-timestamp>
                      </strong></h6>
                                        <h6 title="{{landingPage.createdUser}}">By <strong>{{landingPage.createdUser | slice:0:25}}</strong>
                                            <span *ngIf="landingPage.createdUser?.length>25">..</span>
                                        </h6>
                                        <h6 title="{{landingPage.companyName}}">
                                            From <strong>{{landingPage.companyName | slice:0:25}}</strong>
                                            <span *ngIf="landingPage.companyName?.length>25">..</span>
                                        </h6>
                                    </div>

                                    <div class="bar">
                                        <a *ngIf="!isPartnerLandingPage && (deleteAndEditAccess || loggedInUserId==landingPage.userId)" data-toggle="tooltip" data-placement="top" title="Edit" (click)="editLandingPage(landingPage.id)">
                                            <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                        </a>
                                        <a data-toggle="tooltip" data-placement="top" title="Preview" (click)="showPreview(landingPage)">
                                            <i class="fa fa-eye" aria-hidden="true"></i>
                                        </a>
                                        <ng-container *ngIf="!(isPartnerLandingPage && landingPage.type=='PRIVATE')">
                                            <a data-toggle="tooltip" data-placement="top" title="Copy / Embed Link" (click)="showPageLinkPopup(landingPage)">
                                                <i class="fa fa-clipboard" aria-hidden="true"></i>
                                            </a>
                                        </ng-container>
                                        <ng-container *ngIf="landingPage.formsCount>0 && !(isPartnerLandingPage && landingPage.type=='PRIVATE')">
                                            <a *ngIf="!isPartnerLandingPage" data-rel="fancybox-button" (click)="goToFormAnalytics(landingPage.id)" data-toggle="tooltip" data-placement="top" title="Form Count"><i class="fa fa-wpforms" aria-hidden="true"></i></a>
                                            <a *ngIf="isPartnerLandingPage" data-rel="fancybox-button" (click)="goToPartnerLandingPageFormAnalytics(landingPage.alias)" data-toggle="tooltip" data-placement="top" title="Form Count"><i class="fa fa-wpforms" aria-hidden="true"></i></a>
                                            <span class="badge" id="notification-list">{{landingPage.formsCount}}</span>
                                        </ng-container>
                                        <ng-container *ngIf="!(isPartnerLandingPage && landingPage.type=='PRIVATE')">
                                            <a *ngIf="landingPage.analyticsCount<=0" data-rel="fancybox-button" id="cursor-not-allowed" data-toggle="tooltip" data-placement="top" title="Analytics">
                                                <i class="fa fa-line-chart" aria-hidden="true"></i>
                                            </a>
                                            <a *ngIf="landingPage.analyticsCount>0 && !isPartnerLandingPage" data-rel="fancybox-button" (click)="goToLandingPageAnalytics(landingPage.id)" data-toggle="tooltip" data-placement="top" title="Analytics">
                                                <i class="fa fa-line-chart" aria-hidden="true"></i>
                                            </a>
                                            <a *ngIf="landingPage.analyticsCount>0 && isPartnerLandingPage" data-rel="fancybox-button" (click)="goToPartnerLandingPageAnalytics(landingPage.alias)" data-toggle="tooltip" data-placement="top" title="Analytics">
                                                <i class="fa fa-line-chart" aria-hidden="true"></i>
                                            </a>
                                            <span class="badge" id="notification-list">{{landingPage.analyticsCount}}</span>
                                        </ng-container>
                                        <a *ngIf="!isPartnerLandingPage && (deleteAndEditAccess || loggedInUserId==landingPage.userId)" data-toggle="tooltip" class="delete" data-placement="top" title="Delete" (click)="confirmDelete(landingPage)">
                                            <i class="fa fa-trash-o" aria-hidden="true"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div *ngIf="pagination.pagedItems.length !== 0">
                    <app-pagination [pagination]="pagination" (notifyParent)="setPage($event)" (notifyParentDropDown)="listLandingPages($event)" [hidden]="httpRequestLoader.isLoading"></app-pagination>
                </div>
                <div *ngIf="pagination.totalRecords==0 && !httpRequestLoader.isLoading" class="alert alert-info">
                    <strong>No Pages Found.</strong>
                </div>

            </div>
            <!-- END PAGE CONTENT-->
        </div>
    </div>
    <!-- ----------------------Copy Link Modal------------------- -->
    <div class="modal right " id="landing-page-url-modal" data-backdrop="static">
        <div class="modal-dialog modal-lg" style="width: 75%;right:0">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close-circle" data-dismiss="modal">
            <i class="fa fa-times" aria-hidden="true"></i>
          </button>
                    <h4 class="modal-title text-center">COPY LINK / EMBED LINK</h4>
                </div>
                <div class="modal-body">
                    <app-response-message [customResponse]="copiedLinkCustomResponse" *ngIf="copiedLinkCustomResponse.isVisible">
                    </app-response-message>
                    <br>
                    <div class="form-group">
                        <label class="control-label">Copy Link</label>
                        <input type="text" id="copy-link" class="form-control" readonly="readonly" [ngModel]="landingPageAliasUrl" #userinput>
                        <br>
                        <a class="btn btn-primary" id="right" (click)="copyInputMessage(userinput,'Page Link')">Copy Link</a>
                        <br>
                    </div>
                    <div class="form-group">
                        <label class="control-label">Copy Embed Link</label>
                        <textarea id="text-area" rows="3" [ngModel]="iframeEmbedUrl" spellcheck="false" #iframeUrlInput></textarea>
                        <a class="btn btn-primary" id="right" (click)="copyInputMessage(iframeUrlInput,'Embed Link')">Copy Embed
              Link</a>
                    </div>
                </div>
                <div class="modal-footer">
                    <a data-dismiss="modal" class="btn btn-default" id="right">Close</a>
                </div>
            </div>
        </div>
    </div>
    <app-preview-landing-page #previewLandingPageComponent></app-preview-landing-page>
    <app-scroll-top></app-scroll-top>
</div>
<style type="text/css">
  a.disabled { pointer-events: none; cursor: not-allowed; }
</style>
<div class="page-content">
	<div class="page-bar">
		<ul class="page-breadcrumb">
			<li>
				<i class="fa fa-home"></i> 
				<a [routerLink]="['/']">Home</a> 
				<i	class="fa fa-angle-right"></i>
			</li>
			<li>
				<a>Add/Manage Team Members</a>
			</li>
		</ul>
	</div>
		<div class="alert alert-danger" *ngIf="uiError?.length>0" id="ui-error-div">
	  		<strong>{{uiError}}</strong> 
		</div>
		<div class="alert alert-danger"  id="empty-roles-div" style="display: none;">
			<a (click)="referenceService.hideDiv('empty-roles-div')" class="close" aria-label="close">x</a>
	  		<strong>{{errorMessage}}</strong> 
		</div>
		
		<div class="alert alert-danger"  id="csv-error-div" style="display: none;">
		<a (click)="referenceService.hideDiv('csv-error-div')" class="close" aria-label="close">x</a>
			<div class="container">
				<table class="table">
				<ng-container *ngFor="let error of csvErrors">
		  			<tr>
						<td style="text-align: center;font-weight:bold">{{error}}</td>
					</tr>
					<hr>
		  		</ng-container>
				</table>
	  		</div>	
		</div>
	
		<div class="alert alert-success"  id="team-member-success-div" style="display: none;">
			<a (click)="referenceService.hideDiv('team-member-success-div')" class="close" aria-label="close">x</a>
	  		<strong>{{successMessage}}</strong> 
		</div>
	<!-- BEGIN PAGE CONTENT-->
	<div class="row">
		<div class="div-loader" *ngIf="isProcessing">
			<div id="process-loader"></div>
		</div>
		<div *ngIf="!isProcessing">
			<div class="clearfix">
				<section class="clearfix">
				<div class="col-xs-6 col-sm-3">
						<button class="btn-xs btn-info fileinput-button btn-block rounded-0" style="overflow: hidden;position: relative;"  *ngIf="!isAddTeamMember && !isUploadCsv">
							<h6>Upload Csv</h6>
							<input type="file"   class="file-upload"   #fileImportInput  name="File Upload"   id="txtFileUpload"   accept=".csv" (change)="fileChangeListener($event)" />
						</button>
						<button class="btn-xs btn-info fileinput-button btn-block rounded-0" style="overflow: hidden;position: relative;cursor: not-allowed;" disabled="disabled" *ngIf="isAddTeamMember  || isUploadCsv">
							<h6>Upload Csv</h6>
						</button>
					</div>
					<div class="col-xs-6 col-sm-3">
						<button class="btn-xs btn-primary btn-block rounded-0" (click)="showAddTeamMember()" *ngIf="!isAddTeamMember && !isUploadCsv">
							<h6>Add Team Member</h6>
						</button>
						<button class="btn-xs btn-primary btn-block rounded-0" disabled="disabled" *ngIf="isAddTeamMember || isUploadCsv" style="cursor: not-allowed" >
							<h6>Add Team Member</h6>
						</button>
					</div>
					<div  align="right" style="margin-right:20px;">
						<a class="btn btn-success" href="https://aravindu.com/vod/team-member-list.csv" download style="color: white;">Download Csv File</a>
					</div>
				</section>
			</div>
			
			<div class="portlet light border-radius-0" *ngIf="isAddTeamMember" style="height: 70px;">
				<div class="portlet-body">
					<form id="add-team-member-form">
						<div class="col-sm-3 ">
							<div  [class]="emaillIdDivClass">
							 <input  type="email"  class="form-control" id="emailId" placeholder="Email Address" [(ngModel)]="team.emailId" name="emailId" (input)="validateEmailId(team.emailId)">
							 <span class="text-danger" *ngIf="!teamMemberUi.isValidForm">{{teamMemberUi.errorMessage}}</span>
							</div>
						</div>
						<div class="col-sm-3 ">
							<div class="form-group">
									<input type="text" id="firstName" placeholder="First Name" class="form-control" [(ngModel)]="team.firstName" name="firstName"/>
							</div>
						</div>
						<div class="col-sm-3 ">
							<div class="form-group">
								<input type="text"  name="last"  class="form-control" id="lastName" placeholder="Last Name"  [(ngModel)]="team.lastName" name="lastName">
							</div>
						</div>
						<button type="button" class="btn btn-primary" *ngIf="teamMemberUi.isValidForm" (click)="addTeamMember()">Add</button>
						<button  class="btn btn-primary" *ngIf="!teamMemberUi.isValidForm" disabled="disabled">Add</button>
						<button  class="btn btn-info"   type="reset" (click)="clearForm()">Cancel</button>
					</form>
				</div>
			</div>
			
		<!-- BEGIN EXAMPLE TABLE PORTLET-->
			<div class="portlet light" *ngIf="!teamMemberUi.emptyTable">
				<div class="portlet-title">
					<div class="caption">Added Team Members</div>
				</div>
				<div class="portlet-body clearfix">
					<div class="table-responsive">
						<table class="table" id="add-team-member-table">
							<thead>
								<tr>
									<th class="table-checkbox">
										<h4>
											<img src="assets/images/user-permission.png" class="user-permission-img">User & Permissions
										</h4>
									</th>
									<th>
										<i class="fa fa-check-circle" aria-hidden="true"></i><br>All
									</th>
									<th>
										<i class="fa fa-file-video-o" aria-hidden="true"></i><br>Video
									</th>
									<th>
										<i class="fa fa-users" aria-hidden="true"></i><br>Contacts
									</th>
									<th>
										<i class="fa fa-bullhorn" aria-hidden="true"></i><br>Campaign
									</th>
									<th>
										<i class="fa fa-line-chart" aria-hidden="true"></i><br>Stats
									</th>
									<th>
										<i class="fa fa-envelope" aria-hidden="true"></i><br>Email
									</th>
									<th>
										<!-- <i class="fa fa-trash" aria-hidden="true"></i><br>Delete -->
									</th>
								</tr>
							</thead>
							<tbody>
							<ng-container *ngFor="let teamMember of teamMembers;let i=index">
							<tr id="team-member-{{i}}">
								<td><i class="fa fa-user" aria-hidden="true"></i>{{teamMember.emailId | lowercase}}</td>
								<td><input type="checkbox" (change)="addAllAuthorities($event,teamMember,'add-team-member-table',i)"  [(ngModel)]="teamMember.all"></td>
								<td><input type="checkbox" id="role-checkbox-{{i}}" [(ngModel)]="teamMember.video" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'add-team-member-table')"></td>
								<td><input type="checkbox" id="role-checkbox-{{i}}" [(ngModel)]="teamMember.contact" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'add-team-member-table')"></td>
								<td><input type="checkbox" id="role-checkbox-{{i}}" [(ngModel)]="teamMember.campaign" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'add-team-member-table')"></td>
								<td><input type="checkbox" id="role-checkbox-{{i}}" [(ngModel)]="teamMember.stats" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'add-team-member-table')"></td>
								<td><input type="checkbox" id="role-checkbox-{{i}}"[(ngModel)]="teamMember.emailTemplate" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'add-team-member-table')"></td>
								<td><a class="btn-sm" (click)="deleteRow(i,teamMember.emailId)"><em	class="fa fa-times"></em></a></td>
							</tr>
							</ng-container>
								
							</tbody>
						</table>
					</div>
					<hr>
					<div class="pull-right">
						<button class="btn btn-primary" (click)="save()">Save</button>
						<button class="btn btn-secondary" (click)="clearRows()">Cancel</button>
					</div>
				</div>
			</div>
			<!-- ---------------List Of Team Members -->
			<div class="portlet light" *ngIf="teamMemberUi.emptyTable">
				<div class="portlet-title">
					<div class="caption">Team Members List</div>
						<div class="tools" style="padding: 0;margin: 0;">
							<div class="inputs" align="right" style="padding:0;display: inline;">
								<div class="portlet-input input-inline input-large">
									<div class="input-icon right">
										<i class="icon-magnifier" (click)="searchTeamMembers()" style="cursor: pointer;max-width: 80%"></i>
										<input type="text"  class="form-control input-circle" placeholder="search..." [(ngModel)]="pagination.searchKey" [ngModelOptions]="{standalone: true}">
									</div>
								</div>
							</div>
							<a class="reload" (click)="refreshList()" style="margin: -5px 15px;"></a>
						</div>
				</div>
				<div class="portlet-body clearfix">
					<div class="table-responsive">
					<app-loader [model]="httpRequestLoader.isHorizontalCss" *ngIf="httpRequestLoader.isLoading"></app-loader>
						<table class="table" id="list-team-member-table"  *ngIf="!httpRequestLoader.isLoading">
							<thead>
								<tr>
									<th class="table-checkbox">
										<h4>
											<img src="assets/images/user-permission.png" class="user-permission-img">User & Permissions
										</h4>
									</th>
									<th>
										<i class="fa fa-check-circle" aria-hidden="true"></i><br>All
									</th>
									<th>
										<i class="fa fa-file-video-o" aria-hidden="true"></i><br>Video
									</th>
									<th>
										<i class="fa fa-users" aria-hidden="true"></i><br>Contacts
									</th>
									<th>
										<i class="fa fa-bullhorn" aria-hidden="true"></i><br>Campaign
									</th>
									<th>
										<i class="fa fa-line-chart" aria-hidden="true"></i><br>Stats
									</th>
									<th>
										<i class="fa fa-envelope" aria-hidden="true"></i><br>Email
									</th>
									<th *ngIf="pagination.totalRecords>0" (click)="deleteAll()">
										<a style="color: black;"><i class="fa fa-trash" aria-hidden="true"></i><br>Delete</a>
									</th>
								</tr>
							</thead>
							<ng-container *ngIf="pagination.totalRecords>0 && teamMemberUi.emptyTable">
							<tbody>
							<ng-container *ngFor="let teamMember of teamMembersList;let i=index">
							<tr id="list-team-member-{{i}}">
								<td><i class="fa fa-user" aria-hidden="true"></i>{{teamMember.emailId | lowercase}}</td>
								<td><input type="checkbox" (change)="addAllAuthorities($event,teamMember,'list-team-member-table',i)"  [(ngModel)]="teamMember.all"></td>
								<td><input type="checkbox"  id="role-checkbox-{{i}}" [(ngModel)]="teamMember.video" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'list-team-member-table')"></td>
								<td><input type="checkbox"  id="role-checkbox-{{i}}" [(ngModel)]="teamMember.contact" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'list-team-member-table')"></td>
								<td><input type="checkbox"  id="role-checkbox-{{i}}" [(ngModel)]="teamMember.campaign" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'list-team-member-table')"></td>
								<td><input type="checkbox"  id="role-checkbox-{{i}}" [(ngModel)]="teamMember.stats" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'list-team-member-table')"></td>
								<td><input type="checkbox"  id="role-checkbox-{{i}}" [(ngModel)]="teamMember.emailTemplate" class="module-checkbox-{{i}}" (change)="countCheckedCheckBoxesLength(teamMember,i,'list-team-member-table')"></td>
								<td><a class="btn-sm" (click)="delete(teamMember)"><em	class="fa fa-times"></em></a></td>
							</tr>
							</ng-container>
							</tbody>
							</ng-container>
							<ng-container>
								<tr>
								<td colspan="10">
										<div  *ngIf="pagination.totalRecords==0" class="alert alert-info" style="text-align: center;"><strong>No Team Members Found</strong></div>
									</td>
								</tr>	
							</ng-container>
						</table>
					</div>
					<hr>
						<!-- -----------Pagination-------------- -->
						<div *ngIf="pagination.totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError" class="pull-left">   
						<ul *ngIf="pagination.pager.pages && pagination.pager.pages.length" class="pagination">
		                        <li [ngClass]="{disabled:pagination.pager.currentPage === 1}">
		                           <a (click)="setPage(1)" [class.disabled]="pagination.pager.currentPage === 1">First</a>
		                        </li>
		                        <li [ngClass]="{disabled:pagination.pager.currentPage === 1}">
		                            <a (click)="setPage(pagination.pager.currentPage - 1)" [class.disabled]="pagination.pager.currentPage === 1">Previous</a>
		                         </li>
		                         <li *ngFor="let page of pagination.pager.pages" [ngClass]="{active:pagination.pager.currentPage === page}">
		                            <a (click)="setPage(page)" [class.disabled]="pagination.pager.currentPage === page">{{page}}</a>
		                         </li>
		                         <li [ngClass]="{disabled:pagination.pager.currentPage === pagination.pager.totalPages}">
		                             <a (click)="setPage(pagination.pager.currentPage + 1)" [class.disabled]="pagination.pager.currentPage === pagination.pager.totalPages">Next</a>
		                         </li>
		                          <li [ngClass]="{disabled:pagination.pager.currentPage === pagination.pager.totalPages}">
		                             <a (click)="setPage(pagination.pager.totalPages)" [class.disabled]="pagination.pager.currentPage === pagination.pager.totalPages">Last</a>
		                         </li>
		                       </ul>
					</div>
					<!-- -----------End Of Pagination-------------- -->
					<div class="pull-right" style="margin-top: 9px;" *ngIf="pagination.totalRecords > 0 && !httpRequestLoader.isLoading && !httpRequestLoader.isServerError">
						<button class="btn btn-primary" (click)="update()">Update</button>
					</div>
				</div>
			</div>
			<!-- END EXAMPLE TABLE PORTLET-->
	</div>
	</div>
	<!-- END PAGE CONTENT -->
</div>
<div class="page-content" [style.background-color]="refService.pageContnetBgColor">
    <div class="my-container">
        <ngx-loading [show]="ngxLoading" [config]="{ backdropBorderRadius: '14px' }"></ngx-loading>
    </div>
    <div style="position: relative; top: -10px">
        <app-response-message [customResponse]="customResponse" *ngIf="customResponse.isVisible"></app-response-message>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <div *ngIf="!ngxLoading" class="page-bar mWidth" style="border:none !important;">
                <ul class="page-breadcrumb" *ngIf="loadTemplate">
                    <li>
                        <i class="fa fa-home" aria-hidden="true"></i>
                        <a [routerLink]="refService?.homeRouter" translate>Home</a>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </li>
                    <li *ngIf="emailTemplateService.isNewTemplate">
                        <a [routerLink]="['/home/emailtemplates/select']" translate>Select Templates</a>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </li>
                    <li *ngIf="!emailTemplateService.isNewTemplate">
                        <a (click)="navigateToManageSection()" translate>Manage Templates</a>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </li>
                    <li>
                        <a><span *ngIf="emailTemplateService.isNewTemplate; else Other">Create</span>
                            <ng-template #Other translate>Update</ng-template> Template</a>
                    </li>
                </ul>
                <div>
                    <a class="close-circle mr5" style="margin-top: 6px;" [ngClass]="showForms ?'mt10':''" (click)="navigateBack()">
                        <i class="fa fa-times" aria-hidden="true"></i>
                    </a>
                    <app-preview-popup #previewPopUpComponent *ngIf="loadTemplate && showForms" [filter]="'survey'" [buttonText]="'Show Surveys'"></app-preview-popup>
                    <app-merge-tags *ngIf="loadTemplate" [input]="mergeTagsInput"></app-merge-tags>
                </div>
            </div>
            <div class="tile mScroll" id="CardBgforSection" style="border-radius: 5px;">
                <div id="bee-plugin-container"></div>
            </div>
        </div>
    </div>
    <app-scroll-top></app-scroll-top>

    <div class="modal fade in" id="save-template-popup"  data-backdrop="static" data-keyboard="false" >
        <div class="modal-dialog modal-copy" role="document">
            <div class="modal-content mSweetalertWid popup-cu-widthalign">
                <app-modal-popup-loader *ngIf="saveLoader"></app-modal-popup-loader>
                <div *ngIf="!saveLoader">
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Name<span class="required">*</span></label>
                            <input type="text"  autocomplete="off" placeholder="Please Enter Name" class="form-control" name="templateName" [(ngModel)]="emailTemplate.name" (input)="validateNames()" [ngModelOptions]="{standalone: true}"/>
                            <span class="required">{{errorMessage}}</span>
                        </div>
                        <div class="form-group">
                            <label>Folder<span class="required">*</span></label>
                            <select class="form-control" [(ngModel)]="emailTemplate.categoryId">
                                <option *ngFor="let category of categoryNames" [ngValue]="category.id">
                                    {{category.name}}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button *ngIf="isAdd" type="button" class="button bgcolor-unset"  [disabled]="errorMessage?.length>0 || buttonClicked" id="save"  (click)="saveTemplate(false);buttonClicked = true">
                            <span class="btn btn-primary transition txt_pd-top3">Save</span>
                        </button>
                        <button *ngIf="isAdd" type="button" class="button bgcolor-unset"  [disabled]="errorMessage?.length>0 || buttonClicked" id="save-and-redirect" (click)="saveTemplate(true);buttonClicked = true">
                            <span class="btn btn-primary transition txt_pd-top3">Save & Redirect</span>
                        </button>
                        <ng-container *ngIf="!isAdd"> 
                            <button  type="button" class="button bgcolor-unset"  [disabled]="errorMessage?.length>0 || buttonClicked || isSaveAsButtonDisabled" id="save-as"  (click)="saveTemplate(true);buttonClicked = true">
                                <span class="btn btn-primary transition txt_pd-top3">Save As</span>
                            </button>
                            <button  type="button" class="button bgcolor-unset" [disabled]="errorMessage?.length>0 || buttonClicked" id="update" (click)="updateEmailTemplate(false);buttonClicked = true">
                                <span class="btn btn-primary transition txt_pd-top3">Update</span>
                            </button>
                            <button  type="button" class="button bgcolor-unset" [disabled]="errorMessage?.length>0 || buttonClicked" id="update-and-redirect"   (click)="updateEmailTemplate(true);buttonClicked = true">
                                <span class="btn btn-primary transition txt_pd-top3">Update & Redirect</span>
                            </button>
                        </ng-container>
                        <button class="btn Btn-Gray" (click)="closeModalPopup()" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>